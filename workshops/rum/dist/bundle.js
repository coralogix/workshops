(()=>{var t={132:t=>{"use strict";function e(t){return"function"==typeof t}var n=console.error.bind(console);function r(t,e,n){var r=!!t[e]&&t.propertyIsEnumerable(e);Object.defineProperty(t,e,{configurable:!0,enumerable:r,writable:!0,value:n})}function o(t){t&&t.logger&&(e(t.logger)?n=t.logger:n("new logger isn't a function, not replacing"))}function i(t,o,i){if(t&&t[o]){if(!i)return n("no wrapper function"),void n((new Error).stack);if(e(t[o])&&e(i)){var a=t[o],s=i(a,o);return r(s,"__original",a),r(s,"__unwrap",(function(){t[o]===s&&r(t,o,a)})),r(s,"__wrapped",!0),r(t,o,s),s}n("original object and wrapper must be functions")}else n("no original function "+o+" to wrap")}function a(t,e){return t&&t[e]?t[e].__unwrap?t[e].__unwrap():void n("no original to unwrap to -- has "+e+" already been unwrapped?"):(n("no function to unwrap."),void n((new Error).stack))}o.wrap=i,o.massWrap=function(t,e,r){if(!t)return n("must provide one or more modules to patch"),void n((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach((function(t){e.forEach((function(e){i(t,e,r)}))})):n("must provide one or more functions to wrap on modules")},o.unwrap=a,o.massUnwrap=function(t,e){if(!t)return n("must provide one or more modules to patch"),void n((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach((function(t){e.forEach((function(e){a(t,e)}))})):n("must provide one or more functions to unwrap on modules")},t.exports=o},263:function(t,e,n){var r,o,i;!function(){"use strict";o=[n(343)],void 0===(i="function"==typeof(r=function(t){var e=/(^|@)\S+:\d+/,n=/^\s*at .*(\S+:\d+|\(native\))/m,r=/^(eval@)?(\[native code])?$/;return{parse:function(t){if(void 0!==t.stacktrace||void 0!==t["opera#sourceloc"])return this.parseOpera(t);if(t.stack&&t.stack.match(n))return this.parseV8OrIE(t);if(t.stack)return this.parseFFOrSafari(t);throw new Error("Cannot parse given Error object")},extractLocation:function(t){if(-1===t.indexOf(":"))return[t];var e=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(t.replace(/[()]/g,""));return[e[1],e[2]||void 0,e[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter((function(t){return!!t.match(n)}),this).map((function(e){e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var n=e.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),r=n.match(/ (\(.+\)$)/);n=r?n.replace(r[0],""):n;var o=this.extractLocation(r?r[1]:n),i=r&&n||void 0,a=["eval","<anonymous>"].indexOf(o[0])>-1?void 0:o[0];return new t({functionName:i,fileName:a,lineNumber:o[1],columnNumber:o[2],source:e})}),this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter((function(t){return!t.match(r)}),this).map((function(e){if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return new t({functionName:e});var n=/((.*".+"[^@]*)?[^@]*)(?:@)/,r=e.match(n),o=r&&r[1]?r[1]:void 0,i=this.extractLocation(e.replace(n,""));return new t({functionName:o,fileName:i[0],lineNumber:i[1],columnNumber:i[2],source:e})}),this)},parseOpera:function(t){return!t.stacktrace||t.message.indexOf("\n")>-1&&t.message.split("\n").length>t.stacktrace.split("\n").length?this.parseOpera9(t):t.stack?this.parseOpera11(t):this.parseOpera10(t)},parseOpera9:function(e){for(var n=/Line (\d+).*script (?:in )?(\S+)/i,r=e.message.split("\n"),o=[],i=2,a=r.length;i<a;i+=2){var s=n.exec(r[i]);s&&o.push(new t({fileName:s[2],lineNumber:s[1],source:r[i]}))}return o},parseOpera10:function(e){for(var n=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=e.stacktrace.split("\n"),o=[],i=0,a=r.length;i<a;i+=2){var s=n.exec(r[i]);s&&o.push(new t({functionName:s[3]||void 0,fileName:s[2],lineNumber:s[1],source:r[i]}))}return o},parseOpera11:function(n){return n.stack.split("\n").filter((function(t){return!!t.match(e)&&!t.match(/^Error created at/)}),this).map((function(e){var n,r=e.split("@"),o=this.extractLocation(r.pop()),i=r.shift()||"",a=i.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;i.match(/\(([^)]*)\)/)&&(n=i.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var s=void 0===n||"[arguments not available]"===n?void 0:n.split(",");return new t({functionName:a,args:s,fileName:o[0],lineNumber:o[1],columnNumber:o[2],source:e})}),this)}}})?r.apply(e,o):r)||(t.exports=i)}()},343:function(t,e){var n,r,o;!function(){"use strict";r=[],void 0===(o="function"==typeof(n=function(){function t(t){return t.charAt(0).toUpperCase()+t.substring(1)}function e(t){return function(){return this[t]}}var n=["isConstructor","isEval","isNative","isToplevel"],r=["columnNumber","lineNumber"],o=["fileName","functionName","source"],i=n.concat(r,o,["args"],["evalOrigin"]);function a(e){if(e)for(var n=0;n<i.length;n++)void 0!==e[i[n]]&&this["set"+t(i[n])](e[i[n]])}a.prototype={getArgs:function(){return this.args},setArgs:function(t){if("[object Array]"!==Object.prototype.toString.call(t))throw new TypeError("Args must be an Array");this.args=t},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(t){if(t instanceof a)this.evalOrigin=t;else{if(!(t instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new a(t)}},toString:function(){var t=this.getFileName()||"",e=this.getLineNumber()||"",n=this.getColumnNumber()||"",r=this.getFunctionName()||"";return this.getIsEval()?t?"[eval] ("+t+":"+e+":"+n+")":"[eval]:"+e+":"+n:r?r+" ("+t+":"+e+":"+n+")":t+":"+e+":"+n}},a.fromString=function(t){var e=t.indexOf("("),n=t.lastIndexOf(")"),r=t.substring(0,e),o=t.substring(e+1,n).split(","),i=t.substring(n+1);if(0===i.indexOf("@"))var s=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(i,""),u=s[1],c=s[2],l=s[3];return new a({functionName:r,args:o||void 0,fileName:u,lineNumber:c||void 0,columnNumber:l||void 0})};for(var s=0;s<n.length;s++)a.prototype["get"+t(n[s])]=e(n[s]),a.prototype["set"+t(n[s])]=function(t){return function(e){this[t]=Boolean(e)}}(n[s]);for(var u=0;u<r.length;u++)a.prototype["get"+t(r[u])]=e(r[u]),a.prototype["set"+t(r[u])]=function(t){return function(e){if(n=e,isNaN(parseFloat(n))||!isFinite(n))throw new TypeError(t+" must be a Number");var n;this[t]=Number(e)}}(r[u]);for(var c=0;c<o.length;c++)a.prototype["get"+t(o[c])]=e(o[c]),a.prototype["set"+t(o[c])]=function(t){return function(e){this[t]=String(e)}}(o[c]);return a})?n.apply(e,r):n)||(t.exports=o)}()}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{"use strict";var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var r,o=function(){return o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o.apply(this,arguments)};function i(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}function a(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function s(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function u(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function l(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError,function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(r||(r={}));var d=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:r.RECORD_AND_SAMPLED}},t.prototype.toString=function(){return"AlwaysOnSampler"},t}(),p="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof n.g?n.g:{},f="1.9.0",h=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,m=function(t){var e=new Set([t]),n=new Set,r=t.match(h);if(!r)return function(){return!1};var o=+r[1],i=+r[2],a=+r[3];if(null!=r[4])return function(e){return e===t};function s(t){return n.add(t),!1}function u(t){return e.add(t),!0}return function(t){if(e.has(t))return!0;if(n.has(t))return!1;var r=t.match(h);if(!r)return s(t);var c=+r[1],l=+r[2],d=+r[3];return null!=r[4]||o!==c?s(t):0===o?i===l&&a<=d?u(t):s(t):i<=l?u(t):s(t)}}(f),g=f.split(".")[0],v=Symbol.for("opentelemetry.js.api."+g),y=p;function E(t,e,n,r){var o;void 0===r&&(r=!1);var i=y[v]=null!==(o=y[v])&&void 0!==o?o:{version:f};if(!r&&i[t]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+t);return n.error(a.stack||a.message),!1}return i.version!==f?(a=new Error("@opentelemetry/api: Registration of version v"+i.version+" for "+t+" does not match previously registered API v"+f),n.error(a.stack||a.message),!1):(i[t]=e,n.debug("@opentelemetry/api: Registered a global for "+t+" v"+f+"."),!0)}function _(t){var e,n,r=null===(e=y[v])||void 0===e?void 0:e.version;if(r&&m(r))return null===(n=y[v])||void 0===n?void 0:n[t]}function T(t,e){e.debug("@opentelemetry/api: Unregistering a global for "+t+" v"+f+".");var n=y[v];n&&delete n[t]}var S,b=function(){function t(t){this._namespace=t.namespace||"DiagComponentLogger"}return t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return I("debug",this._namespace,t)},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return I("error",this._namespace,t)},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return I("info",this._namespace,t)},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return I("warn",this._namespace,t)},t.prototype.verbose=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return I("verbose",this._namespace,t)},t}();function I(t,e,n){var r=_("diag");if(r)return n.unshift(e),r[t].apply(r,function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(n),!1))}!function(t){t[t.NONE=0]="NONE",t[t.ERROR=30]="ERROR",t[t.WARN=50]="WARN",t[t.INFO=60]="INFO",t[t.DEBUG=70]="DEBUG",t[t.VERBOSE=80]="VERBOSE",t[t.ALL=9999]="ALL"}(S||(S={}));var C,O=function(){function t(){function t(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=_("diag");if(r)return r[t].apply(r,function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(e),!1))}}var e=this;e.setLogger=function(t,n){var r,o,i;if(void 0===n&&(n={logLevel:S.INFO}),t===e){var a=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return e.error(null!==(r=a.stack)&&void 0!==r?r:a.message),!1}"number"==typeof n&&(n={logLevel:n});var s=_("diag"),u=function(t,e){function n(n,r){var o=e[n];return"function"==typeof o&&t>=r?o.bind(e):function(){}}return t<S.NONE?t=S.NONE:t>S.ALL&&(t=S.ALL),e=e||{},{error:n("error",S.ERROR),warn:n("warn",S.WARN),info:n("info",S.INFO),debug:n("debug",S.DEBUG),verbose:n("verbose",S.VERBOSE)}}(null!==(o=n.logLevel)&&void 0!==o?o:S.INFO,t);if(s&&!n.suppressOverrideMessage){var c=null!==(i=(new Error).stack)&&void 0!==i?i:"<failed to generate stacktrace>";s.warn("Current logger will be overwritten from "+c),u.warn("Current logger will overwrite one already registered from "+c)}return E("diag",u,e,!0)},e.disable=function(){T("diag",e)},e.createComponentLogger=function(t){return new b(t)},e.verbose=t("verbose"),e.debug=t("debug"),e.info=t("info"),e.warn=t("warn"),e.error=t("error")}return t.instance=function(){return this._instance||(this._instance=new t),this._instance},t}(),R=O.instance();function w(t){return Symbol.for(t)}!function(t){t[t.NONE=0]="NONE",t[t.SAMPLED=1]="SAMPLED"}(C||(C={}));var A,L=new function t(e){var n=this;n._currentContext=e?new Map(e):new Map,n.getValue=function(t){return n._currentContext.get(t)},n.setValue=function(e,r){var o=new t(n._currentContext);return o._currentContext.set(e,r),o},n.deleteValue=function(e){var r=new t(n._currentContext);return r._currentContext.delete(e),r}},N=function(){function t(){}return t.prototype.active=function(){return L},t.prototype.with=function(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];return e.call.apply(e,function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([n],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(r),!1))},t.prototype.bind=function(t,e){return e},t.prototype.enable=function(){return this},t.prototype.disable=function(){return this},t}(),M="context",x=new N,P=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalContextManager=function(t){return E(M,t,O.instance())},t.prototype.active=function(){return this._getContextManager().active()},t.prototype.with=function(t,e,n){for(var r,o=[],i=3;i<arguments.length;i++)o[i-3]=arguments[i];return(r=this._getContextManager()).with.apply(r,function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([t,e,n],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(o),!1))},t.prototype.bind=function(t,e){return this._getContextManager().bind(t,e)},t.prototype._getContextManager=function(){return _(M)||x},t.prototype.disable=function(){this._getContextManager().disable(),T(M,O.instance())},t}(),k=P.getInstance();!function(t){t.AlwaysOff="always_off",t.AlwaysOn="always_on",t.ParentBasedAlwaysOff="parentbased_always_off",t.ParentBasedAlwaysOn="parentbased_always_on",t.ParentBasedTraceIdRatio="parentbased_traceidratio",t.TraceIdRatio="traceidratio"}(A||(A={}));var D=["OTEL_SDK_DISABLED"];function U(t){return D.indexOf(t)>-1}var B=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];function F(t){return B.indexOf(t)>-1}var j=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function G(t){return j.indexOf(t)>-1}var W=1/0,X={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_BLRP_EXPORT_TIMEOUT:3e4,OTEL_BLRP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BLRP_MAX_QUEUE_SIZE:2048,OTEL_BLRP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_LOGS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_LOGS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_LOGS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:S.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:W,OTEL_ATTRIBUTE_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:W,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:128,OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT:W,OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT:128,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:128,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:A.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_LOGS_EXPORTER:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_LOGS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_LOGS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_LOGS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative"};function H(t,e,n){if(void 0!==n[t]){var r=String(n[t]);e[t]="true"===r.toLowerCase()}}function V(t,e,n,r,o){if(void 0===r&&(r=-1/0),void 0===o&&(o=1/0),void 0!==n[t]){var i=Number(n[t]);isNaN(i)||(e[t]=i<r?r:i>o?o:i)}}function Y(t,e,n,r){void 0===r&&(r=",");var o=n[t];"string"==typeof o&&(e[t]=o.split(r).map((function(t){return t.trim()})))}var z={ALL:S.ALL,VERBOSE:S.VERBOSE,DEBUG:S.DEBUG,INFO:S.INFO,WARN:S.WARN,ERROR:S.ERROR,NONE:S.NONE};function Z(t,e,n){var r=n[t];if("string"==typeof r){var o=z[r.toUpperCase()];null!=o&&(e[t]=o)}}var K="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof n.g?n.g:{};var J,Q=function(){function t(){var t=this;this._promise=new Promise((function(e,n){t._resolve=e,t._reject=n}))}return Object.defineProperty(t.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),t.prototype.resolve=function(t){this._resolve(t)},t.prototype.reject=function(t){this._reject(t)},t}(),q=function(){function t(t,e){this._callback=t,this._that=e,this._isCalled=!1,this._deferred=new Q}return Object.defineProperty(t.prototype,"isCalled",{get:function(){return this._isCalled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this._deferred.promise},enumerable:!1,configurable:!0}),t.prototype.call=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(!this._isCalled){this._isCalled=!0;try{Promise.resolve((t=this._callback).call.apply(t,function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([this._that],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(n),!1))).then((function(t){return e._deferred.resolve(t)}),(function(t){return e._deferred.reject(t)}))}catch(t){this._deferred.reject(t)}}return this._deferred.promise},t}(),$=w("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function tt(t){return!0===t.getValue($)}!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"}(J||(J={}));function et(t){try{!function(t){R.error(function(t){return"string"==typeof t?t:JSON.stringify(function(t){for(var e={},n=t;null!==n;)Object.getOwnPropertyNames(n).forEach((function(t){if(!e[t]){var r=n[t];r&&(e[t]=String(r))}})),n=Object.getPrototypeOf(n);return e}(t))}(t))}(t)}catch(t){}}var nt,rt=function(){function t(t,e){this._exporter=t,this._isExporting=!1,this._finishedSpans=[],this._droppedSpansCount=0;var n,r=(n=function(t){var e={};for(var n in X){var r=n;if("OTEL_LOG_LEVEL"===r)Z(r,e,t);else if(U(r))H(r,e,t);else if(F(r))V(r,e,t);else if(G(r))Y(r,e,t);else{var o=t[r];null!=o&&(e[r]=String(o))}}return e}(K),Object.assign({},X,n));this._maxExportBatchSize="number"==typeof(null==e?void 0:e.maxExportBatchSize)?e.maxExportBatchSize:r.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize="number"==typeof(null==e?void 0:e.maxQueueSize)?e.maxQueueSize:r.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis="number"==typeof(null==e?void 0:e.scheduledDelayMillis)?e.scheduledDelayMillis:r.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis="number"==typeof(null==e?void 0:e.exportTimeoutMillis)?e.exportTimeoutMillis:r.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new q(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(R.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}return t.prototype.forceFlush=function(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()},t.prototype.onStart=function(t,e){},t.prototype.onEnd=function(t){this._shutdownOnce.isCalled||t.spanContext().traceFlags&C.SAMPLED&&this._addToBuffer(t)},t.prototype.shutdown=function(){return this._shutdownOnce.call()},t.prototype._shutdown=function(){var t=this;return Promise.resolve().then((function(){return t.onShutdown()})).then((function(){return t._flushAll()})).then((function(){return t._exporter.shutdown()}))},t.prototype._addToBuffer=function(t){if(this._finishedSpans.length>=this._maxQueueSize)return 0===this._droppedSpansCount&&R.debug("maxQueueSize reached, dropping spans"),void this._droppedSpansCount++;this._droppedSpansCount>0&&(R.warn("Dropped "+this._droppedSpansCount+" spans because maxQueueSize reached"),this._droppedSpansCount=0),this._finishedSpans.push(t),this._maybeStartTimer()},t.prototype._flushAll=function(){var t=this;return new Promise((function(e,n){for(var r=[],o=0,i=Math.ceil(t._finishedSpans.length/t._maxExportBatchSize);o<i;o++)r.push(t._flushOneBatch());Promise.all(r).then((function(){e()})).catch(n)}))},t.prototype._flushOneBatch=function(){var t=this;return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise((function(e,n){var r=setTimeout((function(){n(new Error("Timeout"))}),t._exportTimeoutMillis);k.with(k.active().setValue($,!0),(function(){var o;t._finishedSpans.length<=t._maxExportBatchSize?(o=t._finishedSpans,t._finishedSpans=[]):o=t._finishedSpans.splice(0,t._maxExportBatchSize);for(var i=function(){return t._exporter.export(o,(function(t){var o;clearTimeout(r),t.code===J.SUCCESS?e():n(null!==(o=t.error)&&void 0!==o?o:new Error("BatchSpanProcessor: span export failed"))}))},a=null,s=0,u=o.length;s<u;s++){var c=o[s];c.resource.asyncAttributesPending&&c.resource.waitForAsyncAttributes&&(null!=a||(a=[]),a.push(c.resource.waitForAsyncAttributes()))}null===a?i():Promise.all(a).then(i,(function(t){et(t),n(t)}))}))}))},t.prototype._maybeStartTimer=function(){var t=this;if(!this._isExporting){var e=function(){t._isExporting=!0,t._flushOneBatch().finally((function(){t._isExporting=!1,t._finishedSpans.length>0&&(t._clearTimer(),t._maybeStartTimer())})).catch((function(e){t._isExporting=!1,et(e)}))};if(this._finishedSpans.length>=this._maxExportBatchSize)return e();void 0===this._timer&&(this._timer=setTimeout((function(){return e()}),this._scheduledDelayMillis),this._timer)}},t.prototype._clearTimer=function(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)},t}(),ot=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),it=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.onInit(n),r}return ot(e,t),e.prototype.onInit=function(t){var e=this;!0!==(null==t?void 0:t.disableAutoFlushOnDocumentHide)&&"undefined"!=typeof document&&(this._visibilityChangeListener=function(){"hidden"===document.visibilityState&&e.forceFlush()},this._pageHideListener=function(){e.forceFlush()},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))},e.prototype.onShutdown=function(){"undefined"!=typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))},e}(rt);!function(t){t.CONNECT_END="connectEnd",t.CONNECT_START="connectStart",t.DECODED_BODY_SIZE="decodedBodySize",t.DOM_COMPLETE="domComplete",t.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",t.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",t.DOM_INTERACTIVE="domInteractive",t.DOMAIN_LOOKUP_END="domainLookupEnd",t.DOMAIN_LOOKUP_START="domainLookupStart",t.ENCODED_BODY_SIZE="encodedBodySize",t.FETCH_START="fetchStart",t.LOAD_EVENT_END="loadEventEnd",t.LOAD_EVENT_START="loadEventStart",t.NAVIGATION_START="navigationStart",t.REDIRECT_END="redirectEnd",t.REDIRECT_START="redirectStart",t.REQUEST_START="requestStart",t.RESPONSE_END="responseEnd",t.RESPONSE_START="responseStart",t.SECURE_CONNECTION_START="secureConnectionStart",t.UNLOAD_EVENT_END="unloadEventEnd",t.UNLOAD_EVENT_START="unloadEventStart"}(nt||(nt={}));var at=performance,st=Math.pow(10,6),ut=Math.pow(10,9);function ct(t){var e=t/1e3;return[Math.trunc(e),Math.round(t%1e3*st)]}function lt(){var t=at.timeOrigin;if("number"!=typeof t){var e=at;t=e.timing&&e.timing.fetchStart}return t}function dt(t){return gt(ct(lt()),ct("number"==typeof t?t:at.now()))}function pt(t){if(ht(t))return t;if("number"==typeof t)return t<lt()?dt(t):ct(t);if(t instanceof Date)return ct(t.getTime());throw TypeError("Invalid input type")}function ft(t){return t[0]*ut+t[1]}function ht(t){return Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}function mt(t){return ht(t)||"number"==typeof t||t instanceof Date}function gt(t,e){var n=[t[0]+e[0],t[1]+e[1]];return n[1]>=ut&&(n[1]-=ut,n[0]+=1),n}var vt,yt="exception.type",Et="exception.message";function _t(t,e){return e in t}function Tt(t,e,n,r){var o=void 0,i=void 0;_t(n,e)&&"number"==typeof n[e]&&(o=n[e]);var a=r||nt.FETCH_START;if(_t(n,a)&&"number"==typeof n[a]&&(i=n[a]),void 0!==o&&void 0!==i&&o>=i)return t.addEvent(e,o),t}function St(t,e){Tt(t,nt.FETCH_START,e),Tt(t,nt.DOMAIN_LOOKUP_START,e),Tt(t,nt.DOMAIN_LOOKUP_END,e),Tt(t,nt.CONNECT_START,e),_t(e,"name")&&e.name.startsWith("https:")&&Tt(t,nt.SECURE_CONNECTION_START,e),Tt(t,nt.CONNECT_END,e),Tt(t,nt.REQUEST_START,e),Tt(t,nt.RESPONSE_START,e),Tt(t,nt.RESPONSE_END,e);var n=e[nt.ENCODED_BODY_SIZE];void 0!==n&&t.setAttribute("http.response_content_length",n);var r=e[nt.DECODED_BODY_SIZE];void 0!==r&&n!==r&&t.setAttribute("http.response_content_length_uncompressed",r)}function bt(){return"undefined"!=typeof location?location.origin:void 0}function It(t,e,n,r,o,i){void 0===o&&(o=new WeakSet);var a=Ct(t),s=function(t,e,n,r,o,i){var a=ft(e),s=ft(n),u=r.filter((function(e){var n=ft(pt(e[nt.FETCH_START])),r=ft(pt(e[nt.RESPONSE_END]));return e.initiatorType.toLowerCase()===(i||"xmlhttprequest")&&e.name===t&&n>=a&&r<=s}));return u.length>0&&(u=u.filter((function(t){return!o.has(t)}))),u}(t=a.toString(),e,n,r,o,i);if(0===s.length)return{mainRequest:void 0};if(1===s.length)return{mainRequest:s[0]};var u=function(t){return t.slice().sort((function(t,e){var n=t[nt.FETCH_START],r=e[nt.FETCH_START];return n>r?1:n<r?-1:0}))}(s);if(a.origin!==bt()&&u.length>1){var c=u[0],l=function(t,e,n){for(var r,o=ft(n),i=ft(pt(e)),a=t[1],s=t.length,u=1;u<s;u++){var c=t[u],l=ft(pt(c[nt.FETCH_START])),d=o-ft(pt(c[nt.RESPONSE_END]));l>=i&&(!r||d<r)&&(r=d,a=c)}return a}(u,c[nt.RESPONSE_END],n),d=c[nt.RESPONSE_END];return l[nt.FETCH_START]<d&&(l=c,c=void 0),{corsPreFlightRequest:c,mainRequest:l}}return{mainRequest:s[0]}}function Ct(t){if("function"==typeof URL)return new URL(t,"undefined"!=typeof document?document.baseURI:"undefined"!=typeof location?location.href:void 0);var e=(vt||(vt=document.createElement("a")),vt);return e.href=t,e}function Ot(t,e){if(t.nodeType===Node.DOCUMENT_NODE)return"/";var n=function(t,e){var n=t.nodeType,r=function(t){if(!t.parentNode)return 0;var e=[t.nodeType];t.nodeType===Node.CDATA_SECTION_NODE&&e.push(Node.TEXT_NODE);var n=Array.from(t.parentNode.childNodes);return(n=n.filter((function(n){var r=n.localName;return e.indexOf(n.nodeType)>=0&&r===t.localName}))).length>=1?n.indexOf(t)+1:0}(t),o="";if(n===Node.ELEMENT_NODE){var i=t.getAttribute("id");if(e&&i)return'//*[@id="'+i+'"]';o=t.localName}else if(n===Node.TEXT_NODE||n===Node.CDATA_SECTION_NODE)o="text()";else{if(n!==Node.COMMENT_NODE)return"";o="comment()"}return o&&r>1?"/"+o+"["+r+"]":"/"+o}(t,e);if(e&&n.indexOf("@id")>0)return n;var r="";return t.parentNode&&(r+=Ot(t.parentNode,!1)),r+n}function Rt(t,e){var n=e||[];return("string"==typeof n||n instanceof RegExp)&&(n=[n]),Ct(t).origin===bt()||n.some((function(e){return n=t,"string"==typeof(r=e)?n===r:!!n.match(r);var n,r}))}var wt="0000000000000000",At="00000000000000000000000000000000",Lt={traceId:At,spanId:wt,traceFlags:C.NONE},Nt=function(){function t(t){void 0===t&&(t=Lt),this._spanContext=t}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(t,e){return this},t.prototype.setAttributes=function(t){return this},t.prototype.addEvent=function(t,e){return this},t.prototype.addLink=function(t){return this},t.prototype.addLinks=function(t){return this},t.prototype.setStatus=function(t){return this},t.prototype.updateName=function(t){return this},t.prototype.end=function(t){},t.prototype.isRecording=function(){return!1},t.prototype.recordException=function(t,e){},t}(),Mt=w("OpenTelemetry Context Key SPAN");function xt(t){return t.getValue(Mt)||void 0}function Pt(){return xt(P.getInstance().active())}function kt(t,e){return t.setValue(Mt,e)}function Dt(t){return t.deleteValue(Mt)}function Ut(t,e){return kt(t,new Nt(e))}function Bt(t){var e;return null===(e=xt(t))||void 0===e?void 0:e.spanContext()}var Ft=/^([0-9a-f]{32})$/i,jt=/^[0-9a-f]{16}$/i;function Gt(t){return Ft.test(t)&&t!==At}function Wt(t){return jt.test(t)&&t!==wt}function Xt(t){return Gt(t.traceId)&&Wt(t.spanId)}function Ht(t){return new Nt(t)}var Vt=P.getInstance(),Yt=function(){function t(){}return t.prototype.startSpan=function(t,e,n){if(void 0===n&&(n=Vt.active()),Boolean(null==e?void 0:e.root))return new Nt;var r,o=n&&Bt(n);return"object"==typeof(r=o)&&"string"==typeof r.spanId&&"string"==typeof r.traceId&&"number"==typeof r.traceFlags&&Xt(o)?new Nt(o):new Nt},t.prototype.startActiveSpan=function(t,e,n,r){var o,i,a;if(!(arguments.length<2)){2===arguments.length?a=e:3===arguments.length?(o=e,a=n):(o=e,i=n,a=r);var s=null!=i?i:Vt.active(),u=this.startSpan(t,o,s),c=kt(s,u);return Vt.with(c,a,void 0,u)}},t}(),zt=new Yt,Zt=function(){function t(t,e,n,r){this._provider=t,this.name=e,this.version=n,this.options=r}return t.prototype.startSpan=function(t,e,n){return this._getTracer().startSpan(t,e,n)},t.prototype.startActiveSpan=function(t,e,n,r){var o=this._getTracer();return Reflect.apply(o.startActiveSpan,o,arguments)},t.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):zt},t}(),Kt=new(function(){function t(){}return t.prototype.getTracer=function(t,e,n){return new Yt},t}()),Jt=function(){function t(){}return t.prototype.getTracer=function(t,e,n){var r;return null!==(r=this.getDelegateTracer(t,e,n))&&void 0!==r?r:new Zt(this,t,e,n)},t.prototype.getDelegate=function(){var t;return null!==(t=this._delegate)&&void 0!==t?t:Kt},t.prototype.setDelegate=function(t){this._delegate=t},t.prototype.getDelegateTracer=function(t,e,n){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(t,e,n)},t}(),Qt="trace",qt=function(){function t(){this._proxyTracerProvider=new Jt,this.wrapSpanContext=Ht,this.isSpanContextValid=Xt,this.deleteSpan=Dt,this.getSpan=xt,this.getActiveSpan=Pt,this.getSpanContext=Bt,this.setSpan=kt,this.setSpanContext=Ut}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalTracerProvider=function(t){var e=E(Qt,this._proxyTracerProvider,O.instance());return e&&this._proxyTracerProvider.setDelegate(t),e},t.prototype.getTracerProvider=function(){return _(Qt)||this._proxyTracerProvider},t.prototype.getTracer=function(t,e){return this.getTracerProvider().getTracer(t,e)},t.prototype.disable=function(){T(Qt,O.instance()),this._proxyTracerProvider=new Jt},t}().getInstance(),$t=function(){function t(){}return t.prototype.inject=function(t,e){},t.prototype.extract=function(t,e){return t},t.prototype.fields=function(){return[]},t}(),te={get:function(t,e){if(null!=t)return t[e]},keys:function(t){return null==t?[]:Object.keys(t)}},ee={set:function(t,e,n){null!=t&&(t[e]=n)}},ne=w("OpenTelemetry Baggage Key");function re(t){return t.getValue(ne)||void 0}function oe(){return re(P.getInstance().active())}function ie(t,e){return t.setValue(ne,e)}function ae(t){return t.deleteValue(ne)}var se=function(){function t(t){this._entries=t?new Map(t):new Map}return t.prototype.getEntry=function(t){var e=this._entries.get(t);if(e)return Object.assign({},e)},t.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map((function(t){var e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(t,2);return[e[0],e[1]]}))},t.prototype.setEntry=function(e,n){var r=new t(this._entries);return r._entries.set(e,n),r},t.prototype.removeEntry=function(e){var n=new t(this._entries);return n._entries.delete(e),n},t.prototype.removeEntries=function(){for(var e,n,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var i=new t(this._entries);try{for(var a=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(r),s=a.next();!s.done;s=a.next()){var u=s.value;i._entries.delete(u)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},t.prototype.clear=function(){return new t},t}(),ue=Symbol("BaggageEntryMetadata"),ce=O.instance();function le(t){return void 0===t&&(t={}),new se(new Map(Object.entries(t)))}function de(t){return"string"!=typeof t&&(ce.error("Cannot create baggage metadata from unknown type: "+typeof t),t=""),{__TYPE__:ue,toString:function(){return t}}}var pe,fe,he,me="propagation",ge=new $t,ve=function(){function t(){this.createBaggage=le,this.getBaggage=re,this.getActiveBaggage=oe,this.setBaggage=ie,this.deleteBaggage=ae}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalPropagator=function(t){return E(me,t,O.instance())},t.prototype.inject=function(t,e,n){return void 0===n&&(n=ee),this._getGlobalPropagator().inject(t,e,n)},t.prototype.extract=function(t,e,n){return void 0===n&&(n=te),this._getGlobalPropagator().extract(t,e,n)},t.prototype.fields=function(){return this._getGlobalPropagator().fields()},t.prototype.disable=function(){T(me,O.instance())},t.prototype._getGlobalPropagator=function(){return _(me)||ge},t}().getInstance(),ye=Function.prototype.toString,Ee=ye.call(Object),_e=(pe=Object.getPrototypeOf,fe=Object,function(t){return pe(fe(t))}),Te=Object.prototype,Se=Te.hasOwnProperty,be=Symbol?Symbol.toStringTag:void 0,Ie=Te.toString;function Ce(t){if(!function(t){return null!=t&&"object"==typeof t}(t)||"[object Object]"!==function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":be&&be in Object(t)?function(t){var e=Se.call(t,be),n=t[be],r=!1;try{t[be]=void 0,r=!0}catch(t){}var o=Ie.call(t);return r&&(e?t[be]=n:delete t[be]),o}(t):function(t){return Ie.call(t)}(t)}(t))return!1;var e=_e(t);if(null===e)return!0;var n=Se.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&ye.call(n)===Ee}function Oe(t){return Ae(t)?t.slice():t}function Re(t,e,n,r){var o;if(void 0===n&&(n=0),!(n>20)){if(n++,Me(t)||Me(e)||Le(e))o=Oe(e);else if(Ae(t)){if(o=t.slice(),Ae(e))for(var i=0,a=e.length;i<a;i++)o.push(Oe(e[i]));else if(Ne(e))for(i=0,a=(s=Object.keys(e)).length;i<a;i++)o[u=s[i]]=Oe(e[u])}else if(Ne(t))if(Ne(e)){if(!function(t,e){return!(!Ce(t)||!Ce(e))}(t,e))return e;var s;for(o=Object.assign({},t),i=0,a=(s=Object.keys(e)).length;i<a;i++){var u,c=e[u=s[i]];if(Me(c))void 0===c?delete o[u]:o[u]=c;else{var l=o[u],d=c;if(we(t,u,r)||we(e,u,r))delete o[u];else{if(Ne(l)&&Ne(d)){var p=r.get(l)||[],f=r.get(d)||[];p.push({obj:t,key:u}),f.push({obj:e,key:u}),r.set(l,p),r.set(d,f)}o[u]=Re(o[u],c,n,r)}}}}else o=e;return o}}function we(t,e,n){for(var r=n.get(t[e])||[],o=0,i=r.length;o<i;o++){var a=r[o];if(a.key===e&&a.obj===t)return!0}return!1}function Ae(t){return Array.isArray(t)}function Le(t){return"function"==typeof t}function Ne(t){return!Me(t)&&!Ae(t)&&!Le(t)&&"object"==typeof t}function Me(t){return"string"==typeof t||"number"==typeof t||"boolean"==typeof t||void 0===t||t instanceof Date||t instanceof RegExp||null===t}!function(t){t.AlwaysOff="always_off",t.AlwaysOn="always_on",t.ParentBasedAlwaysOff="parentbased_always_off",t.ParentBasedAlwaysOn="parentbased_always_on",t.ParentBasedTraceIdRatio="parentbased_traceidratio",t.TraceIdRatio="traceidratio"}(he||(he={}));var xe=["OTEL_SDK_DISABLED"];function Pe(t){return xe.indexOf(t)>-1}var ke=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];function De(t){return ke.indexOf(t)>-1}var Ue=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function Be(t){return Ue.indexOf(t)>-1}var Fe=1/0,je=128,Ge={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_BLRP_EXPORT_TIMEOUT:3e4,OTEL_BLRP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BLRP_MAX_QUEUE_SIZE:2048,OTEL_BLRP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_LOGS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_LOGS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_LOGS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:S.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:Fe,OTEL_ATTRIBUTE_COUNT_LIMIT:je,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:Fe,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:je,OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT:Fe,OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT:je,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:128,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:he.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_LOGS_EXPORTER:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_LOGS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_LOGS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_LOGS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative"};function We(t,e,n){if(void 0!==n[t]){var r=String(n[t]);e[t]="true"===r.toLowerCase()}}function Xe(t,e,n,r,o){if(void 0===r&&(r=-1/0),void 0===o&&(o=1/0),void 0!==n[t]){var i=Number(n[t]);isNaN(i)||(e[t]=i<r?r:i>o?o:i)}}function He(t,e,n,r){void 0===r&&(r=",");var o=n[t];"string"==typeof o&&(e[t]=o.split(r).map((function(t){return t.trim()})))}var Ve={ALL:S.ALL,VERBOSE:S.VERBOSE,DEBUG:S.DEBUG,INFO:S.INFO,WARN:S.WARN,ERROR:S.ERROR,NONE:S.NONE};function Ye(t,e,n){var r=n[t];if("string"==typeof r){var o=Ve[r.toUpperCase()];null!=o&&(e[t]=o)}}function ze(t){var e={};for(var n in Ge){var r=n;if("OTEL_LOG_LEVEL"===r)Ye(r,e,t);else if(Pe(r))We(r,e,t);else if(De(r))Xe(r,e,t);else if(Be(r))He(r,e,t);else{var o=t[r];null!=o&&(e[r]=String(o))}}return e}var Ze="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof n.g?n.g:{};function Ke(){var t=ze(Ze);return Object.assign({},Ge,t)}var Je=function(){function t(t){var e;void 0===t&&(t={}),this._propagators=null!==(e=t.propagators)&&void 0!==e?e:[],this._fields=Array.from(new Set(this._propagators.map((function(t){return"function"==typeof t.fields?t.fields():[]})).reduce((function(t,e){return t.concat(e)}),[])))}return t.prototype.inject=function(t,e,n){var r,o;try{for(var i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(this._propagators),a=i.next();!a.done;a=i.next()){var s=a.value;try{s.inject(t,e,n)}catch(t){R.warn("Failed to inject with "+s.constructor.name+". Err: "+t.message)}}}catch(t){r={error:t}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}},t.prototype.extract=function(t,e,n){return this._propagators.reduce((function(t,r){try{return r.extract(t,e,n)}catch(t){R.warn("Failed to inject with "+r.constructor.name+". Err: "+t.message)}return t}),t)},t.prototype.fields=function(){return this._fields.slice()},t}(),Qe=w("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function qe(t){return!0===t.getValue(Qe)}var $e="[_0-9a-z-*/]",tn=new RegExp("^(?:[a-z]"+$e+"{0,255}|[a-z0-9]"+$e+"{0,240}@[a-z]"+$e+"{0,13})$"),en=/^[ -~]{0,255}[!-~]$/,nn=/,|=/,rn=function(){function t(t){this._internalState=new Map,t&&this._parse(t)}return t.prototype.set=function(t,e){var n=this._clone();return n._internalState.has(t)&&n._internalState.delete(t),n._internalState.set(t,e),n},t.prototype.unset=function(t){var e=this._clone();return e._internalState.delete(t),e},t.prototype.get=function(t){return this._internalState.get(t)},t.prototype.serialize=function(){var t=this;return this._keys().reduce((function(e,n){return e.push(n+"="+t.get(n)),e}),[]).join(",")},t.prototype._parse=function(t){t.length>512||(this._internalState=t.split(",").reverse().reduce((function(t,e){var n=e.trim(),r=n.indexOf("=");if(-1!==r){var o=n.slice(0,r),i=n.slice(r+1,e.length);(function(t){return tn.test(t)})(o)&&function(t){return en.test(t)&&!nn.test(t)}(i)&&t.set(o,i)}return t}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},t.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},t.prototype._clone=function(){var e=new t;return e._internalState=new Map(this._internalState),e},t}(),on="traceparent",an="tracestate",sn=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$"),un=function(){function t(){}return t.prototype.inject=function(t,e,n){var r=qt.getSpanContext(t);if(r&&!qe(t)&&Xt(r)){var o="00-"+r.traceId+"-"+r.spanId+"-0"+Number(r.traceFlags||C.NONE).toString(16);n.set(e,on,o),r.traceState&&n.set(e,an,r.traceState.serialize())}},t.prototype.extract=function(t,e,n){var r=n.get(e,on);if(!r)return t;var o=Array.isArray(r)?r[0]:r;if("string"!=typeof o)return t;var i=function(t){var e=sn.exec(t);return e?"00"===e[1]&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}:null}(o);if(!i)return t;i.isRemote=!0;var a=n.get(e,an);if(a){var s=Array.isArray(a)?a.join(","):a;i.traceState=new rn("string"==typeof s?s:void 0)}return qt.setSpanContext(t,i)},t.prototype.fields=function(){return[on,an]},t}(),cn="baggage";var ln,dn,pn,fn=function(){function t(){}return t.prototype.inject=function(t,e,n){var r=ve.getBaggage(t);if(r&&!qe(t)){var o=function(t){return t.getAllEntries().map((function(t){var e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(t,2),n=e[0],r=e[1],o=encodeURIComponent(n)+"="+encodeURIComponent(r.value);return void 0!==r.metadata&&(o+=";"+r.metadata.toString()),o}))}(r).filter((function(t){return t.length<=4096})).slice(0,180),i=function(t){return t.reduce((function(t,e){var n=t+(""!==t?",":"")+e;return n.length>8192?t:n}),"")}(o);i.length>0&&n.set(e,cn,i)}},t.prototype.extract=function(t,e,n){var r=n.get(e,cn),o=Array.isArray(r)?r.join(","):r;if(!o)return t;var i={};return 0===o.length?t:(o.split(",").forEach((function(t){var e=function(t){var e=t.split(";");if(!(e.length<=0)){var n=e.shift();if(n){var r=n.indexOf("=");if(!(r<=0)){var o,i=decodeURIComponent(n.substring(0,r).trim()),a=decodeURIComponent(n.substring(r+1).trim());return e.length>0&&(o=de(e.join(";"))),{key:i,value:a,metadata:o}}}}}(t);if(e){var n={value:e.value};e.metadata&&(n.metadata=e.metadata),i[e.key]=n}})),0===Object.entries(i).length?t:ve.setBaggage(t,ve.createBaggage(i)))},t.prototype.fields=function(){return[cn]},t}(),hn="telemetry.sdk.name",mn="telemetry.sdk.language",gn="telemetry.sdk.version",vn=((ln={})[hn]="opentelemetry",ln["process.runtime.name"]="browser",ln[mn]="webjs",ln[gn]="1.25.1",ln),yn=function(){return yn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},yn.apply(this,arguments)},En=function(){function t(t,e){var n,r=this;this._attributes=t,this.asyncAttributesPending=null!=e,this._syncAttributes=null!==(n=this._attributes)&&void 0!==n?n:{},this._asyncAttributesPromise=null==e?void 0:e.then((function(t){return r._attributes=Object.assign({},r._attributes,t),r.asyncAttributesPending=!1,t}),(function(t){return R.debug("a resource's async attributes promise rejected: %s",t),r.asyncAttributesPending=!1,{}}))}return t.empty=function(){return t.EMPTY},t.default=function(){var e;return new t(((e={})["service.name"]="unknown_service",e[mn]=vn[mn],e[hn]=vn[hn],e[gn]=vn[gn],e))},Object.defineProperty(t.prototype,"attributes",{get:function(){var t;return this.asyncAttributesPending&&R.error("Accessing resource attributes before async attributes settled"),null!==(t=this._attributes)&&void 0!==t?t:{}},enumerable:!1,configurable:!0}),t.prototype.waitForAsyncAttributes=function(){return function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}(this,void 0,void 0,(function(){return function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(t){switch(t.label){case 0:return this.asyncAttributesPending?[4,this._asyncAttributesPromise]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.merge=function(e){var n,r=this;if(!e)return this;var o=yn(yn({},this._syncAttributes),null!==(n=e._syncAttributes)&&void 0!==n?n:e.attributes);if(!this._asyncAttributesPromise&&!e._asyncAttributesPromise)return new t(o);var i=Promise.all([this._asyncAttributesPromise,e._asyncAttributesPromise]).then((function(t){var n,o=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(t,2),i=o[0],a=o[1];return yn(yn(yn(yn({},r._syncAttributes),i),null!==(n=e._syncAttributes)&&void 0!==n?n:e.attributes),a)}));return new t(o,i)},t.EMPTY=new t({}),t}();!function(t){t[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"}(dn||(dn={})),function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(pn||(pn={}));var _n,Tn=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Sn=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a};function bn(t){var e,n,r={};if("object"!=typeof t||null==t)return r;try{for(var o=Tn(Object.entries(t)),i=o.next();!i.done;i=o.next()){var a=Sn(i.value,2),s=a[0],u=a[1];In(s)?Cn(u)?Array.isArray(u)?r[s]=u.slice():r[s]=u:R.warn("Invalid attribute value set for key: "+s):R.warn("Invalid attribute key: "+s)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r}function In(t){return"string"==typeof t&&t.length>0}function Cn(t){return null==t||(Array.isArray(t)?function(t){var e,n,r;try{for(var o=Tn(t),i=o.next();!i.done;i=o.next()){var a=i.value;if(null!=a){if(!r){if(On(a)){r=typeof a;continue}return!1}if(typeof a!==r)return!1}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return!0}(t):On(t))}function On(t){switch(typeof t){case"number":case"boolean":case"string":return!0}return!1}!function(t){t[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"}(_n||(_n={}));var Rn,wn=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},An=function(){function t(t,e,n,r,o,i,a,s,u,c){void 0===a&&(a=[]),this.attributes={},this.links=[],this.events=[],this._droppedAttributesCount=0,this._droppedEventsCount=0,this._droppedLinksCount=0,this.status={code:_n.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=n,this._spanContext=r,this.parentSpanId=i,this.kind=o,this.links=a;var l=Date.now();this._performanceStartTime=at.now(),this._performanceOffset=l-(this._performanceStartTime+lt()),this._startTimeProvided=null!=s,this.startTime=this._getTime(null!=s?s:l),this.resource=t.resource,this.instrumentationLibrary=t.instrumentationLibrary,this._spanLimits=t.getSpanLimits(),this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,null!=c&&this.setAttributes(c),this._spanProcessor=t.getActiveSpanProcessor(),this._spanProcessor.onStart(this,e)}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(t,e){return null==e||this._isSpanEnded()?this:0===t.length?(R.warn("Invalid attribute key: "+t),this):Cn(e)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,t)?(this._droppedAttributesCount++,this):(this.attributes[t]=this._truncateToSize(e),this):(R.warn("Invalid attribute value set for key: "+t),this)},t.prototype.setAttributes=function(t){var e,n;try{for(var r=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(Object.entries(t)),o=r.next();!o.done;o=r.next()){var i=wn(o.value,2),a=i[0],s=i[1];this.setAttribute(a,s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return this},t.prototype.addEvent=function(t,e,n){if(this._isSpanEnded())return this;if(0===this._spanLimits.eventCountLimit)return R.warn("No events allowed."),this._droppedEventsCount++,this;this.events.length>=this._spanLimits.eventCountLimit&&(0===this._droppedEventsCount&&R.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),mt(e)&&(mt(n)||(n=e),e=void 0);var r=bn(e);return this.events.push({name:t,attributes:r,time:this._getTime(n),droppedAttributesCount:0}),this},t.prototype.addLink=function(t){return this.links.push(t),this},t.prototype.addLinks=function(t){var e;return(e=this.links).push.apply(e,function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([],wn(t),!1)),this},t.prototype.setStatus=function(t){return this._isSpanEnded()||(this.status=t),this},t.prototype.updateName=function(t){return this._isSpanEnded()||(this.name=t),this},t.prototype.end=function(t){this._isSpanEnded()?R.error(this.name+" "+this._spanContext.traceId+"-"+this._spanContext.spanId+" - You can only call end() on a span once."):(this._ended=!0,this.endTime=this._getTime(t),this._duration=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return r<0&&(n-=1,r+=ut),[n,r]}(this.startTime,this.endTime),this._duration[0]<0&&(R.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&R.warn("Dropped "+this._droppedEventsCount+" events because eventCountLimit reached"),this._spanProcessor.onEnd(this))},t.prototype._getTime=function(t){if("number"==typeof t&&t<at.now())return dt(t+this._performanceOffset);if("number"==typeof t)return ct(t);if(t instanceof Date)return ct(t.getTime());if(ht(t))return t;if(this._startTimeProvided)return ct(Date.now());var e=at.now()-this._performanceStartTime;return gt(this.startTime,ct(e))},t.prototype.isRecording=function(){return!1===this._ended},t.prototype.recordException=function(t,e){var n={};"string"==typeof t?n[Et]=t:t&&(t.code?n[yt]=t.code.toString():t.name&&(n[yt]=t.name),t.message&&(n[Et]=t.message),t.stack&&(n["exception.stacktrace"]=t.stack)),n[yt]||n[Et]?this.addEvent("exception",n,e):R.warn("Failed to record an exception "+t)},Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ended",{get:function(){return this._ended},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"droppedAttributesCount",{get:function(){return this._droppedAttributesCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"droppedEventsCount",{get:function(){return this._droppedEventsCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"droppedLinksCount",{get:function(){return this._droppedLinksCount},enumerable:!1,configurable:!0}),t.prototype._isSpanEnded=function(){return this._ended&&R.warn("Can not execute the operation on ended Span {traceId: "+this._spanContext.traceId+", spanId: "+this._spanContext.spanId+"}"),this._ended},t.prototype._truncateToLimitUtil=function(t,e){return t.length<=e?t:t.substr(0,e)},t.prototype._truncateToSize=function(t){var e=this,n=this._attributeValueLengthLimit;return n<=0?(R.warn("Attribute value limit must be positive, got "+n),t):"string"==typeof t?this._truncateToLimitUtil(t,n):Array.isArray(t)?t.map((function(t){return"string"==typeof t?e._truncateToLimitUtil(t,n):t})):t},t}();!function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(Rn||(Rn={}));var Ln=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:Rn.NOT_RECORD}},t.prototype.toString=function(){return"AlwaysOffSampler"},t}(),Nn=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:Rn.RECORD_AND_SAMPLED}},t.prototype.toString=function(){return"AlwaysOnSampler"},t}();function Mn(t){try{!function(t){R.error(function(t){return"string"==typeof t?t:JSON.stringify(function(t){for(var e={},n=t;null!==n;)Object.getOwnPropertyNames(n).forEach((function(t){if(!e[t]){var r=n[t];r&&(e[t]=String(r))}})),n=Object.getPrototypeOf(n);return e}(t))}(t))}(t)}catch(t){}}var xn=function(){function t(t){var e,n,r,o;this._root=t.root,this._root||(Mn(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new Nn),this._remoteParentSampled=null!==(e=t.remoteParentSampled)&&void 0!==e?e:new Nn,this._remoteParentNotSampled=null!==(n=t.remoteParentNotSampled)&&void 0!==n?n:new Ln,this._localParentSampled=null!==(r=t.localParentSampled)&&void 0!==r?r:new Nn,this._localParentNotSampled=null!==(o=t.localParentNotSampled)&&void 0!==o?o:new Ln}return t.prototype.shouldSample=function(t,e,n,r,o,i){var a=qt.getSpanContext(t);return a&&Xt(a)?a.isRemote?a.traceFlags&C.SAMPLED?this._remoteParentSampled.shouldSample(t,e,n,r,o,i):this._remoteParentNotSampled.shouldSample(t,e,n,r,o,i):a.traceFlags&C.SAMPLED?this._localParentSampled.shouldSample(t,e,n,r,o,i):this._localParentNotSampled.shouldSample(t,e,n,r,o,i):this._root.shouldSample(t,e,n,r,o,i)},t.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},t}(),Pn=function(){function t(t){void 0===t&&(t=0),this._ratio=t,this._ratio=this._normalize(t),this._upperBound=Math.floor(4294967295*this._ratio)}return t.prototype.shouldSample=function(t,e){return{decision:Gt(e)&&this._accumulate(e)<this._upperBound?Rn.RECORD_AND_SAMPLED:Rn.NOT_RECORD}},t.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},t.prototype._normalize=function(t){return"number"!=typeof t||isNaN(t)?0:t>=1?1:t<=0?0:t},t.prototype._accumulate=function(t){for(var e=0,n=0;n<t.length/8;n++){var r=8*n;e=(e^parseInt(t.slice(r,r+8),16))>>>0}return e},t}(),kn=Ke(),Dn=he.AlwaysOn;function Un(){return{sampler:Bn(kn),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:Ke().OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:Ke().OTEL_ATTRIBUTE_COUNT_LIMIT},spanLimits:{attributeValueLengthLimit:Ke().OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:Ke().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:Ke().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:Ke().OTEL_SPAN_EVENT_COUNT_LIMIT,attributePerEventCountLimit:Ke().OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT,attributePerLinkCountLimit:Ke().OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT}}}function Bn(t){switch(void 0===t&&(t=Ke()),t.OTEL_TRACES_SAMPLER){case he.AlwaysOn:return new Nn;case he.AlwaysOff:return new Ln;case he.ParentBasedAlwaysOn:return new xn({root:new Nn});case he.ParentBasedAlwaysOff:return new xn({root:new Ln});case he.TraceIdRatio:return new Pn(Fn(t));case he.ParentBasedTraceIdRatio:return new xn({root:new Pn(Fn(t))});default:return R.error('OTEL_TRACES_SAMPLER value "'+t.OTEL_TRACES_SAMPLER+" invalid, defaulting to "+Dn+'".'),new Nn}}function Fn(t){if(void 0===t.OTEL_TRACES_SAMPLER_ARG||""===t.OTEL_TRACES_SAMPLER_ARG)return R.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to 1."),1;var e=Number(t.OTEL_TRACES_SAMPLER_ARG);return isNaN(e)?(R.error("OTEL_TRACES_SAMPLER_ARG="+t.OTEL_TRACES_SAMPLER_ARG+" was given, but it is invalid, defaulting to 1."),1):e<0||e>1?(R.error("OTEL_TRACES_SAMPLER_ARG="+t.OTEL_TRACES_SAMPLER_ARG+" was given, but it is out of range ([0..1]), defaulting to 1."),1):e}var jn=function(){this.generateTraceId=Wn(16),this.generateSpanId=Wn(8)},Gn=Array(32);function Wn(t){return function(){for(var e=0;e<2*t;e++)Gn[e]=Math.floor(16*Math.random())+48,Gn[e]>=58&&(Gn[e]+=39);return String.fromCharCode.apply(null,Gn.slice(0,2*t))}}var Xn,Hn=function(){function t(t,e,n){this._tracerProvider=n;var r,o,i,a,s=(r=e,o={sampler:Bn()},i=Un(),(a=Object.assign({},i,o,r)).generalLimits=Object.assign({},i.generalLimits,r.generalLimits||{}),a.spanLimits=Object.assign({},i.spanLimits,r.spanLimits||{}),a);this._sampler=s.sampler,this._generalLimits=s.generalLimits,this._spanLimits=s.spanLimits,this._idGenerator=e.idGenerator||new jn,this.resource=n.resource,this.instrumentationLibrary=t}return t.prototype.startSpan=function(t,e,n){var r,o,i;void 0===e&&(e={}),void 0===n&&(n=k.active()),e.root&&(n=qt.deleteSpan(n));var a=qt.getSpan(n);if(qe(n))return R.debug("Instrumentation suppressed, returning Noop Span"),qt.wrapSpanContext(Lt);var s,u,c,l=null==a?void 0:a.spanContext(),d=this._idGenerator.generateSpanId();l&&qt.isSpanContextValid(l)?(s=l.traceId,u=l.traceState,c=l.spanId):s=this._idGenerator.generateTraceId();var p=null!==(r=e.kind)&&void 0!==r?r:dn.INTERNAL,f=(null!==(o=e.links)&&void 0!==o?o:[]).map((function(t){return{context:t.context,attributes:bn(t.attributes)}})),h=bn(e.attributes),m=this._sampler.shouldSample(n,s,t,p,h,f);u=null!==(i=m.traceState)&&void 0!==i?i:u;var g={traceId:s,spanId:d,traceFlags:m.decision===pn.RECORD_AND_SAMPLED?C.SAMPLED:C.NONE,traceState:u};if(m.decision===pn.NOT_RECORD)return R.debug("Recording is off, propagating context in a non-recording span"),qt.wrapSpanContext(g);var v=bn(Object.assign(h,m.attributes));return new An(this,n,t,g,p,c,f,e.startTime,void 0,v)},t.prototype.startActiveSpan=function(t,e,n,r){var o,i,a;if(!(arguments.length<2)){2===arguments.length?a=e:3===arguments.length?(o=e,a=n):(o=e,i=n,a=r);var s=null!=i?i:k.active(),u=this.startSpan(t,o,s),c=qt.setSpan(s,u);return k.with(c,a,void 0,u)}},t.prototype.getGeneralLimits=function(){return this._generalLimits},t.prototype.getSpanLimits=function(){return this._spanLimits},t.prototype.getActiveSpanProcessor=function(){return this._tracerProvider.getActiveSpanProcessor()},t}(),Vn=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Yn=function(){function t(t){this._spanProcessors=t}return t.prototype.forceFlush=function(){var t,e,n=[];try{for(var r=Vn(this._spanProcessors),o=r.next();!o.done;o=r.next()){var i=o.value;n.push(i.forceFlush())}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return new Promise((function(t){Promise.all(n).then((function(){t()})).catch((function(e){Mn(e||new Error("MultiSpanProcessor: forceFlush failed")),t()}))}))},t.prototype.onStart=function(t,e){var n,r;try{for(var o=Vn(this._spanProcessors),i=o.next();!i.done;i=o.next())i.value.onStart(t,e)}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.onEnd=function(t){var e,n;try{for(var r=Vn(this._spanProcessors),o=r.next();!o.done;o=r.next())o.value.onEnd(t)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.shutdown=function(){var t,e,n=[];try{for(var r=Vn(this._spanProcessors),o=r.next();!o.done;o=r.next()){var i=o.value;n.push(i.shutdown())}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return new Promise((function(t,e){Promise.all(n).then((function(){t()}),e)}))},t}(),zn=function(){function t(){}return t.prototype.onStart=function(t,e){},t.prototype.onEnd=function(t){},t.prototype.shutdown=function(){return Promise.resolve()},t.prototype.forceFlush=function(){return Promise.resolve()},t}(),Zn=function(){function t(){var t=this;this._promise=new Promise((function(e,n){t._resolve=e,t._reject=n}))}return Object.defineProperty(t.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),t.prototype.resolve=function(t){this._resolve(t)},t.prototype.reject=function(t){this._reject(t)},t}(),Kn=function(){function t(t,e){this._callback=t,this._that=e,this._isCalled=!1,this._deferred=new Zn}return Object.defineProperty(t.prototype,"isCalled",{get:function(){return this._isCalled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this._deferred.promise},enumerable:!1,configurable:!0}),t.prototype.call=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(!this._isCalled){this._isCalled=!0;try{Promise.resolve((t=this._callback).call.apply(t,function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([this._that],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(n),!1))).then((function(t){return e._deferred.resolve(t)}),(function(t){return e._deferred.reject(t)}))}catch(t){this._deferred.reject(t)}}return this._deferred.promise},t}();!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"}(Xn||(Xn={}));var Jn,Qn=function(){function t(t,e){this._exporter=t,this._isExporting=!1,this._finishedSpans=[],this._droppedSpansCount=0;var n=Ke();this._maxExportBatchSize="number"==typeof(null==e?void 0:e.maxExportBatchSize)?e.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize="number"==typeof(null==e?void 0:e.maxQueueSize)?e.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis="number"==typeof(null==e?void 0:e.scheduledDelayMillis)?e.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis="number"==typeof(null==e?void 0:e.exportTimeoutMillis)?e.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new Kn(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(R.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}return t.prototype.forceFlush=function(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()},t.prototype.onStart=function(t,e){},t.prototype.onEnd=function(t){this._shutdownOnce.isCalled||t.spanContext().traceFlags&C.SAMPLED&&this._addToBuffer(t)},t.prototype.shutdown=function(){return this._shutdownOnce.call()},t.prototype._shutdown=function(){var t=this;return Promise.resolve().then((function(){return t.onShutdown()})).then((function(){return t._flushAll()})).then((function(){return t._exporter.shutdown()}))},t.prototype._addToBuffer=function(t){if(this._finishedSpans.length>=this._maxQueueSize)return 0===this._droppedSpansCount&&R.debug("maxQueueSize reached, dropping spans"),void this._droppedSpansCount++;this._droppedSpansCount>0&&(R.warn("Dropped "+this._droppedSpansCount+" spans because maxQueueSize reached"),this._droppedSpansCount=0),this._finishedSpans.push(t),this._maybeStartTimer()},t.prototype._flushAll=function(){var t=this;return new Promise((function(e,n){for(var r=[],o=0,i=Math.ceil(t._finishedSpans.length/t._maxExportBatchSize);o<i;o++)r.push(t._flushOneBatch());Promise.all(r).then((function(){e()})).catch(n)}))},t.prototype._flushOneBatch=function(){var t=this;return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise((function(e,n){var r=setTimeout((function(){n(new Error("Timeout"))}),t._exportTimeoutMillis);k.with(k.active().setValue(Qe,!0),(function(){var o;t._finishedSpans.length<=t._maxExportBatchSize?(o=t._finishedSpans,t._finishedSpans=[]):o=t._finishedSpans.splice(0,t._maxExportBatchSize);for(var i=function(){return t._exporter.export(o,(function(t){var o;clearTimeout(r),t.code===Xn.SUCCESS?e():n(null!==(o=t.error)&&void 0!==o?o:new Error("BatchSpanProcessor: span export failed"))}))},a=null,s=0,u=o.length;s<u;s++){var c=o[s];c.resource.asyncAttributesPending&&c.resource.waitForAsyncAttributes&&(null!=a||(a=[]),a.push(c.resource.waitForAsyncAttributes()))}null===a?i():Promise.all(a).then(i,(function(t){Mn(t),n(t)}))}))}))},t.prototype._maybeStartTimer=function(){var t=this;if(!this._isExporting){var e=function(){t._isExporting=!0,t._flushOneBatch().finally((function(){t._isExporting=!1,t._finishedSpans.length>0&&(t._clearTimer(),t._maybeStartTimer())})).catch((function(e){t._isExporting=!1,Mn(e)}))};if(this._finishedSpans.length>=this._maxExportBatchSize)return e();void 0===this._timer&&(this._timer=setTimeout((function(){return e()}),this._scheduledDelayMillis),this._timer)}},t.prototype._clearTimer=function(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)},t}(),qn=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$n=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.onInit(n),r}return qn(e,t),e.prototype.onInit=function(t){var e=this;!0!==(null==t?void 0:t.disableAutoFlushOnDocumentHide)&&"undefined"!=typeof document&&(this._visibilityChangeListener=function(){"hidden"===document.visibilityState&&e.forceFlush()},this._pageHideListener=function(){e.forceFlush()},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))},e.prototype.onShutdown=function(){"undefined"!=typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))},e}(Qn);!function(t){t[t.resolved=0]="resolved",t[t.timeout=1]="timeout",t[t.error=2]="error",t[t.unresolved=3]="unresolved"}(Jn||(Jn={}));var tr=function(){function t(t){var e;void 0===t&&(t={}),this._registeredSpanProcessors=[],this._tracers=new Map;var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.shift(),r=new WeakMap;t.length>0;)n=Re(n,t.shift(),0,r);return n}({},Un(),function(t){var e,n,r,o,i,a,s,u,c,l,d,p,f=Object.assign({},t.spanLimits),h=ze(Ze);return f.attributeCountLimit=null!==(a=null!==(i=null!==(o=null!==(n=null===(e=t.spanLimits)||void 0===e?void 0:e.attributeCountLimit)&&void 0!==n?n:null===(r=t.generalLimits)||void 0===r?void 0:r.attributeCountLimit)&&void 0!==o?o:h.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT)&&void 0!==i?i:h.OTEL_ATTRIBUTE_COUNT_LIMIT)&&void 0!==a?a:je,f.attributeValueLengthLimit=null!==(p=null!==(d=null!==(l=null!==(u=null===(s=t.spanLimits)||void 0===s?void 0:s.attributeValueLengthLimit)&&void 0!==u?u:null===(c=t.generalLimits)||void 0===c?void 0:c.attributeValueLengthLimit)&&void 0!==l?l:h.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT)&&void 0!==d?d:h.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)&&void 0!==p?p:Fe,Object.assign({},t,{spanLimits:f})}(t));this.resource=null!==(e=n.resource)&&void 0!==e?e:En.empty(),this.resource=En.default().merge(this.resource),this._config=Object.assign({},n,{resource:this.resource});var r=this._buildExporterFromEnv();if(void 0!==r){var o=new $n(r);this.activeSpanProcessor=o}else this.activeSpanProcessor=new zn}return t.prototype.getTracer=function(t,e,n){var r=t+"@"+(e||"")+":"+((null==n?void 0:n.schemaUrl)||"");return this._tracers.has(r)||this._tracers.set(r,new Hn({name:t,version:e,schemaUrl:null==n?void 0:n.schemaUrl},this._config,this)),this._tracers.get(r)},t.prototype.addSpanProcessor=function(t){0===this._registeredSpanProcessors.length&&this.activeSpanProcessor.shutdown().catch((function(t){return R.error("Error while trying to shutdown current span processor",t)})),this._registeredSpanProcessors.push(t),this.activeSpanProcessor=new Yn(this._registeredSpanProcessors)},t.prototype.getActiveSpanProcessor=function(){return this.activeSpanProcessor},t.prototype.register=function(t){void 0===t&&(t={}),qt.setGlobalTracerProvider(this),void 0===t.propagator&&(t.propagator=this._buildPropagatorFromEnv()),t.contextManager&&k.setGlobalContextManager(t.contextManager),t.propagator&&ve.setGlobalPropagator(t.propagator)},t.prototype.forceFlush=function(){var t=this._config.forceFlushTimeoutMillis,e=this._registeredSpanProcessors.map((function(e){return new Promise((function(n){var r,o=setTimeout((function(){n(new Error("Span processor did not completed within timeout period of "+t+" ms")),r=Jn.timeout}),t);e.forceFlush().then((function(){clearTimeout(o),r!==Jn.timeout&&(r=Jn.resolved,n(r))})).catch((function(t){clearTimeout(o),r=Jn.error,n(t)}))}))}));return new Promise((function(t,n){Promise.all(e).then((function(e){var r=e.filter((function(t){return t!==Jn.resolved}));r.length>0?n(r):t()})).catch((function(t){return n([t])}))}))},t.prototype.shutdown=function(){return this.activeSpanProcessor.shutdown()},t.prototype._getPropagator=function(t){var e;return null===(e=this.constructor._registeredPropagators.get(t))||void 0===e?void 0:e()},t.prototype._getSpanExporter=function(t){var e;return null===(e=this.constructor._registeredExporters.get(t))||void 0===e?void 0:e()},t.prototype._buildPropagatorFromEnv=function(){var t=this,e=Array.from(new Set(Ke().OTEL_PROPAGATORS)),n=e.map((function(e){var n=t._getPropagator(e);return n||R.warn('Propagator "'+e+'" requested through environment variable is unavailable.'),n})).reduce((function(t,e){return e&&t.push(e),t}),[]);return 0===n.length?void 0:1===e.length?n[0]:new Je({propagators:n})},t.prototype._buildExporterFromEnv=function(){var t=Ke().OTEL_TRACES_EXPORTER;if("none"!==t&&""!==t){var e=this._getSpanExporter(t);return e||R.error('Exporter "'+t+'" requested through environment variable is unavailable.'),e}},t._registeredPropagators=new Map([["tracecontext",function(){return new un}],["baggage",function(){return new fn}]]),t._registeredExporters=new Map,t}(),er=function(){function t(){this._enabled=!1,this._currentContext=L}return t.prototype._bindFunction=function(t,e){void 0===t&&(t=L);var n=this,r=function(){for(var r=this,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return n.with(t,(function(){return e.apply(r,o)}))};return Object.defineProperty(r,"length",{enumerable:!1,configurable:!0,writable:!1,value:e.length}),r},t.prototype.active=function(){return this._currentContext},t.prototype.bind=function(t,e){return void 0===t&&(t=this.active()),"function"==typeof e?this._bindFunction(t,e):e},t.prototype.disable=function(){return this._currentContext=L,this._enabled=!1,this},t.prototype.enable=function(){return this._enabled||(this._enabled=!0,this._currentContext=L),this},t.prototype.with=function(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var i=this._currentContext;this._currentContext=t||L;try{return e.call.apply(e,function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([n],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(r),!1))}finally{this._currentContext=i}},t}(),nr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rr=function(t){function e(e){void 0===e&&(e={});var n=t.call(this,e)||this;if(e.contextManager)throw"contextManager should be defined in register method not in constructor";if(e.propagator)throw"propagator should be defined in register method not in constructor";return n}return nr(e,t),e.prototype.register=function(e){void 0===e&&(e={}),void 0===e.contextManager&&(e.contextManager=new er),e.contextManager&&e.contextManager.enable(),t.prototype.register.call(this,e)},e}(tr),or=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ir=function(){function t(){}return t.prototype.createGauge=function(t,e){return vr},t.prototype.createHistogram=function(t,e){return yr},t.prototype.createCounter=function(t,e){return gr},t.prototype.createUpDownCounter=function(t,e){return Er},t.prototype.createObservableGauge=function(t,e){return Tr},t.prototype.createObservableCounter=function(t,e){return _r},t.prototype.createObservableUpDownCounter=function(t,e){return Sr},t.prototype.addBatchObservableCallback=function(t,e){},t.prototype.removeBatchObservableCallback=function(t){},t}(),ar=function(){},sr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return or(e,t),e.prototype.add=function(t,e){},e}(ar),ur=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return or(e,t),e.prototype.add=function(t,e){},e}(ar),cr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return or(e,t),e.prototype.record=function(t,e){},e}(ar),lr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return or(e,t),e.prototype.record=function(t,e){},e}(ar),dr=function(){function t(){}return t.prototype.addCallback=function(t){},t.prototype.removeCallback=function(t){},t}(),pr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return or(e,t),e}(dr),fr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return or(e,t),e}(dr),hr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return or(e,t),e}(dr),mr=new ir,gr=new sr,vr=new cr,yr=new lr,Er=new ur,_r=new pr,Tr=new fr,Sr=new hr,br=new(function(){function t(){}return t.prototype.getMeter=function(t,e,n){return mr},t}()),Ir="metrics",Cr=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalMeterProvider=function(t){return E(Ir,t,O.instance())},t.prototype.getMeterProvider=function(){return _(Ir)||br},t.prototype.getMeter=function(t,e,n){return this.getMeterProvider().getMeter(t,e,n)},t.prototype.disable=function(){T(Ir,O.instance())},t}().getInstance(),Or="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof n.g?n.g:{},Rr=Symbol.for("io.opentelemetry.js.api.logs"),wr=Or,Ar=function(){function t(){}return t.prototype.emit=function(t){},t}(),Lr=(new Ar,new(function(){function t(){}return t.prototype.getLogger=function(t,e,n){return new Ar},t}())),Nr=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalLoggerProvider=function(t){return wr[Rr]?this.getLoggerProvider():(wr[Rr]=(e=t,n=Lr,function(t){return 1===t?e:n}),t);var e,n},t.prototype.getLoggerProvider=function(){var t,e;return null!==(e=null===(t=wr[Rr])||void 0===t?void 0:t.call(wr,1))&&void 0!==e?e:Lr},t.prototype.getLogger=function(t,e,n){return this.getLoggerProvider().getLogger(t,e,n)},t.prototype.disable=function(){delete wr[Rr]},t}(),Mr=Nr.getInstance(),xr=n(132),Pr=function(){return Pr=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Pr.apply(this,arguments)},kr=function(){function t(t,e,n){this.instrumentationName=t,this.instrumentationVersion=e,this._wrap=xr.wrap,this._unwrap=xr.unwrap,this._massWrap=xr.massWrap,this._massUnwrap=xr.massUnwrap,this._config=Pr({enabled:!0},n),this._diag=R.createComponentLogger({namespace:t}),this._tracer=qt.getTracer(t,e),this._meter=Cr.getMeter(t,e),this._logger=Mr.getLogger(t,e),this._updateMetricInstruments()}return Object.defineProperty(t.prototype,"meter",{get:function(){return this._meter},enumerable:!1,configurable:!0}),t.prototype.setMeterProvider=function(t){this._meter=t.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()},Object.defineProperty(t.prototype,"logger",{get:function(){return this._logger},enumerable:!1,configurable:!0}),t.prototype.setLoggerProvider=function(t){this._logger=t.getLogger(this.instrumentationName,this.instrumentationVersion)},t.prototype.getModuleDefinitions=function(){var t,e=null!==(t=this.init())&&void 0!==t?t:[];return Array.isArray(e)?e:[e]},t.prototype._updateMetricInstruments=function(){},t.prototype.getConfig=function(){return this._config},t.prototype.setConfig=function(t){this._config=Pr({},t)},t.prototype.setTracerProvider=function(t){this._tracer=t.getTracer(this.instrumentationName,this.instrumentationVersion)},Object.defineProperty(t.prototype,"tracer",{get:function(){return this._tracer},enumerable:!1,configurable:!0}),t.prototype._runSpanCustomizationHook=function(t,e,n,r){if(t)try{t(n,r)}catch(t){this._diag.error("Error running span customization hook due to exception in handler",{triggerName:e},t)}},t}(),Dr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ur=function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o._config.enabled&&o.enable(),o}return Dr(e,t),e}(kr),Br=n(263),Fr="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof n.g?n.g:{},jr=Symbol.for("io.opentelemetry.js.api.logs"),Gr=Fr,Wr=function(){function t(){}return t.prototype.emit=function(t){},t}(),Xr=new(new Wr,function(){function t(){}return t.prototype.getLogger=function(t,e,n){return new Wr},t}()),Hr=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalLoggerProvider=function(t){return Gr[jr]?this.getLoggerProvider():(Gr[jr]=(e=t,n=Xr,function(t){return 1===t?e:n}),t);var e,n},t.prototype.getLoggerProvider=function(){var t,e;return null!==(e=null===(t=Gr[jr])||void 0===t?void 0:t.call(Gr,1))&&void 0!==e?e:Xr},t.prototype.getLogger=function(t,e,n){return this.getLoggerProvider().getLogger(t,e,n)},t.prototype.disable=function(){delete Gr[jr]},t}(),Vr=Hr.getInstance(),Yr=function(){return Yr=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Yr.apply(this,arguments)},zr=function(){function t(t,e,n){this.instrumentationName=t,this.instrumentationVersion=e,this._wrap=xr.wrap,this._unwrap=xr.unwrap,this._massWrap=xr.massWrap,this._massUnwrap=xr.massUnwrap,this._config=Yr({enabled:!0},n),this._diag=R.createComponentLogger({namespace:t}),this._tracer=qt.getTracer(t,e),this._meter=Cr.getMeter(t,e),this._logger=Vr.getLogger(t,e),this._updateMetricInstruments()}return Object.defineProperty(t.prototype,"meter",{get:function(){return this._meter},enumerable:!1,configurable:!0}),t.prototype.setMeterProvider=function(t){this._meter=t.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()},Object.defineProperty(t.prototype,"logger",{get:function(){return this._logger},enumerable:!1,configurable:!0}),t.prototype.setLoggerProvider=function(t){this._logger=t.getLogger(this.instrumentationName,this.instrumentationVersion)},t.prototype.getModuleDefinitions=function(){var t,e=null!==(t=this.init())&&void 0!==t?t:[];return Array.isArray(e)?e:[e]},t.prototype._updateMetricInstruments=function(){},t.prototype.getConfig=function(){return this._config},t.prototype.setConfig=function(t){this._config=Yr({},t)},t.prototype.setTracerProvider=function(t){this._tracer=t.getTracer(this.instrumentationName,this.instrumentationVersion)},Object.defineProperty(t.prototype,"tracer",{get:function(){return this._tracer},enumerable:!1,configurable:!0}),t.prototype._runSpanCustomizationHook=function(t,e,n,r){if(t)try{t(n,r)}catch(t){this._diag.error("Error running span customization hook due to exception in handler",{triggerName:e},t)}},t}(),Zr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kr=function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o._config.enabled&&o.enable(),o}return Zr(e,t),e}(zr);function Jr(t,e){return"string"==typeof e?t===e:!!t.match(e)}var Qr,qr=performance,$r=Math.pow(10,6),to=Math.pow(10,9);function eo(t){var e=t/1e3;return[Math.trunc(e),Math.round(t%1e3*$r)]}function no(t){return e=eo(function(){var t=qr.timeOrigin;if("number"!=typeof t){var e=qr;t=e.timing&&e.timing.fetchStart}return t}()),n=eo("number"==typeof t?t:qr.now()),(r=[e[0]+n[0],e[1]+n[1]])[1]>=to&&(r[1]-=to,r[0]+=1),r;var e,n,r}!function(t){t.COMPONENT="component",t.HTTP_ERROR_NAME="http.error_name",t.HTTP_STATUS_TEXT="http.status_text"}(Qr||(Qr={}));var ro,oo="0.52.1",io="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof n.g?n.g:{},ao=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),so="object"==typeof process&&"node"===(null===(ro=process.release)||void 0===ro?void 0:ro.name),uo=function(t){function e(e){void 0===e&&(e={});var n=t.call(this,"@opentelemetry/instrumentation-fetch",oo,e)||this;return n.component="fetch",n.version=oo,n.moduleName=n.component,n._usedResources=new WeakSet,n._tasksCount=0,n}return ao(e,t),e.prototype.init=function(){},e.prototype._addChildSpan=function(t,e){var n=this.tracer.startSpan("CORS Preflight",{startTime:e[nt.FETCH_START]},qt.setSpan(k.active(),t));this.getConfig().ignoreNetworkEvents||St(n,e),n.end(e[nt.RESPONSE_END])},e.prototype._addFinalSpanAttributes=function(t,e){var n=Ct(e.url);t.setAttribute("http.status_code",e.status),null!=e.statusText&&t.setAttribute(Qr.HTTP_STATUS_TEXT,e.statusText),t.setAttribute("http.host",n.host),t.setAttribute("http.scheme",n.protocol.replace(":","")),"undefined"!=typeof navigator&&t.setAttribute("http.user_agent",navigator.userAgent)},e.prototype._addHeaders=function(t,e){if(!Rt(e,this.getConfig().propagateTraceHeaderCorsUrls)){var n={};return ve.inject(k.active(),n),void(Object.keys(n).length>0&&this._diag.debug("headers inject skipped due to CORS policy"))}t instanceof Request||t.headers instanceof Headers||t.headers instanceof Map?ve.inject(k.active(),t.headers,{set:function(t,e,n){return t.set(e,"string"==typeof n?n:String(n))}}):(n={},ve.inject(k.active(),n),t.headers=Object.assign({},n,t.headers||{}))},e.prototype._clearResources=function(){0===this._tasksCount&&this.getConfig().clearTimingResources&&(performance.clearResourceTimings(),this._usedResources=new WeakSet)},e.prototype._createSpan=function(t,e){var n;if(void 0===e&&(e={}),!function(t,e){var n,r;if(!e)return!1;try{for(var o=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),i=o.next();!i.done;i=o.next())if(Jr(t,i.value))return!0}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1}(t,this.getConfig().ignoreUrls)){var r=(e.method||"GET").toUpperCase(),o="HTTP "+r;return this.tracer.startSpan(o,{kind:dn.CLIENT,attributes:(n={},n[Qr.COMPONENT]=this.moduleName,n["http.method"]=r,n["http.url"]=t,n)})}this._diag.debug("ignoring span as url matches ignored url")},e.prototype._findResourceAndAddNetworkEvents=function(t,e,n){var r=e.entries;if(!r.length){if(!performance.getEntriesByType)return;r=performance.getEntriesByType("resource")}var o=It(e.spanUrl,e.startTime,n,r,this._usedResources,"fetch");if(o.mainRequest){var i=o.mainRequest;this._markResourceAsUsed(i);var a=o.corsPreFlightRequest;a&&(this._addChildSpan(t,a),this._markResourceAsUsed(a)),this.getConfig().ignoreNetworkEvents||St(t,i)}},e.prototype._markResourceAsUsed=function(t){this._usedResources.add(t)},e.prototype._endSpan=function(t,e,n){var r=this,o=eo(Date.now()),i=no();this._addFinalSpanAttributes(t,n),setTimeout((function(){var n;null===(n=e.observer)||void 0===n||n.disconnect(),r._findResourceAndAddNetworkEvents(t,e,i),r._tasksCount--,r._clearResources(),t.end(o)}),300)},e.prototype._patchConstructor=function(){var t=this;return function(e){var n=t;return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=this,i=Ct(t[0]instanceof Request?t[0].url:String(t[0])).href,a=t[0]instanceof Request?t[0]:t[1]||{},s=n._createSpan(i,a);if(!s)return e.apply(this,t);var u=n._prepareSpanData(i);function c(t,e){n._applyAttributesAfterFetch(t,a,e),n._endSpan(t,u,{status:e.status||0,statusText:e.message,url:i})}function l(t,e){n._applyAttributesAfterFetch(t,a,e),e.status>=200&&e.status<400?n._endSpan(t,u,e):n._endSpan(t,u,{status:e.status,statusText:e.statusText,url:i})}function d(t,e,n){try{var r=n.clone(),o=n.clone(),i=r.body;if(i){var a=i.getReader(),s=function(){a.read().then((function(e){e.done?l(t,o):s()}),(function(e){c(t,e)}))};s()}else l(t,n)}finally{e(n)}}function p(t,e,n){try{c(t,n)}finally{e(n)}}return new Promise((function(t,r){return k.with(qt.setSpan(k.active(),s),(function(){return n._addHeaders(a,i),n._tasksCount++,e.apply(o,a instanceof Request?[a]:[i,a]).then(d.bind(o,s,t),p.bind(o,s,r))}))}))}}},e.prototype._applyAttributesAfterFetch=function(t,e,n){var r=this,o=this.getConfig().applyCustomAttributesOnSpan;o&&function(t){var e,n;try{n=t()}catch(t){e=t}finally{return function(t){t&&r._diag.error("applyCustomAttributesOnSpan",t)}(e),n}}((function(){return o(t,e,n)}))},e.prototype._prepareSpanData=function(t){var e=no(),n=[];if("function"!=typeof PerformanceObserver)return{entries:n,startTime:e,spanUrl:t};var r=new PerformanceObserver((function(e){e.getEntries().forEach((function(e){"fetch"===e.initiatorType&&e.name===t&&n.push(e)}))}));return r.observe({entryTypes:["resource"]}),{entries:n,observer:r,startTime:e,spanUrl:t}},e.prototype.enable=function(){so?this._diag.warn("this instrumentation is intended for web usage only, it does not instrument Node.js's fetch()"):(function(t){return"function"==typeof t&&"function"==typeof t.__original&&"function"==typeof t.__unwrap&&!0===t.__wrapped}(fetch)&&(this._unwrap(io,"fetch"),this._diag.debug("removing previous patch for constructor")),this._wrap(io,"fetch",this._patchConstructor()))},e.prototype.disable=function(){so||(this._unwrap(io,"fetch"),this._usedResources=new WeakSet)},e}(Kr);function co(t){return"function"==typeof t&&"function"==typeof t.__original&&"function"==typeof t.__unwrap&&!0===t.__wrapped}var lo="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof n.g?n.g:{},po=Symbol.for("io.opentelemetry.js.api.logs"),fo=lo,ho=function(){function t(){}return t.prototype.emit=function(t){},t}(),mo=new(new ho,function(){function t(){}return t.prototype.getLogger=function(t,e,n){return new ho},t}()),go=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalLoggerProvider=function(t){return fo[po]?this.getLoggerProvider():(fo[po]=(e=t,n=mo,function(t){return 1===t?e:n}),t);var e,n},t.prototype.getLoggerProvider=function(){var t,e;return null!==(e=null===(t=fo[po])||void 0===t?void 0:t.call(fo,1))&&void 0!==e?e:mo},t.prototype.getLogger=function(t,e,n){return this.getLoggerProvider().getLogger(t,e,n)},t.prototype.disable=function(){delete fo[po]},t}(),vo=go.getInstance(),yo=function(){return yo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},yo.apply(this,arguments)},Eo=function(){function t(t,e,n){this.instrumentationName=t,this.instrumentationVersion=e,this._wrap=xr.wrap,this._unwrap=xr.unwrap,this._massWrap=xr.massWrap,this._massUnwrap=xr.massUnwrap,this._config=yo({enabled:!0},n),this._diag=R.createComponentLogger({namespace:t}),this._tracer=qt.getTracer(t,e),this._meter=Cr.getMeter(t,e),this._logger=vo.getLogger(t,e),this._updateMetricInstruments()}return Object.defineProperty(t.prototype,"meter",{get:function(){return this._meter},enumerable:!1,configurable:!0}),t.prototype.setMeterProvider=function(t){this._meter=t.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()},Object.defineProperty(t.prototype,"logger",{get:function(){return this._logger},enumerable:!1,configurable:!0}),t.prototype.setLoggerProvider=function(t){this._logger=t.getLogger(this.instrumentationName,this.instrumentationVersion)},t.prototype.getModuleDefinitions=function(){var t,e=null!==(t=this.init())&&void 0!==t?t:[];return Array.isArray(e)?e:[e]},t.prototype._updateMetricInstruments=function(){},t.prototype.getConfig=function(){return this._config},t.prototype.setConfig=function(t){this._config=yo({},t)},t.prototype.setTracerProvider=function(t){this._tracer=t.getTracer(this.instrumentationName,this.instrumentationVersion)},Object.defineProperty(t.prototype,"tracer",{get:function(){return this._tracer},enumerable:!1,configurable:!0}),t.prototype._runSpanCustomizationHook=function(t,e,n,r){if(t)try{t(n,r)}catch(t){this._diag.error("Error running span customization hook due to exception in handler",{triggerName:e},t)}},t}(),_o=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),To=function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o._config.enabled&&o.enable(),o}return _o(e,t),e}(Eo),So=performance;function bo(t,e){return"string"==typeof e?t===e:!!t.match(e)}var Io=Math.pow(10,6),Co=Math.pow(10,9);function Oo(t){var e=t/1e3;return[Math.trunc(e),Math.round(t%1e3*Io)]}function Ro(t){return e=Oo(function(){var t=So.timeOrigin;if("number"!=typeof t){var e=So;t=e.timing&&e.timing.fetchStart}return t}()),n=Oo("number"==typeof t?t:So.now()),(r=[e[0]+n[0],e[1]+n[1]])[1]>=Co&&(r[1]-=Co,r[0]+=1),r;var e,n,r}var wo;!function(t){t.METHOD_OPEN="open",t.METHOD_SEND="send",t.EVENT_ABORT="abort",t.EVENT_ERROR="error",t.EVENT_LOAD="loaded",t.EVENT_TIMEOUT="timeout"}(wo||(wo={}));var Ao,Lo="0.52.1";!function(t){t.HTTP_STATUS_TEXT="http.status_text"}(Ao||(Ao={}));var No,Mo,xo=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Po=function(t){function e(e){void 0===e&&(e={});var n=t.call(this,"@opentelemetry/instrumentation-xml-http-request",Lo,e)||this;return n.component="xml-http-request",n.version=Lo,n.moduleName=n.component,n._tasksCount=0,n._xhrMem=new WeakMap,n._usedResources=new WeakSet,n}return xo(e,t),e.prototype.init=function(){},e.prototype._addHeaders=function(t,e){if(!Rt(Ct(e).href,this.getConfig().propagateTraceHeaderCorsUrls)){var n={};return ve.inject(k.active(),n),void(Object.keys(n).length>0&&this._diag.debug("headers inject skipped due to CORS policy"))}var r={};ve.inject(k.active(),r),Object.keys(r).forEach((function(e){t.setRequestHeader(e,String(r[e]))}))},e.prototype._addChildSpan=function(t,e){var n=this;k.with(qt.setSpan(k.active(),t),(function(){var t=n.tracer.startSpan("CORS Preflight",{startTime:e[nt.FETCH_START]});n.getConfig().ignoreNetworkEvents||St(t,e),t.end(e[nt.RESPONSE_END])}))},e.prototype._addFinalSpanAttributes=function(t,e,n){if("string"==typeof n){var r=Ct(n);void 0!==e.status&&t.setAttribute("http.status_code",e.status),void 0!==e.statusText&&t.setAttribute(Ao.HTTP_STATUS_TEXT,e.statusText),t.setAttribute("http.host",r.host),t.setAttribute("http.scheme",r.protocol.replace(":","")),t.setAttribute("http.user_agent",navigator.userAgent)}},e.prototype._applyAttributesAfterXHR=function(t,e){var n=this,r=this.getConfig().applyCustomAttributesOnSpan;"function"==typeof r&&function(){var o,i;try{i=r(t,e)}catch(t){o=t}finally{return function(t){t&&n._diag.error("applyCustomAttributesOnSpan",t)}(o),i}}()},e.prototype._addResourceObserver=function(t,e){var n=this._xhrMem.get(t);n&&"function"==typeof PerformanceObserver&&"function"==typeof PerformanceResourceTiming&&(n.createdResources={observer:new PerformanceObserver((function(t){var r=t.getEntries(),o=Ct(e);r.forEach((function(t){"xmlhttprequest"===t.initiatorType&&t.name===o.href&&n.createdResources&&n.createdResources.entries.push(t)}))})),entries:[]},n.createdResources.observer.observe({entryTypes:["resource"]}))},e.prototype._clearResources=function(){0===this._tasksCount&&this.getConfig().clearTimingResources&&(So.clearResourceTimings(),this._xhrMem=new WeakMap,this._usedResources=new WeakSet)},e.prototype._findResourceAndAddNetworkEvents=function(t,e,n,r,o){if(n&&r&&o&&t.createdResources){var i=t.createdResources.entries;i&&i.length||(i=So.getEntriesByType("resource"));var a=It(Ct(n).href,r,o,i,this._usedResources);if(a.mainRequest){var s=a.mainRequest;this._markResourceAsUsed(s);var u=a.corsPreFlightRequest;u&&(this._addChildSpan(e,u),this._markResourceAsUsed(u)),this.getConfig().ignoreNetworkEvents||St(e,s)}}},e.prototype._cleanPreviousSpanInformation=function(t){var e=this._xhrMem.get(t);if(e){var n=e.callbackToRemoveEvents;n&&n(),this._xhrMem.delete(t)}},e.prototype._createSpan=function(t,e,n){var r;if(!function(t,e){var n,r;if(!e)return!1;try{for(var o=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),i=o.next();!i.done;i=o.next())if(bo(t,i.value))return!0}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1}(e,this.getConfig().ignoreUrls)){var o=n.toUpperCase(),i=this.tracer.startSpan(o,{kind:dn.CLIENT,attributes:(r={},r["http.method"]=n,r["http.url"]=Ct(e).toString(),r)});return i.addEvent(wo.METHOD_OPEN),this._cleanPreviousSpanInformation(t),this._xhrMem.set(t,{span:i,spanUrl:e}),i}this._diag.debug("ignoring span as url matches ignored url")},e.prototype._markResourceAsUsed=function(t){this._usedResources.add(t)},e.prototype._patchOpen=function(){var t=this;return function(e){var n=t;return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=t[0],i=t[1];return n._createSpan(this,i,o),e.apply(this,t)}}},e.prototype._patchSend=function(){var t=this;function e(e,n){var r=t._xhrMem.get(n);if(r){r.status=n.status,r.statusText=n.statusText,t._xhrMem.delete(n),r.span&&t._applyAttributesAfterXHR(r.span,n);var o=Ro(),i=Date.now();setTimeout((function(){!function(e,n,r,o){var i=n.callbackToRemoveEvents;"function"==typeof i&&i();var a=n.span,s=n.spanUrl,u=n.sendStartTime;a&&(t._findResourceAndAddNetworkEvents(n,a,s,u,r),a.addEvent(e,o),t._addFinalSpanAttributes(a,n,s),a.end(o),t._tasksCount--),t._clearResources()}(e,r,o,i)}),300)}}function n(){e(wo.EVENT_ERROR,this)}function r(){e(wo.EVENT_ABORT,this)}function o(){e(wo.EVENT_TIMEOUT,this)}function i(){this.status<299?e(wo.EVENT_LOAD,this):e(wo.EVENT_ERROR,this)}return function(e){return function(){for(var a=this,s=[],u=0;u<arguments.length;u++)s[u]=arguments[u];var c=t._xhrMem.get(this);if(!c)return e.apply(this,s);var l=c.span,d=c.spanUrl;return l&&d&&k.with(qt.setSpan(k.active(),l),(function(){t._tasksCount++,c.sendStartTime=Ro(),l.addEvent(wo.METHOD_SEND),a.addEventListener("abort",r),a.addEventListener("error",n),a.addEventListener("load",i),a.addEventListener("timeout",o),c.callbackToRemoveEvents=function(){!function(e){e.removeEventListener("abort",r),e.removeEventListener("error",n),e.removeEventListener("load",i),e.removeEventListener("timeout",o);var a=t._xhrMem.get(e);a&&(a.callbackToRemoveEvents=void 0)}(a),c.createdResources&&c.createdResources.observer.disconnect()},t._addHeaders(a,d),t._addResourceObserver(a,d)})),e.apply(this,s)}}},e.prototype.enable=function(){this._diag.debug("applying patch to",this.moduleName,this.version),co(XMLHttpRequest.prototype.open)&&(this._unwrap(XMLHttpRequest.prototype,"open"),this._diag.debug("removing previous patch from method open")),co(XMLHttpRequest.prototype.send)&&(this._unwrap(XMLHttpRequest.prototype,"send"),this._diag.debug("removing previous patch from method send")),this._wrap(XMLHttpRequest.prototype,"open",this._patchOpen()),this._wrap(XMLHttpRequest.prototype,"send",this._patchSend())},e.prototype.disable=function(){this._diag.debug("removing patch from",this.moduleName,this.version),this._unwrap(XMLHttpRequest.prototype,"open"),this._unwrap(XMLHttpRequest.prototype,"send"),this._tasksCount=0,this._xhrMem=new WeakMap,this._usedResources=new WeakSet},e}(To),ko=function(){var t=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},Do=function(t){if("loading"===document.readyState)return"loading";var e=ko();if(e){if(t<e.domInteractive)return"loading";if(0===e.domContentLoadedEventStart||t<e.domContentLoadedEventStart)return"dom-interactive";if(0===e.domComplete||t<e.domComplete)return"dom-content-loaded"}return"complete"},Uo=function(t){var e=t.nodeName;return 1===t.nodeType?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},Bo=function(t,e){var n="";try{for(;t&&9!==t.nodeType;){var r=t,o=r.id?"#"+r.id:Uo(r)+(r.classList&&r.classList.value&&r.classList.value.trim()&&r.classList.value.trim().length?"."+r.classList.value.trim().replace(/\s+/g,"."):"");if(n.length+o.length>(e||100)-1)return n||o;if(n=n?o+">"+n:o,r.id)break;t=r.parentNode}}catch(t){}return n},Fo=function(t,e,n,r){var o,i;return function(a){e.value>=0&&(a||r)&&((i=e.value-(o||0))||void 0===o)&&(o=e.value,e.delta=i,e.rating=function(t,e){return t>e[1]?"poor":t>e[0]?"needs-improvement":"good"}(e.value,n),t(e))}},jo=function(t){requestAnimationFrame((function(){return requestAnimationFrame((function(){return t()}))}))},Go=-1,Wo=function(){return Go},Xo=function(t){addEventListener("pageshow",(function(e){e.persisted&&(Go=e.timeStamp,t(e))}),!0)},Ho=function(){var t=ko();return t&&t.activationStart||0},Vo=function(t,e,n,r){var o,i=(null===(o=ko())||void 0===o?void 0:o.navigationId)||"1",a=ko(),s="navigate";return n?s=n:Wo()>=0?s="back-forward-cache":a&&(document.prerendering||Ho()>0?s="prerender":document.wasDiscarded?s="restore":a.type&&(s=a.type.replace(/_/g,"-"))),{name:t,value:void 0===e?-1:e,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:s,navigationId:r||i}},Yo=function(t){return PerformanceObserver.supportedEntryTypes.includes("soft-navigation")&&t&&t.reportSoftNavs},zo=function(t){if(t){var e=window.performance.getEntriesByType("soft-navigation").filter((function(e){return e.navigationId===t}));return e?e[0]:void 0}},Zo=function(t,e,n){var r=Yo(n);try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var o=new PerformanceObserver((function(t){Promise.resolve().then((function(){e(t.getEntries())}))}));return o.observe(Object.assign({type:t,buffered:!0,includeSoftNavigationObservations:r},n||{})),o}}catch(t){}},Ko=function(t){document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&t()}))},Jo=function(t){var e=!1;return function(){e||(t(),e=!0)}},Qo=-1,qo=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},$o=function(t){"hidden"===document.visibilityState&&Qo>-1&&(Qo="visibilitychange"===t.type?t.timeStamp:0,ei())},ti=function(){addEventListener("visibilitychange",$o,!0),addEventListener("prerenderingchange",$o,!0)},ei=function(){removeEventListener("visibilitychange",$o,!0),removeEventListener("prerenderingchange",$o,!0)},ni=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(Qo=-1),Qo<0&&(Qo=qo(),ti(),Xo((function(){setTimeout((function(){Qo=qo(),ti()}),0)}))),{get firstHiddenTime(){return Qo}}},ri=function(t){document.prerendering?addEventListener("prerenderingchange",(function(){return t()}),!0):t()},oi=[1800,3e3],ii=function(t,e){var n,r=Yo(e=e||{}),o=0,i=(null===(n=ko())||void 0===n?void 0:n.navigationId)||"1";ri((function(){var n,a=ni(),s=Vo("FCP"),u=Zo("paint",(function(c){c.forEach((function(c){if("first-contentful-paint"===c.name){r?c.navigationId&&c.navigationId!==s.navigationId&&function(r,i){s=Vo("FCP",0,"soft-navigation",i),n=Fo(t,s,oi,e.reportAllChanges),a=ni(!0);var u=i?zo(i):null;o=u&&u.startTime||0}(0,c.navigationId):u.disconnect();var l=0;if(c.navigationId&&c.navigationId!==i){var d=zo(c.navigationId),p=d&&d.startTime?d.startTime:0;l=Math.max(c.startTime-p,0)}else l=Math.max(c.startTime-Ho(),0);var f=r&&c.navigationId?zo(c.navigationId):null,h=f&&f.startTime?f.startTime:0;(c.startTime<a.firstHiddenTime||r&&c.navigationId&&c.navigationId!==s.navigationId&&c.navigationId!==i&&h>o)&&(s.value=l,s.entries.push(c),s.navigationId=c.navigationId||"1",n(!0))}}))}),e);u&&(n=Fo(t,s,oi,e.reportAllChanges),Xo((function(r){s=Vo("FCP",0,"back-forward-cache",s.navigationId),n=Fo(t,s,oi,e.reportAllChanges),jo((function(){s.value=performance.now()-r.timeStamp,n(!0)}))})))}))},ai=[.1,.25],si=0,ui=1/0,ci=0,li="",di=!1,pi=function(t){var e;li||(li=(null===(e=ko())||void 0===e?void 0:e.navigationId)||"1"),t.forEach((function(t){t.interactionId&&(di&&t.navigationId&&t.navigationId!==li&&(li=t.navigationId,si=0,ui=1/0,ci=0),ui=Math.min(ui,t.interactionId),ci=Math.max(ci,t.interactionId),si=ci?(ci-ui)/7+1:0)}))},fi=function(){return No?si:performance.interactionCount||0},hi=function(t){"interactionCount"in performance||No||(No=Zo("event",pi,{type:"event",buffered:!0,durationThreshold:0,includeSoftNavigationObservations:di=t||!1}))},mi=[],gi=new Map,vi=0,yi=function(){vi=fi(),mi.length=0,gi.clear()},Ei=[],_i=function(t){if(Ei.forEach((function(e){return e(t)})),t.interactionId||"first-input"===t.entryType){var e=mi[mi.length-1],n=gi.get(t.interactionId);if(n||mi.length<10||t.duration>e.latency){if(n)t.duration>n.latency?(n.entries=[t],n.latency=t.duration):t.duration===n.latency&&t.startTime===n.entries[0].startTime&&n.entries.push(t);else{var r={id:t.interactionId,latency:t.duration,entries:[t]};gi.set(r.id,r),mi.push(r)}mi.sort((function(t,e){return e.latency-t.latency})),mi.length>10&&mi.splice(10).forEach((function(t){return gi.delete(t.id)}))}}},Ti=function(t){var e=self.requestIdleCallback||self.setTimeout,n=-1;return t=Jo(t),"hidden"===document.visibilityState?t():(n=e(t),Ko(t)),n},Si=[200,500],bi=[],Ii=[],Ci=0,Oi=new WeakMap,Ri=new Map,wi=-1,Ai=function(t){bi=bi.concat(t),Li()},Li=function(){wi<0&&(wi=Ti(Ni))},Ni=function(){Ri.size>10&&Ri.forEach((function(t,e){gi.has(e)||Ri.delete(e)}));var t=mi.map((function(t){return Oi.get(t.entries[0])})),e=Ii.length-50;Ii=Ii.filter((function(n,r){return r>=e||t.includes(n)}));for(var n=new Set,r=0;r<Ii.length;r++){var o=Ii[r];Ui(o.startTime,o.processingEnd).forEach((function(t){n.add(t)}))}var i=bi.length-1-50;bi=bi.filter((function(t,e){return t.startTime>Ci&&e>i||n.has(t)})),wi=-1};Ei.push((function(t){t.interactionId&&t.target&&!Ri.has(t.interactionId)&&Ri.set(t.interactionId,t.target)}),(function(t){var e,n=t.startTime+t.duration;Ci=Math.max(Ci,t.processingEnd);for(var r=Ii.length-1;r>=0;r--){var o=Ii[r];if(Math.abs(n-o.renderTime)<=8){(e=o).startTime=Math.min(t.startTime,e.startTime),e.processingStart=Math.min(t.processingStart,e.processingStart),e.processingEnd=Math.max(t.processingEnd,e.processingEnd),e.entries.push(t);break}}e||(e={startTime:t.startTime,processingStart:t.processingStart,processingEnd:t.processingEnd,renderTime:n,entries:[t]},Ii.push(e)),(t.interactionId||"first-input"===t.entryType)&&Oi.set(t,e),Li()}));var Mi,xi,Pi,ki,Di,Ui=function(t,e){for(var n,r=[],o=0;n=bi[o];o++)if(!(n.startTime+n.duration<t)){if(n.startTime>e)break;r.push(n)}return r},Bi=[2500,4e3],Fi=[800,1800],ji=function t(e){document.prerendering?ri((function(){return t(e)})):"complete"!==document.readyState?addEventListener("load",(function(){return t(e)}),!0):setTimeout(e,0)},Gi=function(t,e){var n=Yo(e=e||{}),r=Vo("TTFB"),o=Fo(t,r,Fi,e.reportAllChanges);ji((function(){var i=ko();if(i){var a=i.responseStart;r.value=Math.max(a-Ho(),0),r.entries=[i],o(!0),Xo((function(){r=Vo("TTFB",0,"back-forward-cache",r.navigationId),(o=Fo(t,r,Fi,e.reportAllChanges))(!0)})),n&&Zo("soft-navigation",(function(n){n.forEach((function(n){n.navigationId&&((r=Vo("TTFB",0,"soft-navigation",n.navigationId)).entries=[n],(o=Fo(t,r,Fi,e.reportAllChanges))(!0))}))}),e)}}))},Wi={passive:!0,capture:!0},Xi=new Date,Hi=function(t,e){Mi||(Mi=e,xi=t,Pi=new Date,zi(removeEventListener),Vi())},Vi=function(){if(xi>=0&&xi<Pi-Xi){var t={entryType:"first-input",name:Mi.type,target:Mi.target,cancelable:Mi.cancelable,startTime:Mi.timeStamp,processingStart:Mi.timeStamp+xi};ki.forEach((function(e){e([t])})),ki=[]}},Yi=function(t){if(t.cancelable){var e=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;"pointerdown"==t.type?function(t,e){var n=function(){Hi(t,e),o()},r=function(){o()},o=function(){removeEventListener("pointerup",n,Wi),removeEventListener("pointercancel",r,Wi)};addEventListener("pointerup",n,Wi),addEventListener("pointercancel",r,Wi)}(e,t):Hi(e,t)}},zi=function(t){["mousedown","keydown","touchstart","pointerdown"].forEach((function(e){return t(e,Yi,Wi)}))},Zi=[100,300],Ki=Object.defineProperty,Ji=(t,e,n)=>(((t,e,n)=>{e in t?Ki(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n),Qi=Object.defineProperty,qi=(t,e,n)=>(((t,e,n)=>{e in t?Qi(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n),$i=(t=>(t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment",t))($i||{});function ta(t){const e=null==t?void 0:t.host;return Boolean((null==e?void 0:e.shadowRoot)===t)}function ea(t){return"[object ShadowRoot]"===Object.prototype.toString.call(t)}function na(t){try{const n=t.rules||t.cssRules;return n?((e=Array.from(n,ra).join("")).includes(" background-clip: text;")&&!e.includes(" -webkit-background-clip: text;")&&(e=e.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),e):null}catch(t){return null}var e}function ra(t){let e;if(function(t){return"styleSheet"in t}(t))try{e=na(t.styleSheet)||function(t){const{cssText:e}=t;if(e.split('"').length<3)return e;const n=["@import",`url(${JSON.stringify(t.href)})`];return""===t.layerName?n.push("layer"):t.layerName&&n.push(`layer(${t.layerName})`),t.supportsText&&n.push(`supports(${t.supportsText})`),t.media.length&&n.push(t.media.mediaText),n.join(" ")+";"}(t)}catch(t){}else if(function(t){return"selectorText"in t}(t)&&t.selectorText.includes(":"))return t.cssText.replace(/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm,"$1\\$2");return e||t.cssText}class oa{constructor(){qi(this,"idNodeMap",new Map),qi(this,"nodeMetaMap",new WeakMap)}getId(t){var e;return t?(null==(e=this.getMeta(t))?void 0:e.id)??-1:-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const e=this.getId(t);this.idNodeMap.delete(e),t.childNodes&&t.childNodes.forEach((t=>this.removeNodeFromMap(t)))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,e){const n=e.id;this.idNodeMap.set(n,t),this.nodeMetaMap.set(t,e)}replace(t,e){const n=this.getNode(t);if(n){const t=this.nodeMetaMap.get(n);t&&this.nodeMetaMap.set(e,t)}this.idNodeMap.set(t,e)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function ia({element:t,maskInputOptions:e,tagName:n,type:r,value:o,maskInputFn:i}){let a=o||"";const s=r&&aa(r);return(e[n.toLowerCase()]||s&&e[s])&&(a=i?i(a,t):"*".repeat(a.length)),a}function aa(t){return t.toLowerCase()}const sa="__rrweb_original__";function ua(t){const e=t.type;return t.hasAttribute("data-rr-is-password")?"password":e?aa(e):null}function ca(t,e){let n;try{n=new URL(t,e??window.location.href)}catch(t){return null}const r=n.pathname.match(/\.([0-9a-z]+)(?:$)/i);return(null==r?void 0:r[1])??null}let la=1;const da=new RegExp("[^a-z0-9-_:]");function pa(){return la++}let fa,ha;const ma=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,ga=/^(?:[a-z+]+:)?\/\//i,va=/^www\..*/i,ya=/^(data:)([^,]*),(.*)/i;function Ea(t,e){return(t||"").replace(ma,((t,n,r,o,i,a)=>{const s=r||i||a,u=n||o||"";if(!s)return t;if(ga.test(s)||va.test(s))return`url(${u}${s}${u})`;if(ya.test(s))return`url(${u}${s}${u})`;if("/"===s[0])return`url(${u}${function(t){let e="";return e=t.indexOf("//")>-1?t.split("/").slice(0,3).join("/"):t.split("/")[0],e=e.split("?")[0],e}(e)+s}${u})`;const c=e.split("/"),l=s.split("/");c.pop();for(const t of l)"."!==t&&(".."===t?c.pop():c.push(t));return`url(${u}${c.join("/")}${u})`}))}const _a=/^[^ \t\n\r\u000c]+/,Ta=/^[, \t\n\r\u000c]+/,Sa=new WeakMap;function ba(t,e){return e&&""!==e.trim()?Ia(t,e):e}function Ia(t,e){let n=Sa.get(t);if(n||(n=t.createElement("a"),Sa.set(t,n)),e){if(e.startsWith("blob:")||e.startsWith("data:"))return e}else e="";return n.setAttribute("href",e),n.href}function Ca(t,e,n,r){return r?"src"===n||"href"===n&&("use"!==e||"#"!==r[0])||"xlink:href"===n&&"#"!==r[0]?ba(t,r):"background"!==n||"table"!==e&&"td"!==e&&"th"!==e?"srcset"===n?function(t,e){if(""===e.trim())return e;let n=0;function r(t){let r;const o=t.exec(e.substring(n));return o?(r=o[0],n+=r.length,r):""}const o=[];for(;r(Ta),!(n>=e.length);){let i=r(_a);if(","===i.slice(-1))i=ba(t,i.substring(0,i.length-1)),o.push(i);else{let r="";i=ba(t,i);let a=!1;for(;;){const t=e.charAt(n);if(""===t){o.push((i+r).trim());break}if(a)")"===t&&(a=!1);else{if(","===t){n+=1,o.push((i+r).trim());break}"("===t&&(a=!0)}r+=t,n+=1}}}return o.join(", ")}(t,r):"style"===n?Ea(r,Ia(t)):"object"===e&&"data"===n?ba(t,r):r:ba(t,r):r}function Oa(t,e,n){return("video"===t||"audio"===t)&&"autoplay"===e}function Ra(t,e,n){if(!t)return!1;if(t.nodeType!==t.ELEMENT_NODE)return!!n&&Ra(t.parentNode,e,n);for(let n=t.classList.length;n--;){const r=t.classList[n];if(e.test(r))return!0}return!!n&&Ra(t.parentNode,e,n)}function wa(t,e,n,r){try{const o=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(null===o)return!1;if("string"==typeof e){if(r){if(o.closest(`.${e}`))return!0}else if(o.classList.contains(e))return!0}else if(Ra(o,e,r))return!0;if(n)if(r){if(o.closest(n))return!0}else if(o.matches(n))return!0}catch(t){}return!1}function Aa(t){return null==t?"":t.toLowerCase()}function La(t,e){const{doc:n,mirror:r,blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:s,skipChild:u=!1,inlineStylesheet:c=!0,maskInputOptions:l={},maskTextFn:d,maskInputFn:p,slimDOMOptions:f,dataURLOptions:h={},inlineImages:m=!1,recordCanvas:g=!1,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E=5e3,onStylesheetLoad:_,stylesheetLoadTimeout:T=5e3,keepIframeSrcFn:S=()=>!1,newlyAddedElement:b=!1}=e;let{needsMask:I}=e,{preserveWhiteSpace:C=!0}=e;!I&&t.childNodes&&(I=wa(t,a,s,void 0===I));const O=function(t,e){const{doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:a,inlineStylesheet:s,maskInputOptions:u={},maskTextFn:c,maskInputFn:l,dataURLOptions:d={},inlineImages:p,recordCanvas:f,keepIframeSrcFn:h,newlyAddedElement:m=!1}=e,g=function(t,e){if(!e.hasNode(t))return;const n=e.getId(t);return 1===n?void 0:n}(n,r);switch(t.nodeType){case t.DOCUMENT_NODE:return"CSS1Compat"!==t.compatMode?{type:$i.Document,childNodes:[],compatMode:t.compatMode}:{type:$i.Document,childNodes:[]};case t.DOCUMENT_TYPE_NODE:return{type:$i.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:g};case t.ELEMENT_NODE:return function(t,e){const{doc:n,blockClass:r,blockSelector:o,inlineStylesheet:i,maskInputOptions:a={},maskInputFn:s,dataURLOptions:u={},inlineImages:c,recordCanvas:l,keepIframeSrcFn:d,newlyAddedElement:p=!1,rootId:f}=e,h=function(t,e,n){try{if("string"==typeof e){if(t.classList.contains(e))return!0}else for(let n=t.classList.length;n--;){const r=t.classList[n];if(e.test(r))return!0}if(n)return t.matches(n)}catch(t){}return!1}(t,r,o),m=function(t){if(t instanceof HTMLFormElement)return"form";const e=aa(t.tagName);return da.test(e)?"div":e}(t);let g={};const v=t.attributes.length;for(let e=0;e<v;e++){const r=t.attributes[e];Oa(m,r.name,r.value)||(g[r.name]=Ca(n,m,aa(r.name),r.value))}if("link"===m&&i){const e=Array.from(n.styleSheets).find((e=>e.href===t.href));let r=null;e&&(r=na(e)),r&&(delete g.rel,delete g.href,g._cssText=Ea(r,e.href))}if("style"===m&&t.sheet&&!(t.innerText||t.textContent||"").trim().length){const e=na(t.sheet);e&&(g._cssText=Ea(e,Ia(n)))}if("input"===m||"textarea"===m||"select"===m){const e=t.value,n=t.checked;"radio"!==g.type&&"checkbox"!==g.type&&"submit"!==g.type&&"button"!==g.type&&e?g.value=ia({element:t,type:ua(t),tagName:m,value:e,maskInputOptions:a,maskInputFn:s}):n&&(g.checked=n)}if("option"===m&&(t.selected&&!a.select?g.selected=!0:delete g.selected),"canvas"===m&&l)if("2d"===t.__context)(function(t){const e=t.getContext("2d");if(!e)return!0;for(let n=0;n<t.width;n+=50)for(let r=0;r<t.height;r+=50){const o=e.getImageData,i=sa in o?o[sa]:o;if(new Uint32Array(i.call(e,n,r,Math.min(50,t.width-n),Math.min(50,t.height-r)).data.buffer).some((t=>0!==t)))return!1}return!0})(t)||(g.rr_dataURL=t.toDataURL(u.type,u.quality));else if(!("__context"in t)){const e=t.toDataURL(u.type,u.quality),r=n.createElement("canvas");r.width=t.width,r.height=t.height,e!==r.toDataURL(u.type,u.quality)&&(g.rr_dataURL=e)}if("img"===m&&c){fa||(fa=n.createElement("canvas"),ha=fa.getContext("2d"));const e=t,r=e.currentSrc||e.getAttribute("src")||"<unknown-src>",o=e.crossOrigin,i=()=>{e.removeEventListener("load",i);try{fa.width=e.naturalWidth,fa.height=e.naturalHeight,ha.drawImage(e,0,0),g.rr_dataURL=fa.toDataURL(u.type,u.quality)}catch(t){if("anonymous"!==e.crossOrigin)return e.crossOrigin="anonymous",void(e.complete&&0!==e.naturalWidth?i():e.addEventListener("load",i));console.warn(`Cannot inline img src=${r}! Error: ${t}`)}"anonymous"===e.crossOrigin&&(o?g.crossOrigin=o:e.removeAttribute("crossorigin"))};e.complete&&0!==e.naturalWidth?i():e.addEventListener("load",i)}if("audio"===m||"video"===m){const e=g;e.rr_mediaState=t.paused?"paused":"played",e.rr_mediaCurrentTime=t.currentTime,e.rr_mediaPlaybackRate=t.playbackRate,e.rr_mediaMuted=t.muted,e.rr_mediaLoop=t.loop,e.rr_mediaVolume=t.volume}if(p||(t.scrollLeft&&(g.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(g.rr_scrollTop=t.scrollTop)),h){const{width:e,height:n}=t.getBoundingClientRect();g={class:g.class,rr_width:`${e}px`,rr_height:`${n}px`}}let y;"iframe"!==m||d(g.src)||(t.contentDocument||(g.rr_src=g.src),delete g.src);try{customElements.get(m)&&(y=!0)}catch(t){}return{type:$i.Element,tagName:m,attributes:g,childNodes:[],isSVG:(E=t,Boolean("svg"===E.tagName||E.ownerSVGElement)||void 0),needBlock:h,rootId:f,isCustom:y};var E}(t,{doc:n,blockClass:o,blockSelector:i,inlineStylesheet:s,maskInputOptions:u,maskInputFn:l,dataURLOptions:d,inlineImages:p,recordCanvas:f,keepIframeSrcFn:h,newlyAddedElement:m,rootId:g});case t.TEXT_NODE:return function(t,e){var n;const{needsMask:r,maskTextFn:o,rootId:i}=e,a=t.parentNode&&t.parentNode.tagName;let s=t.textContent;const u="STYLE"===a||void 0,c="SCRIPT"===a||void 0;if(u&&s){try{t.nextSibling||t.previousSibling||(null==(n=t.parentNode.sheet)?void 0:n.cssRules)&&(s=na(t.parentNode.sheet))}catch(e){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${e}`,t)}s=Ea(s,Ia(e.doc))}return c&&(s="SCRIPT_PLACEHOLDER"),!u&&!c&&s&&r&&(s=o?o(s,t.parentElement):s.replace(/[\S]/g,"*")),{type:$i.Text,textContent:s||"",isStyle:u,rootId:i}}(t,{doc:n,needsMask:a,maskTextFn:c,rootId:g});case t.CDATA_SECTION_NODE:return{type:$i.CDATA,textContent:"",rootId:g};case t.COMMENT_NODE:return{type:$i.Comment,textContent:t.textContent||"",rootId:g};default:return!1}}(t,{doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:I,inlineStylesheet:c,maskInputOptions:l,maskTextFn:d,maskInputFn:p,dataURLOptions:h,inlineImages:m,recordCanvas:g,keepIframeSrcFn:S,newlyAddedElement:b});if(!O)return console.warn(t,"not serialized"),null;let R;R=r.hasNode(t)?r.getId(t):!function(t,e){if(e.comment&&t.type===$i.Comment)return!0;if(t.type===$i.Element){if(e.script&&("script"===t.tagName||"link"===t.tagName&&("preload"===t.attributes.rel||"modulepreload"===t.attributes.rel)&&"script"===t.attributes.as||"link"===t.tagName&&"prefetch"===t.attributes.rel&&"string"==typeof t.attributes.href&&"js"===ca(t.attributes.href)))return!0;if(e.headFavicon&&("link"===t.tagName&&"shortcut icon"===t.attributes.rel||"meta"===t.tagName&&(Aa(t.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===Aa(t.attributes.name)||"icon"===Aa(t.attributes.rel)||"apple-touch-icon"===Aa(t.attributes.rel)||"shortcut icon"===Aa(t.attributes.rel))))return!0;if("meta"===t.tagName){if(e.headMetaDescKeywords&&Aa(t.attributes.name).match(/^description|keywords$/))return!0;if(e.headMetaSocial&&(Aa(t.attributes.property).match(/^(og|twitter|fb):/)||Aa(t.attributes.name).match(/^(og|twitter):/)||"pinterest"===Aa(t.attributes.name)))return!0;if(e.headMetaRobots&&("robots"===Aa(t.attributes.name)||"googlebot"===Aa(t.attributes.name)||"bingbot"===Aa(t.attributes.name)))return!0;if(e.headMetaHttpEquiv&&void 0!==t.attributes["http-equiv"])return!0;if(e.headMetaAuthorship&&("author"===Aa(t.attributes.name)||"generator"===Aa(t.attributes.name)||"framework"===Aa(t.attributes.name)||"publisher"===Aa(t.attributes.name)||"progid"===Aa(t.attributes.name)||Aa(t.attributes.property).match(/^article:/)||Aa(t.attributes.property).match(/^product:/)))return!0;if(e.headMetaVerification&&("google-site-verification"===Aa(t.attributes.name)||"yandex-verification"===Aa(t.attributes.name)||"csrf-token"===Aa(t.attributes.name)||"p:domain_verify"===Aa(t.attributes.name)||"verify-v1"===Aa(t.attributes.name)||"verification"===Aa(t.attributes.name)||"shopify-checkout-api-token"===Aa(t.attributes.name)))return!0}}return!1}(O,f)&&(C||O.type!==$i.Text||O.isStyle||O.textContent.replace(/^\s+|\s+$/gm,"").length)?pa():-2;const w=Object.assign(O,{id:R});if(r.add(t,w),-2===R)return null;v&&v(t);let A=!u;if(w.type===$i.Element){A=A&&!w.needBlock,delete w.needBlock;const e=t.shadowRoot;e&&ea(e)&&(w.isShadowHost=!0)}if((w.type===$i.Document||w.type===$i.Element)&&A){f.headWhitespace&&w.type===$i.Element&&"head"===w.tagName&&(C=!1);const e={doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:I,maskTextClass:a,maskTextSelector:s,skipChild:u,inlineStylesheet:c,maskInputOptions:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:f,dataURLOptions:h,inlineImages:m,recordCanvas:g,preserveWhiteSpace:C,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E,onStylesheetLoad:_,stylesheetLoadTimeout:T,keepIframeSrcFn:S};if(w.type===$i.Element&&"textarea"===w.tagName&&void 0!==w.attributes.value);else for(const n of Array.from(t.childNodes)){const t=La(n,e);t&&w.childNodes.push(t)}if(function(t){return t.nodeType===t.ELEMENT_NODE}(t)&&t.shadowRoot)for(const n of Array.from(t.shadowRoot.childNodes)){const r=La(n,e);r&&(ea(t.shadowRoot)&&(r.isShadow=!0),w.childNodes.push(r))}}return t.parentNode&&ta(t.parentNode)&&ea(t.parentNode)&&(w.isShadow=!0),w.type===$i.Element&&"iframe"===w.tagName&&function(t,e,n){const r=t.contentWindow;if(!r)return;let o,i=!1;try{o=r.document.readyState}catch(t){return}if("complete"!==o){const r=setTimeout((()=>{i||(e(),i=!0)}),n);return void t.addEventListener("load",(()=>{clearTimeout(r),i=!0,e()}))}const a="about:blank";if(r.location.href!==a||t.src===a||""===t.src)return setTimeout(e,0),t.addEventListener("load",e);t.addEventListener("load",e)}(t,(()=>{const e=t.contentDocument;if(e&&y){const n=La(e,{doc:e,mirror:r,blockClass:o,blockSelector:i,needsMask:I,maskTextClass:a,maskTextSelector:s,skipChild:!1,inlineStylesheet:c,maskInputOptions:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:f,dataURLOptions:h,inlineImages:m,recordCanvas:g,preserveWhiteSpace:C,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E,onStylesheetLoad:_,stylesheetLoadTimeout:T,keepIframeSrcFn:S});n&&y(t,n)}}),E),w.type===$i.Element&&"link"===w.tagName&&"string"==typeof w.attributes.rel&&("stylesheet"===w.attributes.rel||"preload"===w.attributes.rel&&"string"==typeof w.attributes.href&&"css"===ca(w.attributes.href))&&function(t,e,n){let r,o=!1;try{r=t.sheet}catch(t){return}if(r)return;const i=setTimeout((()=>{o||(e(),o=!0)}),n);t.addEventListener("load",(()=>{clearTimeout(i),o=!0,e()}))}(t,(()=>{if(_){const e=La(t,{doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:I,maskTextClass:a,maskTextSelector:s,skipChild:!1,inlineStylesheet:c,maskInputOptions:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:f,dataURLOptions:h,inlineImages:m,recordCanvas:g,preserveWhiteSpace:C,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E,onStylesheetLoad:_,stylesheetLoadTimeout:T,keepIframeSrcFn:S});e&&_(t,e)}}),T),w}const Na=(new RegExp(/(max|min)-device-(width|height)/.source,"g"),/([^\\]):hover/);function Ma(t,e,n=document){const r={capture:!0,passive:!0};return n.addEventListener(t,e,r),()=>n.removeEventListener(t,e,r)}new RegExp(Na.source,"g");const xa="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let Pa={map:{},getId:()=>(console.error(xa),-1),getNode:()=>(console.error(xa),null),removeNodeFromMap(){console.error(xa)},has:()=>(console.error(xa),!1),reset(){console.error(xa)}};function ka(t,e,n={}){let r=null,o=0;return function(...i){const a=Date.now();o||!1!==n.leading||(o=a);const s=e-(a-o),u=this;s<=0||s>e?(r&&(clearTimeout(r),r=null),o=a,t.apply(u,i)):r||!1===n.trailing||(r=setTimeout((()=>{o=!1===n.leading?0:Date.now(),r=null,t.apply(u,i)}),s))}}function Da(t,e,n,r,o=window){const i=o.Object.getOwnPropertyDescriptor(t,e);return o.Object.defineProperty(t,e,r?n:{set(t){setTimeout((()=>{n.set.call(this,t)}),0),i&&i.set&&i.set.call(this,t)}}),()=>Da(t,e,i||{},!0)}function Ua(t,e,n){try{if(!(e in t))return()=>{};const r=t[e],o=n(r);return"function"==typeof o&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:r}})),t[e]=o,()=>{t[e]=r}}catch{return()=>{}}}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(Pa=new Proxy(Pa,{get:(t,e,n)=>("map"===e&&console.error(xa),Reflect.get(t,e,n))}));let Ba=Date.now;function Fa(t){var e,n,r,o,i,a;const s=t.document;return{left:s.scrollingElement?s.scrollingElement.scrollLeft:void 0!==t.pageXOffset?t.pageXOffset:(null==s?void 0:s.documentElement.scrollLeft)||(null==(n=null==(e=null==s?void 0:s.body)?void 0:e.parentElement)?void 0:n.scrollLeft)||(null==(r=null==s?void 0:s.body)?void 0:r.scrollLeft)||0,top:s.scrollingElement?s.scrollingElement.scrollTop:void 0!==t.pageYOffset?t.pageYOffset:(null==s?void 0:s.documentElement.scrollTop)||(null==(i=null==(o=null==s?void 0:s.body)?void 0:o.parentElement)?void 0:i.scrollTop)||(null==(a=null==s?void 0:s.body)?void 0:a.scrollTop)||0}}function ja(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Ga(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function Wa(t){return t?t.nodeType===t.ELEMENT_NODE?t:t.parentElement:null}function Xa(t,e,n,r){if(!t)return!1;const o=Wa(t);if(!o)return!1;try{if("string"==typeof e){if(o.classList.contains(e))return!0;if(r&&null!==o.closest("."+e))return!0}else if(Ra(o,e,r))return!0}catch(t){}if(n){if(o.matches(n))return!0;if(r&&null!==o.closest(n))return!0}return!1}function Ha(t,e,n){return!("TITLE"!==t.tagName||!n.headTitleMutations)||-2===e.getId(t)}function Va(t,e){if(ta(t))return!1;const n=e.getId(t);return!e.has(n)||(!t.parentNode||t.parentNode.nodeType!==t.DOCUMENT_NODE)&&(!t.parentNode||Va(t.parentNode,e))}function Ya(t){return Boolean(t.changedTouches)}function za(t,e){return Boolean("IFRAME"===t.nodeName&&e.getMeta(t))}function Za(t,e){return Boolean("LINK"===t.nodeName&&t.nodeType===t.ELEMENT_NODE&&t.getAttribute&&"stylesheet"===t.getAttribute("rel")&&e.getMeta(t))}function Ka(t){return Boolean(null==t?void 0:t.shadowRoot)}/[1-9][0-9]{12}/.test(Date.now().toString())||(Ba=()=>(new Date).getTime());class Ja{constructor(){Ji(this,"id",1),Ji(this,"styleIDMap",new WeakMap),Ji(this,"idStyleMap",new Map)}getId(t){return this.styleIDMap.get(t)??-1}has(t){return this.styleIDMap.has(t)}add(t,e){if(this.has(t))return this.getId(t);let n;return n=void 0===e?this.id++:e,this.styleIDMap.set(t,n),this.idStyleMap.set(n,t),n}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function Qa(t){var e,n;let r=null;return(null==(n=null==(e=t.getRootNode)?void 0:e.call(t))?void 0:n.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&t.getRootNode().host&&(r=t.getRootNode().host),r}function qa(t){const e=t.ownerDocument;if(!e)return!1;const n=function(t){let e,n=t;for(;e=Qa(n);)n=e;return n}(t);return e.contains(n)}function $a(t){const e=t.ownerDocument;return!!e&&(e.contains(t)||qa(t))}Symbol.toStringTag;var ts=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))(ts||{}),es=(t=>(t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t[t.CustomElement=16]="CustomElement",t))(es||{}),ns=(t=>(t[t.MouseUp=0]="MouseUp",t[t.MouseDown=1]="MouseDown",t[t.Click=2]="Click",t[t.ContextMenu=3]="ContextMenu",t[t.DblClick=4]="DblClick",t[t.Focus=5]="Focus",t[t.Blur=6]="Blur",t[t.TouchStart=7]="TouchStart",t[t.TouchMove_Departed=8]="TouchMove_Departed",t[t.TouchEnd=9]="TouchEnd",t[t.TouchCancel=10]="TouchCancel",t))(ns||{}),rs=(t=>(t[t.Mouse=0]="Mouse",t[t.Pen=1]="Pen",t[t.Touch=2]="Touch",t))(rs||{}),os=(t=>(t[t["2D"]=0]="2D",t[t.WebGL=1]="WebGL",t[t.WebGL2=2]="WebGL2",t))(os||{}),is=(t=>(t[t.Play=0]="Play",t[t.Pause=1]="Pause",t[t.Seeked=2]="Seeked",t[t.VolumeChange=3]="VolumeChange",t[t.RateChange=4]="RateChange",t))(is||{});function as(t){return"__ln"in t}class ss{constructor(){Ji(this,"length",0),Ji(this,"head",null),Ji(this,"tail",null)}get(t){if(t>=this.length)throw new Error("Position outside of list range");let e=this.head;for(let n=0;n<t;n++)e=(null==e?void 0:e.next)||null;return e}addNode(t){const e={value:t,previous:null,next:null};if(t.__ln=e,t.previousSibling&&as(t.previousSibling)){const n=t.previousSibling.__ln.next;e.next=n,e.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=e,n&&(n.previous=e)}else if(t.nextSibling&&as(t.nextSibling)&&t.nextSibling.__ln.previous){const n=t.nextSibling.__ln.previous;e.previous=n,e.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=e,n&&(n.next=e)}else this.head&&(this.head.previous=e),e.next=this.head,this.head=e;null===e.next&&(this.tail=e),this.length++}removeNode(t){const e=t.__ln;this.head&&(e.previous?(e.previous.next=e.next,e.next?e.next.previous=e.previous:this.tail=e.previous):(this.head=e.next,this.head?this.head.previous=null:this.tail=null),t.__ln&&delete t.__ln,this.length--)}}const us=(t,e)=>`${t}@${e}`;class cs{constructor(){Ji(this,"frozen",!1),Ji(this,"locked",!1),Ji(this,"texts",[]),Ji(this,"attributes",[]),Ji(this,"attributeMap",new WeakMap),Ji(this,"removes",[]),Ji(this,"mapRemoves",[]),Ji(this,"movedMap",{}),Ji(this,"addedSet",new Set),Ji(this,"movedSet",new Set),Ji(this,"droppedSet",new Set),Ji(this,"mutationCb"),Ji(this,"blockClass"),Ji(this,"blockSelector"),Ji(this,"maskTextClass"),Ji(this,"maskTextSelector"),Ji(this,"inlineStylesheet"),Ji(this,"maskInputOptions"),Ji(this,"maskTextFn"),Ji(this,"maskInputFn"),Ji(this,"keepIframeSrcFn"),Ji(this,"recordCanvas"),Ji(this,"inlineImages"),Ji(this,"slimDOMOptions"),Ji(this,"dataURLOptions"),Ji(this,"doc"),Ji(this,"mirror"),Ji(this,"iframeManager"),Ji(this,"stylesheetManager"),Ji(this,"shadowDomManager"),Ji(this,"canvasManager"),Ji(this,"processedNodeManager"),Ji(this,"unattachedDoc"),Ji(this,"processMutations",(t=>{t.forEach(this.processMutation),this.emit()})),Ji(this,"emit",(()=>{if(this.frozen||this.locked)return;const t=[],e=new Set,n=new ss,r=t=>{let e=t,n=-2;for(;-2===n;)e=e&&e.nextSibling,n=e&&this.mirror.getId(e);return n},o=o=>{if(!o.parentNode||!$a(o)||"TEXTAREA"===o.parentNode.tagName)return;const i=ta(o.parentNode)?this.mirror.getId(Qa(o)):this.mirror.getId(o.parentNode),a=r(o);if(-1===i||-1===a)return n.addNode(o);const s=La(o,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:t=>{za(t,this.mirror)&&this.iframeManager.addIframe(t),Za(t,this.mirror)&&this.stylesheetManager.trackLinkElement(t),Ka(o)&&this.shadowDomManager.addShadowRoot(o.shadowRoot,this.doc)},onIframeLoad:(t,e)=>{this.iframeManager.attachIframe(t,e),this.shadowDomManager.observeAttachShadow(t)},onStylesheetLoad:(t,e)=>{this.stylesheetManager.attachLinkElement(t,e)}});s&&(t.push({parentId:i,nextId:a,node:s}),e.add(s.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const t of this.movedSet)ds(this.removes,t,this.mirror)&&!this.movedSet.has(t.parentNode)||o(t);for(const t of this.addedSet)ps(this.droppedSet,t)||ds(this.removes,t,this.mirror)?ps(this.movedSet,t)?o(t):this.droppedSet.add(t):o(t);let i=null;for(;n.length;){let t=null;if(i){const e=this.mirror.getId(i.value.parentNode),n=r(i.value);-1!==e&&-1!==n&&(t=i)}if(!t){let e=n.tail;for(;e;){const n=e;if(e=e.previous,n){const e=this.mirror.getId(n.value.parentNode);if(-1===r(n.value))continue;if(-1!==e){t=n;break}{const e=n.value;if(e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const r=e.parentNode.host;if(-1!==this.mirror.getId(r)){t=n;break}}}}}}if(!t){for(;n.head;)n.removeNode(n.head.value);break}i=t.previous,n.removeNode(t.value),o(t.value)}const a={texts:this.texts.map((t=>{const e=t.node;return e.parentNode&&"TEXTAREA"===e.parentNode.tagName&&this.genTextAreaValueMutation(e.parentNode),{id:this.mirror.getId(e),value:t.value}})).filter((t=>!e.has(t.id))).filter((t=>this.mirror.has(t.id))),attributes:this.attributes.map((t=>{const{attributes:e}=t;if("string"==typeof e.style){const n=JSON.stringify(t.styleDiff),r=JSON.stringify(t._unchangedStyles);n.length<e.style.length&&(n+r).split("var(").length===e.style.split("var(").length&&(e.style=t.styleDiff)}return{id:this.mirror.getId(t.node),attributes:e}})).filter((t=>!e.has(t.id))).filter((t=>this.mirror.has(t.id))),removes:this.removes,adds:t};(a.texts.length||a.attributes.length||a.removes.length||a.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(a))})),Ji(this,"genTextAreaValueMutation",(t=>{let e=this.attributeMap.get(t);e||(e={node:t,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(e),this.attributeMap.set(t,e)),e.attributes.value=Array.from(t.childNodes,(t=>t.textContent||"")).join("")})),Ji(this,"processMutation",(t=>{if(!Ha(t.target,this.mirror,this.slimDOMOptions))switch(t.type){case"characterData":{const e=t.target.textContent;Xa(t.target,this.blockClass,this.blockSelector,!1)||e===t.oldValue||this.texts.push({value:wa(t.target,this.maskTextClass,this.maskTextSelector,!0)&&e?this.maskTextFn?this.maskTextFn(e,Wa(t.target)):e.replace(/[\S]/g,"*"):e,node:t.target});break}case"attributes":{const e=t.target;let n=t.attributeName,r=t.target.getAttribute(n);if("value"===n){const t=ua(e);r=ia({element:e,maskInputOptions:this.maskInputOptions,tagName:e.tagName,type:t,value:r,maskInputFn:this.maskInputFn})}if(Xa(t.target,this.blockClass,this.blockSelector,!1)||r===t.oldValue)return;let o=this.attributeMap.get(t.target);if("IFRAME"===e.tagName&&"src"===n&&!this.keepIframeSrcFn(r)){if(e.contentDocument)return;n="rr_src"}if(o||(o={node:t.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(o),this.attributeMap.set(t.target,o)),"type"===n&&"INPUT"===e.tagName&&"password"===(t.oldValue||"").toLowerCase()&&e.setAttribute("data-rr-is-password","true"),!Oa(e.tagName,n)&&(o.attributes[n]=Ca(this.doc,aa(e.tagName),aa(n),r),"style"===n)){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(t){this.unattachedDoc=this.doc}const n=this.unattachedDoc.createElement("span");t.oldValue&&n.setAttribute("style",t.oldValue);for(const t of Array.from(e.style)){const r=e.style.getPropertyValue(t),i=e.style.getPropertyPriority(t);r!==n.style.getPropertyValue(t)||i!==n.style.getPropertyPriority(t)?o.styleDiff[t]=""===i?r:[r,i]:o._unchangedStyles[t]=[r,i]}for(const t of Array.from(n.style))""===e.style.getPropertyValue(t)&&(o.styleDiff[t]=!1)}break}case"childList":if(Xa(t.target,this.blockClass,this.blockSelector,!0))return;if("TEXTAREA"===t.target.tagName)return void this.genTextAreaValueMutation(t.target);t.addedNodes.forEach((e=>this.genAdds(e,t.target))),t.removedNodes.forEach((e=>{const n=this.mirror.getId(e),r=ta(t.target)?this.mirror.getId(t.target.host):this.mirror.getId(t.target);Xa(t.target,this.blockClass,this.blockSelector,!1)||Ha(e,this.mirror,this.slimDOMOptions)||!function(t,e){return-1!==e.getId(t)}(e,this.mirror)||(this.addedSet.has(e)?(ls(this.addedSet,e),this.droppedSet.add(e)):this.addedSet.has(t.target)&&-1===n||Va(t.target,this.mirror)||(this.movedSet.has(e)&&this.movedMap[us(n,r)]?ls(this.movedSet,e):this.removes.push({parentId:r,id:n,isShadow:!(!ta(t.target)||!ea(t.target))||void 0})),this.mapRemoves.push(e))}))}})),Ji(this,"genAdds",((t,e)=>{if(!this.processedNodeManager.inOtherBuffer(t,this)&&!this.addedSet.has(t)&&!this.movedSet.has(t)){if(this.mirror.hasNode(t)){if(Ha(t,this.mirror,this.slimDOMOptions))return;this.movedSet.add(t);let n=null;e&&this.mirror.hasNode(e)&&(n=this.mirror.getId(e)),n&&-1!==n&&(this.movedMap[us(this.mirror.getId(t),n)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);Xa(t,this.blockClass,this.blockSelector,!1)||(t.childNodes.forEach((t=>this.genAdds(t))),Ka(t)&&t.shadowRoot.childNodes.forEach((e=>{this.processedNodeManager.add(e,this),this.genAdds(e,t)})))}}))}init(t){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach((e=>{this[e]=t[e]}))}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function ls(t,e){t.delete(e),e.childNodes.forEach((e=>ls(t,e)))}function ds(t,e,n){return 0!==t.length&&function(t,e,n){let r=e.parentNode;for(;r;){const e=n.getId(r);if(t.some((t=>t.id===e)))return!0;r=r.parentNode}return!1}(t,e,n)}function ps(t,e){return 0!==t.size&&fs(t,e)}function fs(t,e){const{parentNode:n}=e;return!!n&&(!!t.has(n)||fs(t,n))}let hs;const ms=t=>hs?(...e)=>{try{return t(...e)}catch(t){if(hs&&!0===hs(t))return;throw t}}:t,gs=[];function vs(t){try{if("composedPath"in t){const e=t.composedPath();if(e.length)return e[0]}else if("path"in t&&t.path.length)return t.path[0]}catch{}return t&&t.target}function ys(t,e){var n,r;const o=new cs;gs.push(o),o.init(t);let i=window.MutationObserver||window.__rrMutationObserver;const a=null==(r=null==(n=null==window?void 0:window.Zone)?void 0:n.__symbol__)?void 0:r.call(n,"MutationObserver");a&&window[a]&&(i=window[a]);const s=new i(ms(o.processMutations.bind(o)));return s.observe(e,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),s}function Es({scrollCb:t,doc:e,mirror:n,blockClass:r,blockSelector:o,sampling:i}){return Ma("scroll",ms(ka(ms((i=>{const a=vs(i);if(!a||Xa(a,r,o,!0))return;const s=n.getId(a);if(a===e&&e.defaultView){const n=Fa(e.defaultView);t({id:s,x:n.left,y:n.top})}else t({id:s,x:a.scrollLeft,y:a.scrollTop})})),i.scroll||100)),e)}const _s=["INPUT","TEXTAREA","SELECT"],Ts=new WeakMap;function Ss(t){return function(t,e){if(Os("CSSGroupingRule")&&t.parentRule instanceof CSSGroupingRule||Os("CSSMediaRule")&&t.parentRule instanceof CSSMediaRule||Os("CSSSupportsRule")&&t.parentRule instanceof CSSSupportsRule||Os("CSSConditionRule")&&t.parentRule instanceof CSSConditionRule){const n=Array.from(t.parentRule.cssRules).indexOf(t);e.unshift(n)}else if(t.parentStyleSheet){const n=Array.from(t.parentStyleSheet.cssRules).indexOf(t);e.unshift(n)}return e}(t,[])}function bs(t,e,n){let r,o;return t?(t.ownerNode?r=e.getId(t.ownerNode):o=n.getId(t),{styleId:o,id:r}):{}}function Is({mirror:t,stylesheetManager:e},n){var r,o,i;let a=null;a="#document"===n.nodeName?t.getId(n):t.getId(n.host);const s="#document"===n.nodeName?null==(r=n.defaultView)?void 0:r.Document:null==(i=null==(o=n.ownerDocument)?void 0:o.defaultView)?void 0:i.ShadowRoot,u=(null==s?void 0:s.prototype)?Object.getOwnPropertyDescriptor(null==s?void 0:s.prototype,"adoptedStyleSheets"):void 0;return null!==a&&-1!==a&&s&&u?(Object.defineProperty(n,"adoptedStyleSheets",{configurable:u.configurable,enumerable:u.enumerable,get(){var t;return null==(t=u.get)?void 0:t.call(this)},set(t){var n;const r=null==(n=u.set)?void 0:n.call(this,t);if(null!==a&&-1!==a)try{e.adoptStyleSheets(t,a)}catch(t){}return r}}),ms((()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:u.configurable,enumerable:u.enumerable,get:u.get,set:u.set})}))):()=>{}}function Cs(t,e={}){const n=t.doc.defaultView;if(!n)return()=>{};let r;!function(t,e){const{mutationCb:n,mousemoveCb:r,mouseInteractionCb:o,scrollCb:i,viewportResizeCb:a,inputCb:s,mediaInteractionCb:u,styleSheetRuleCb:c,styleDeclarationCb:l,canvasMutationCb:d,fontCb:p,selectionCb:f,customElementCb:h}=t;t.mutationCb=(...t)=>{e.mutation&&e.mutation(...t),n(...t)},t.mousemoveCb=(...t)=>{e.mousemove&&e.mousemove(...t),r(...t)},t.mouseInteractionCb=(...t)=>{e.mouseInteraction&&e.mouseInteraction(...t),o(...t)},t.scrollCb=(...t)=>{e.scroll&&e.scroll(...t),i(...t)},t.viewportResizeCb=(...t)=>{e.viewportResize&&e.viewportResize(...t),a(...t)},t.inputCb=(...t)=>{e.input&&e.input(...t),s(...t)},t.mediaInteractionCb=(...t)=>{e.mediaInteaction&&e.mediaInteaction(...t),u(...t)},t.styleSheetRuleCb=(...t)=>{e.styleSheetRule&&e.styleSheetRule(...t),c(...t)},t.styleDeclarationCb=(...t)=>{e.styleDeclaration&&e.styleDeclaration(...t),l(...t)},t.canvasMutationCb=(...t)=>{e.canvasMutation&&e.canvasMutation(...t),d(...t)},t.fontCb=(...t)=>{e.font&&e.font(...t),p(...t)},t.selectionCb=(...t)=>{e.selection&&e.selection(...t),f(...t)},t.customElementCb=(...t)=>{e.customElement&&e.customElement(...t),h(...t)}}(t,e),t.recordDOM&&(r=ys(t,t.doc));const o=function({mousemoveCb:t,sampling:e,doc:n,mirror:r}){if(!1===e.mousemove)return()=>{};const o="number"==typeof e.mousemove?e.mousemove:50,i="number"==typeof e.mousemoveCallback?e.mousemoveCallback:500;let a,s=[];const u=ka(ms((e=>{const n=Date.now()-a;t(s.map((t=>(t.timeOffset-=n,t))),e),s=[],a=null})),i),c=ms(ka(ms((t=>{const e=vs(t),{clientX:n,clientY:o}=Ya(t)?t.changedTouches[0]:t;a||(a=Ba()),s.push({x:n,y:o,id:r.getId(e),timeOffset:Ba()-a}),u("undefined"!=typeof DragEvent&&t instanceof DragEvent?es.Drag:t instanceof MouseEvent?es.MouseMove:es.TouchMove)})),o,{trailing:!1})),l=[Ma("mousemove",c,n),Ma("touchmove",c,n),Ma("drag",c,n)];return ms((()=>{l.forEach((t=>t()))}))}(t),i=function({mouseInteractionCb:t,doc:e,mirror:n,blockClass:r,blockSelector:o,sampling:i}){if(!1===i.mouseInteraction)return()=>{};const a=!0===i.mouseInteraction||void 0===i.mouseInteraction?{}:i.mouseInteraction,s=[];let u=null;return Object.keys(ns).filter((t=>Number.isNaN(Number(t))&&!t.endsWith("_Departed")&&!1!==a[t])).forEach((i=>{let a=aa(i);const c=(e=>i=>{const a=vs(i);if(Xa(a,r,o,!0))return;let s=null,c=e;if("pointerType"in i){switch(i.pointerType){case"mouse":s=rs.Mouse;break;case"touch":s=rs.Touch;break;case"pen":s=rs.Pen}s===rs.Touch?ns[e]===ns.MouseDown?c="TouchStart":ns[e]===ns.MouseUp&&(c="TouchEnd"):rs.Pen}else Ya(i)&&(s=rs.Touch);null!==s?(u=s,(c.startsWith("Touch")&&s===rs.Touch||c.startsWith("Mouse")&&s===rs.Mouse)&&(s=null)):ns[e]===ns.Click&&(s=u,u=null);const l=Ya(i)?i.changedTouches[0]:i;if(!l)return;const d=n.getId(a),{clientX:p,clientY:f}=l;ms(t)({type:ns[c],id:d,x:p,y:f,...null!==s&&{pointerType:s}})})(i);if(window.PointerEvent)switch(ns[i]){case ns.MouseDown:case ns.MouseUp:a=a.replace("mouse","pointer");break;case ns.TouchStart:case ns.TouchEnd:return}s.push(Ma(a,c,e))})),ms((()=>{s.forEach((t=>t()))}))}(t),a=Es(t),s=function({viewportResizeCb:t},{win:e}){let n=-1,r=-1;return Ma("resize",ms(ka(ms((()=>{const e=ja(),o=Ga();n===e&&r===o||(t({width:Number(o),height:Number(e)}),n=e,r=o)})),200)),e)}(t,{win:n}),u=function({inputCb:t,doc:e,mirror:n,blockClass:r,blockSelector:o,ignoreClass:i,ignoreSelector:a,maskInputOptions:s,maskInputFn:u,sampling:c,userTriggeredOnInput:l}){function d(t){let n=vs(t);const c=t.isTrusted,d=n&&n.tagName;if(n&&"OPTION"===d&&(n=n.parentElement),!n||!d||_s.indexOf(d)<0||Xa(n,r,o,!0))return;if(n.classList.contains(i)||a&&n.matches(a))return;let f=n.value,h=!1;const m=ua(n)||"";"radio"===m||"checkbox"===m?h=n.checked:(s[d.toLowerCase()]||s[m])&&(f=ia({element:n,maskInputOptions:s,tagName:d,type:m,value:f,maskInputFn:u})),p(n,l?{text:f,isChecked:h,userTriggered:c}:{text:f,isChecked:h});const g=n.name;"radio"===m&&g&&h&&e.querySelectorAll(`input[type="radio"][name="${g}"]`).forEach((t=>{if(t!==n){const e=t.value;p(t,l?{text:e,isChecked:!h,userTriggered:!1}:{text:e,isChecked:!h})}}))}function p(e,r){const o=Ts.get(e);if(!o||o.text!==r.text||o.isChecked!==r.isChecked){Ts.set(e,r);const o=n.getId(e);ms(t)({...r,id:o})}}const f=("last"===c.input?["change"]:["input","change"]).map((t=>Ma(t,ms(d),e))),h=e.defaultView;if(!h)return()=>{f.forEach((t=>t()))};const m=h.Object.getOwnPropertyDescriptor(h.HTMLInputElement.prototype,"value"),g=[[h.HTMLInputElement.prototype,"value"],[h.HTMLInputElement.prototype,"checked"],[h.HTMLSelectElement.prototype,"value"],[h.HTMLTextAreaElement.prototype,"value"],[h.HTMLSelectElement.prototype,"selectedIndex"],[h.HTMLOptionElement.prototype,"selected"]];return m&&m.set&&f.push(...g.map((t=>Da(t[0],t[1],{set(){ms(d)({target:this,isTrusted:!1})}},!1,h)))),ms((()=>{f.forEach((t=>t()))}))}(t),c=function({mediaInteractionCb:t,blockClass:e,blockSelector:n,mirror:r,sampling:o,doc:i}){const a=ms((i=>ka(ms((o=>{const a=vs(o);if(!a||Xa(a,e,n,!0))return;const{currentTime:s,volume:u,muted:c,playbackRate:l,loop:d}=a;t({type:i,id:r.getId(a),currentTime:s,volume:u,muted:c,playbackRate:l,loop:d})})),o.media||500))),s=[Ma("play",a(is.Play),i),Ma("pause",a(is.Pause),i),Ma("seeked",a(is.Seeked),i),Ma("volumechange",a(is.VolumeChange),i),Ma("ratechange",a(is.RateChange),i)];return ms((()=>{s.forEach((t=>t()))}))}(t);let l=()=>{},d=()=>{},p=()=>{},f=()=>{};t.recordDOM&&(l=function({styleSheetRuleCb:t,mirror:e,stylesheetManager:n},{win:r}){if(!r.CSSStyleSheet||!r.CSSStyleSheet.prototype)return()=>{};const o=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=new Proxy(o,{apply:ms(((r,o,i)=>{const[a,s]=i,{id:u,styleId:c}=bs(o,e,n.styleMirror);return(u&&-1!==u||c&&-1!==c)&&t({id:u,styleId:c,adds:[{rule:a,index:s}]}),r.apply(o,i)}))});const i=r.CSSStyleSheet.prototype.deleteRule;let a,s;r.CSSStyleSheet.prototype.deleteRule=new Proxy(i,{apply:ms(((r,o,i)=>{const[a]=i,{id:s,styleId:u}=bs(o,e,n.styleMirror);return(s&&-1!==s||u&&-1!==u)&&t({id:s,styleId:u,removes:[{index:a}]}),r.apply(o,i)}))}),r.CSSStyleSheet.prototype.replace&&(a=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=new Proxy(a,{apply:ms(((r,o,i)=>{const[a]=i,{id:s,styleId:u}=bs(o,e,n.styleMirror);return(s&&-1!==s||u&&-1!==u)&&t({id:s,styleId:u,replace:a}),r.apply(o,i)}))})),r.CSSStyleSheet.prototype.replaceSync&&(s=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=new Proxy(s,{apply:ms(((r,o,i)=>{const[a]=i,{id:s,styleId:u}=bs(o,e,n.styleMirror);return(s&&-1!==s||u&&-1!==u)&&t({id:s,styleId:u,replaceSync:a}),r.apply(o,i)}))}));const u={};Rs("CSSGroupingRule")?u.CSSGroupingRule=r.CSSGroupingRule:(Rs("CSSMediaRule")&&(u.CSSMediaRule=r.CSSMediaRule),Rs("CSSConditionRule")&&(u.CSSConditionRule=r.CSSConditionRule),Rs("CSSSupportsRule")&&(u.CSSSupportsRule=r.CSSSupportsRule));const c={};return Object.entries(u).forEach((([r,o])=>{c[r]={insertRule:o.prototype.insertRule,deleteRule:o.prototype.deleteRule},o.prototype.insertRule=new Proxy(c[r].insertRule,{apply:ms(((r,o,i)=>{const[a,s]=i,{id:u,styleId:c}=bs(o.parentStyleSheet,e,n.styleMirror);return(u&&-1!==u||c&&-1!==c)&&t({id:u,styleId:c,adds:[{rule:a,index:[...Ss(o),s||0]}]}),r.apply(o,i)}))}),o.prototype.deleteRule=new Proxy(c[r].deleteRule,{apply:ms(((r,o,i)=>{const[a]=i,{id:s,styleId:u}=bs(o.parentStyleSheet,e,n.styleMirror);return(s&&-1!==s||u&&-1!==u)&&t({id:s,styleId:u,removes:[{index:[...Ss(o),a]}]}),r.apply(o,i)}))})})),ms((()=>{r.CSSStyleSheet.prototype.insertRule=o,r.CSSStyleSheet.prototype.deleteRule=i,a&&(r.CSSStyleSheet.prototype.replace=a),s&&(r.CSSStyleSheet.prototype.replaceSync=s),Object.entries(u).forEach((([t,e])=>{e.prototype.insertRule=c[t].insertRule,e.prototype.deleteRule=c[t].deleteRule}))}))}(t,{win:n}),d=Is(t,t.doc),p=function({styleDeclarationCb:t,mirror:e,ignoreCSSAttributes:n,stylesheetManager:r},{win:o}){const i=o.CSSStyleDeclaration.prototype.setProperty;o.CSSStyleDeclaration.prototype.setProperty=new Proxy(i,{apply:ms(((o,a,s)=>{var u;const[c,l,d]=s;if(n.has(c))return i.apply(a,[c,l,d]);const{id:p,styleId:f}=bs(null==(u=a.parentRule)?void 0:u.parentStyleSheet,e,r.styleMirror);return(p&&-1!==p||f&&-1!==f)&&t({id:p,styleId:f,set:{property:c,value:l,priority:d},index:Ss(a.parentRule)}),o.apply(a,s)}))});const a=o.CSSStyleDeclaration.prototype.removeProperty;return o.CSSStyleDeclaration.prototype.removeProperty=new Proxy(a,{apply:ms(((o,i,s)=>{var u;const[c]=s;if(n.has(c))return a.apply(i,[c]);const{id:l,styleId:d}=bs(null==(u=i.parentRule)?void 0:u.parentStyleSheet,e,r.styleMirror);return(l&&-1!==l||d&&-1!==d)&&t({id:l,styleId:d,remove:{property:c},index:Ss(i.parentRule)}),o.apply(i,s)}))}),ms((()=>{o.CSSStyleDeclaration.prototype.setProperty=i,o.CSSStyleDeclaration.prototype.removeProperty=a}))}(t,{win:n}),t.collectFonts&&(f=function({fontCb:t,doc:e}){const n=e.defaultView;if(!n)return()=>{};const r=[],o=new WeakMap,i=n.FontFace;n.FontFace=function(t,e,n){const r=new i(t,e,n);return o.set(r,{family:t,buffer:"string"!=typeof e,descriptors:n,fontSource:"string"==typeof e?e:JSON.stringify(Array.from(new Uint8Array(e)))}),r};const a=Ua(e.fonts,"add",(function(e){return function(n){return setTimeout(ms((()=>{const e=o.get(n);e&&(t(e),o.delete(n))})),0),e.apply(this,[n])}}));return r.push((()=>{n.FontFace=i})),r.push(a),ms((()=>{r.forEach((t=>t()))}))}(t)));const h=function(t){const{doc:e,mirror:n,blockClass:r,blockSelector:o,selectionCb:i}=t;let a=!0;const s=ms((()=>{const t=e.getSelection();if(!t||a&&(null==t?void 0:t.isCollapsed))return;a=t.isCollapsed||!1;const s=[],u=t.rangeCount||0;for(let e=0;e<u;e++){const i=t.getRangeAt(e),{startContainer:a,startOffset:u,endContainer:c,endOffset:l}=i;Xa(a,r,o,!0)||Xa(c,r,o,!0)||s.push({start:n.getId(a),startOffset:u,end:n.getId(c),endOffset:l})}i({ranges:s})}));return s(),Ma("selectionchange",s)}(t),m=function({doc:t,customElementCb:e}){const n=t.defaultView;return n&&n.customElements?Ua(n.customElements,"define",(function(t){return function(n,r,o){try{e({define:{name:n}})}catch(t){console.warn(`Custom element callback failed for ${n}`)}return t.apply(this,[n,r,o])}})):()=>{}}(t),g=[];for(const e of t.plugins)g.push(e.observer(e.callback,n,e.options));return ms((()=>{gs.forEach((t=>t.reset())),null==r||r.disconnect(),o(),i(),a(),s(),u(),c(),l(),d(),p(),f(),h(),m(),g.forEach((t=>t()))}))}function Os(t){return void 0!==window[t]}function Rs(t){return Boolean(void 0!==window[t]&&window[t].prototype&&"insertRule"in window[t].prototype&&"deleteRule"in window[t].prototype)}class ws{constructor(t){Ji(this,"iframeIdToRemoteIdMap",new WeakMap),Ji(this,"iframeRemoteIdToIdMap",new WeakMap),this.generateIdFn=t}getId(t,e,n,r){const o=n||this.getIdToRemoteIdMap(t),i=r||this.getRemoteIdToIdMap(t);let a=o.get(e);return a||(a=this.generateIdFn(),o.set(e,a),i.set(a,e)),a}getIds(t,e){const n=this.getIdToRemoteIdMap(t),r=this.getRemoteIdToIdMap(t);return e.map((e=>this.getId(t,e,n,r)))}getRemoteId(t,e,n){const r=n||this.getRemoteIdToIdMap(t);if("number"!=typeof e)return e;return r.get(e)||-1}getRemoteIds(t,e){const n=this.getRemoteIdToIdMap(t);return e.map((e=>this.getRemoteId(t,e,n)))}reset(t){if(!t)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(t),this.iframeRemoteIdToIdMap.delete(t)}getIdToRemoteIdMap(t){let e=this.iframeIdToRemoteIdMap.get(t);return e||(e=new Map,this.iframeIdToRemoteIdMap.set(t,e)),e}getRemoteIdToIdMap(t){let e=this.iframeRemoteIdToIdMap.get(t);return e||(e=new Map,this.iframeRemoteIdToIdMap.set(t,e)),e}}class As{constructor(t){Ji(this,"iframes",new WeakMap),Ji(this,"crossOriginIframeMap",new WeakMap),Ji(this,"crossOriginIframeMirror",new ws(pa)),Ji(this,"crossOriginIframeStyleMirror"),Ji(this,"crossOriginIframeRootIdMap",new WeakMap),Ji(this,"mirror"),Ji(this,"mutationCb"),Ji(this,"wrappedEmit"),Ji(this,"loadListener"),Ji(this,"stylesheetManager"),Ji(this,"recordCrossOriginIframes"),this.mutationCb=t.mutationCb,this.wrappedEmit=t.wrappedEmit,this.stylesheetManager=t.stylesheetManager,this.recordCrossOriginIframes=t.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new ws(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=t.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(t){this.iframes.set(t,!0),t.contentWindow&&this.crossOriginIframeMap.set(t.contentWindow,t)}addLoadListener(t){this.loadListener=t}attachIframe(t,e){var n,r;this.mutationCb({adds:[{parentId:this.mirror.getId(t),nextId:null,node:e}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),this.recordCrossOriginIframes&&(null==(n=t.contentWindow)||n.addEventListener("message",this.handleMessage.bind(this))),null==(r=this.loadListener)||r.call(this,t),t.contentDocument&&t.contentDocument.adoptedStyleSheets&&t.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(t.contentDocument.adoptedStyleSheets,this.mirror.getId(t.contentDocument))}handleMessage(t){const e=t;if("rrweb"!==e.data.type||e.origin!==e.data.origin)return;if(!t.source)return;const n=this.crossOriginIframeMap.get(t.source);if(!n)return;const r=this.transformCrossOriginEvent(n,e.data.event);r&&this.wrappedEmit(r,e.data.isCheckout)}transformCrossOriginEvent(t,e){var n;switch(e.type){case ts.FullSnapshot:{this.crossOriginIframeMirror.reset(t),this.crossOriginIframeStyleMirror.reset(t),this.replaceIdOnNode(e.data.node,t);const n=e.data.node.id;return this.crossOriginIframeRootIdMap.set(t,n),this.patchRootIdOnNode(e.data.node,n),{timestamp:e.timestamp,type:ts.IncrementalSnapshot,data:{source:es.Mutation,adds:[{parentId:this.mirror.getId(t),nextId:null,node:e.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case ts.Meta:case ts.Load:case ts.DomContentLoaded:return!1;case ts.Plugin:return e;case ts.Custom:return this.replaceIds(e.data.payload,t,["id","parentId","previousId","nextId"]),e;case ts.IncrementalSnapshot:switch(e.data.source){case es.Mutation:return e.data.adds.forEach((e=>{this.replaceIds(e,t,["parentId","nextId","previousId"]),this.replaceIdOnNode(e.node,t);const n=this.crossOriginIframeRootIdMap.get(t);n&&this.patchRootIdOnNode(e.node,n)})),e.data.removes.forEach((e=>{this.replaceIds(e,t,["parentId","id"])})),e.data.attributes.forEach((e=>{this.replaceIds(e,t,["id"])})),e.data.texts.forEach((e=>{this.replaceIds(e,t,["id"])})),e;case es.Drag:case es.TouchMove:case es.MouseMove:return e.data.positions.forEach((e=>{this.replaceIds(e,t,["id"])})),e;case es.ViewportResize:return!1;case es.MediaInteraction:case es.MouseInteraction:case es.Scroll:case es.CanvasMutation:case es.Input:return this.replaceIds(e.data,t,["id"]),e;case es.StyleSheetRule:case es.StyleDeclaration:return this.replaceIds(e.data,t,["id"]),this.replaceStyleIds(e.data,t,["styleId"]),e;case es.Font:return e;case es.Selection:return e.data.ranges.forEach((e=>{this.replaceIds(e,t,["start","end"])})),e;case es.AdoptedStyleSheet:return this.replaceIds(e.data,t,["id"]),this.replaceStyleIds(e.data,t,["styleIds"]),null==(n=e.data.styles)||n.forEach((e=>{this.replaceStyleIds(e,t,["styleId"])})),e}}return!1}replace(t,e,n,r){for(const o of r)(Array.isArray(e[o])||"number"==typeof e[o])&&(Array.isArray(e[o])?e[o]=t.getIds(n,e[o]):e[o]=t.getId(n,e[o]));return e}replaceIds(t,e,n){return this.replace(this.crossOriginIframeMirror,t,e,n)}replaceStyleIds(t,e,n){return this.replace(this.crossOriginIframeStyleMirror,t,e,n)}replaceIdOnNode(t,e){this.replaceIds(t,e,["id","rootId"]),"childNodes"in t&&t.childNodes.forEach((t=>{this.replaceIdOnNode(t,e)}))}patchRootIdOnNode(t,e){t.type===$i.Document||t.rootId||(t.rootId=e),"childNodes"in t&&t.childNodes.forEach((t=>{this.patchRootIdOnNode(t,e)}))}}class Ls{constructor(t){Ji(this,"shadowDoms",new WeakSet),Ji(this,"mutationCb"),Ji(this,"scrollCb"),Ji(this,"bypassOptions"),Ji(this,"mirror"),Ji(this,"restoreHandlers",[]),this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(t,e){if(!ea(t))return;if(this.shadowDoms.has(t))return;this.shadowDoms.add(t);const n=ys({...this.bypassOptions,doc:e,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this},t);this.restoreHandlers.push((()=>n.disconnect())),this.restoreHandlers.push(Es({...this.bypassOptions,scrollCb:this.scrollCb,doc:t,mirror:this.mirror})),setTimeout((()=>{t.adoptedStyleSheets&&t.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(t.adoptedStyleSheets,this.mirror.getId(t.host)),this.restoreHandlers.push(Is({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},t))}),0)}observeAttachShadow(t){t.contentWindow&&t.contentDocument&&this.patchAttachShadow(t.contentWindow.Element,t.contentDocument)}patchAttachShadow(t,e){const n=this;this.restoreHandlers.push(Ua(t.prototype,"attachShadow",(function(t){return function(r){const o=t.call(this,r);return this.shadowRoot&&$a(this)&&n.addShadowRoot(this.shadowRoot,e),o}})))}reset(){this.restoreHandlers.forEach((t=>{try{t()}catch(t){}})),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}for(var Ns="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ms="undefined"==typeof Uint8Array?[]:new Uint8Array(256),xs=0;xs<64;xs++)Ms[Ns.charCodeAt(xs)]=xs;const Ps=new Map,ks=(t,e,n)=>{if(!t||!Bs(t,e)&&"object"!=typeof t)return;const r=function(t,e){let n=Ps.get(t);return n||(n=new Map,Ps.set(t,n)),n.has(e)||n.set(e,[]),n.get(e)}(n,t.constructor.name);let o=r.indexOf(t);return-1===o&&(o=r.length,r.push(t)),o};function Ds(t,e,n){if(t instanceof Array)return t.map((t=>Ds(t,e,n)));if(null===t)return t;if(t instanceof Float32Array||t instanceof Float64Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Int8Array||t instanceof Uint8ClampedArray)return{rr_type:t.constructor.name,args:[Object.values(t)]};if(t instanceof ArrayBuffer)return{rr_type:t.constructor.name,base64:function(t){var e,n=new Uint8Array(t),r=n.length,o="";for(e=0;e<r;e+=3)o+=Ns[n[e]>>2],o+=Ns[(3&n[e])<<4|n[e+1]>>4],o+=Ns[(15&n[e+1])<<2|n[e+2]>>6],o+=Ns[63&n[e+2]];return r%3==2?o=o.substring(0,o.length-1)+"=":r%3==1&&(o=o.substring(0,o.length-2)+"=="),o}(t)};if(t instanceof DataView)return{rr_type:t.constructor.name,args:[Ds(t.buffer,e,n),t.byteOffset,t.byteLength]};if(t instanceof HTMLImageElement){const e=t.constructor.name,{src:n}=t;return{rr_type:e,src:n}}return t instanceof HTMLCanvasElement?{rr_type:"HTMLImageElement",src:t.toDataURL()}:t instanceof ImageData?{rr_type:t.constructor.name,args:[Ds(t.data,e,n),t.width,t.height]}:Bs(t,e)||"object"==typeof t?{rr_type:t.constructor.name,index:ks(t,e,n)}:t}const Us=(t,e,n)=>t.map((t=>Ds(t,e,n))),Bs=(t,e)=>{const n=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((t=>"function"==typeof e[t]));return Boolean(n.find((n=>t instanceof e[n])))};function Fs(t,e,n,r){const o=[];try{const i=Ua(t.HTMLCanvasElement.prototype,"getContext",(function(t){return function(o,...i){if(!Xa(this,e,n,!0)){const t=function(t){return"experimental-webgl"===t?"webgl":t}(o);if("__context"in this||(this.__context=t),r&&["webgl","webgl2"].includes(t))if(i[0]&&"object"==typeof i[0]){const t=i[0];t.preserveDrawingBuffer||(t.preserveDrawingBuffer=!0)}else i.splice(0,1,{preserveDrawingBuffer:!0})}return t.apply(this,[o,...i])}}));o.push(i)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{o.forEach((t=>t()))}}function js(t,e,n,r,o,i,a){const s=[],u=Object.getOwnPropertyNames(t);for(const i of u)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(i))try{if("function"!=typeof t[i])continue;const u=Ua(t,i,(function(t){return function(...s){const u=t.apply(this,s);if(ks(u,a,this),"tagName"in this.canvas&&!Xa(this.canvas,r,o,!0)){const t=Us(s,a,this),r={type:e,property:i,args:t};n(this.canvas,r)}return u}}));s.push(u)}catch{const r=Da(t,i,{set(t){n(this.canvas,{type:e,property:i,args:[t],setter:!0})}});s.push(r)}return s}const Gs="KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpCiAgICAgICAgcmV0dXJuIHRyYW5zcGFyZW50QmxvYk1hcC5nZXQoaWQpOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIHRyYW5zcGFyZW50QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICAgIHJldHVybiBiYXNlNjQ7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gIiI7CiAgICB9CiAgfQogIGNvbnN0IHdvcmtlciA9IHNlbGY7CiAgd29ya2VyLm9ubWVzc2FnZSA9IGFzeW5jIGZ1bmN0aW9uKGUpIHsKICAgIGlmICgiT2Zmc2NyZWVuQ2FudmFzIiBpbiBnbG9iYWxUaGlzKSB7CiAgICAgIGNvbnN0IHsgaWQsIGJpdG1hcCwgd2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMgfSA9IGUuZGF0YTsKICAgICAgY29uc3QgdHJhbnNwYXJlbnRCYXNlNjQgPSBnZXRUcmFuc3BhcmVudEJsb2JGb3IoCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0LAogICAgICAgIGRhdGFVUkxPcHRpb25zCiAgICAgICk7CiAgICAgIGNvbnN0IG9mZnNjcmVlbiA9IG5ldyBPZmZzY3JlZW5DYW52YXMod2lkdGgsIGhlaWdodCk7CiAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCIyZCIpOwogICAgICBjdHguZHJhd0ltYWdlKGJpdG1hcCwgMCwgMCk7CiAgICAgIGJpdG1hcC5jbG9zZSgpOwogICAgICBjb25zdCBibG9iID0gYXdhaXQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOwogICAgICBjb25zdCB0eXBlID0gYmxvYi50eXBlOwogICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKTsKICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsKICAgICAgaWYgKCFsYXN0QmxvYk1hcC5oYXMoaWQpICYmIGF3YWl0IHRyYW5zcGFyZW50QmFzZTY0ID09PSBiYXNlNjQpIHsKICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICB9CiAgICAgIGlmIChsYXN0QmxvYk1hcC5nZXQoaWQpID09PSBiYXNlNjQpCiAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICB3b3JrZXIucG9zdE1lc3NhZ2UoewogICAgICAgIGlkLAogICAgICAgIHR5cGUsCiAgICAgICAgYmFzZTY0LAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodAogICAgICB9KTsKICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkOiBlLmRhdGEuaWQgfSk7CiAgICB9CiAgfTsKfSkoKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW1hZ2UtYml0bWFwLWRhdGEtdXJsLXdvcmtlci1CWjFyN1JKRC5qcy5tYXAK",Ws="undefined"!=typeof window&&window.Blob&&new Blob([(Xs=Gs,Uint8Array.from(atob(Xs),(t=>t.charCodeAt(0))))],{type:"text/javascript;charset=utf-8"});var Xs;function Hs(t){let e;try{if(e=Ws&&(window.URL||window.webkitURL).createObjectURL(Ws),!e)throw"";const n=new Worker(e,{name:null==t?void 0:t.name});return n.addEventListener("error",(()=>{(window.URL||window.webkitURL).revokeObjectURL(e)})),n}catch(e){return new Worker("data:text/javascript;base64,"+Gs,{name:null==t?void 0:t.name})}finally{e&&(window.URL||window.webkitURL).revokeObjectURL(e)}}class Vs{constructor(t){Ji(this,"pendingCanvasMutations",new Map),Ji(this,"rafStamps",{latestId:0,invokeId:null}),Ji(this,"mirror"),Ji(this,"mutationCb"),Ji(this,"resetObservers"),Ji(this,"frozen",!1),Ji(this,"locked",!1),Ji(this,"processMutation",((t,e)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(t)||this.pendingCanvasMutations.set(t,[]),this.pendingCanvasMutations.get(t).push(e)}));const{sampling:e="all",win:n,blockClass:r,blockSelector:o,recordCanvas:i,dataURLOptions:a}=t;this.mutationCb=t.mutationCb,this.mirror=t.mirror,i&&"all"===e&&this.initCanvasMutationObserver(n,r,o),i&&"number"==typeof e&&this.initCanvasFPSObserver(e,n,r,o,{dataURLOptions:a})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(t,e,n,r,o){const i=Fs(e,n,r,!0),a=new Map,s=new Hs;s.onmessage=t=>{const{id:e}=t.data;if(a.set(e,!1),!("base64"in t.data))return;const{base64:n,type:r,width:o,height:i}=t.data;this.mutationCb({id:e,type:os["2D"],commands:[{property:"clearRect",args:[0,0,o,i]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:n}],type:r}]},0,0]}]})};const u=1e3/t;let c,l=0;const d=t=>{l&&t-l<u||(l=t,(()=>{const t=[];return e.document.querySelectorAll("canvas").forEach((e=>{Xa(e,n,r,!0)||t.push(e)})),t})().forEach((async t=>{var e;const n=this.mirror.getId(t);if(a.get(n))return;if(0===t.width||0===t.height)return;if(a.set(n,!0),["webgl","webgl2"].includes(t.__context)){const n=t.getContext(t.__context);!1===(null==(e=null==n?void 0:n.getContextAttributes())?void 0:e.preserveDrawingBuffer)&&n.clear(n.COLOR_BUFFER_BIT)}const r=await createImageBitmap(t);s.postMessage({id:n,bitmap:r,width:t.width,height:t.height,dataURLOptions:o.dataURLOptions},[r])}))),c=requestAnimationFrame(d)};c=requestAnimationFrame(d),this.resetObservers=()=>{i(),cancelAnimationFrame(c)}}initCanvasMutationObserver(t,e,n){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const r=Fs(t,e,n,!1),o=function(t,e,n,r){const o=[],i=Object.getOwnPropertyNames(e.CanvasRenderingContext2D.prototype);for(const a of i)try{if("function"!=typeof e.CanvasRenderingContext2D.prototype[a])continue;const i=Ua(e.CanvasRenderingContext2D.prototype,a,(function(o){return function(...i){return Xa(this.canvas,n,r,!0)||setTimeout((()=>{const n=Us(i,e,this);t(this.canvas,{type:os["2D"],property:a,args:n})}),0),o.apply(this,i)}}));o.push(i)}catch{const n=Da(e.CanvasRenderingContext2D.prototype,a,{set(e){t(this.canvas,{type:os["2D"],property:a,args:[e],setter:!0})}});o.push(n)}return()=>{o.forEach((t=>t()))}}(this.processMutation.bind(this),t,e,n),i=function(t,e,n,r){const o=[];return o.push(...js(e.WebGLRenderingContext.prototype,os.WebGL,t,n,r,0,e)),void 0!==e.WebGL2RenderingContext&&o.push(...js(e.WebGL2RenderingContext.prototype,os.WebGL2,t,n,r,0,e)),()=>{o.forEach((t=>t()))}}(this.processMutation.bind(this),t,e,n,this.mirror);this.resetObservers=()=>{r(),o(),i()}}startPendingCanvasMutationFlusher(){requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}startRAFTimestamping(){const t=e=>{this.rafStamps.latestId=e,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach(((t,e)=>{const n=this.mirror.getId(e);this.flushPendingCanvasMutationFor(e,n)})),requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}flushPendingCanvasMutationFor(t,e){if(this.frozen||this.locked)return;const n=this.pendingCanvasMutations.get(t);if(!n||-1===e)return;const r=n.map((t=>{const{type:e,...n}=t;return n})),{type:o}=n[0];this.mutationCb({id:e,type:o,commands:r}),this.pendingCanvasMutations.delete(t)}}class Ys{constructor(t){Ji(this,"trackedLinkElements",new WeakSet),Ji(this,"mutationCb"),Ji(this,"adoptedStyleSheetCb"),Ji(this,"styleMirror",new Ja),this.mutationCb=t.mutationCb,this.adoptedStyleSheetCb=t.adoptedStyleSheetCb}attachLinkElement(t,e){"_cssText"in e.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:e.id,attributes:e.attributes}]}),this.trackLinkElement(t)}trackLinkElement(t){this.trackedLinkElements.has(t)||(this.trackedLinkElements.add(t),this.trackStylesheetInLinkElement(t))}adoptStyleSheets(t,e){if(0===t.length)return;const n={id:e,styleIds:[]},r=[];for(const e of t){let t;this.styleMirror.has(e)?t=this.styleMirror.getId(e):(t=this.styleMirror.add(e),r.push({styleId:t,rules:Array.from(e.rules||CSSRule,((t,e)=>({rule:ra(t),index:e})))})),n.styleIds.push(t)}r.length>0&&(n.styles=r),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(t){}}class zs{constructor(){Ji(this,"nodeMap",new WeakMap),Ji(this,"active",!1)}inOtherBuffer(t,e){const n=this.nodeMap.get(t);return n&&Array.from(n).some((t=>t!==e))}add(t,e){this.active||(this.active=!0,requestAnimationFrame((()=>{this.nodeMap=new WeakMap,this.active=!1}))),this.nodeMap.set(t,(this.nodeMap.get(t)||new Set).add(e))}destroy(){}}let Zs,Ks,Js,Qs=!1;try{if(2!==Array.from([1],(t=>2*t))[0]){const t=document.createElement("iframe");document.body.appendChild(t),Array.from=(null==(Di=t.contentWindow)?void 0:Di.Array.from)||Array.from,document.body.removeChild(t)}}catch(t){console.debug("Unable to override Array.from",t)}const qs=new oa;function $s(t={}){const{emit:e,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:o="rr-block",blockSelector:i=null,ignoreClass:a="rr-ignore",ignoreSelector:s=null,maskTextClass:u="rr-mask",maskTextSelector:c=null,inlineStylesheet:l=!0,maskAllInputs:d,maskInputOptions:p,slimDOMOptions:f,maskInputFn:h,maskTextFn:m,hooks:g,packFn:v,sampling:y={},dataURLOptions:E={},mousemoveWait:_,recordDOM:T=!0,recordCanvas:S=!1,recordCrossOriginIframes:b=!1,recordAfter:I=("DOMContentLoaded"===t.recordAfter?t.recordAfter:"load"),userTriggeredOnInput:C=!1,collectFonts:O=!1,inlineImages:R=!1,plugins:w,keepIframeSrcFn:A=()=>!1,ignoreCSSAttributes:L=new Set([]),errorHandler:N}=t;hs=N;const M=!b||window.parent===window;let x=!1;if(!M)try{window.parent.document&&(x=!1)}catch(t){x=!0}if(M&&!e)throw new Error("emit function is required");if(!M&&!x)return()=>{};void 0!==_&&void 0===y.mousemove&&(y.mousemove=_),qs.reset();const P=!0===d?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==p?p:{password:!0},k=!0===f||"all"===f?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===f,headMetaDescKeywords:"all"===f,headTitleMutations:"all"===f}:f||{};let D;!function(t=window){"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...t)=>{let e=t[0];if(!(0 in t))throw new TypeError("1 argument is required");do{if(this===e)return!0}while(e=e&&e.parentNode);return!1})}();let U=0;const B=t=>{for(const e of w||[])e.eventProcessor&&(t=e.eventProcessor(t));return v&&!x&&(t=v(t)),t};Zs=(t,o)=>{var i;const a=t;if(a.timestamp=Ba(),!(null==(i=gs[0])?void 0:i.isFrozen())||a.type===ts.FullSnapshot||a.type===ts.IncrementalSnapshot&&a.data.source===es.Mutation||gs.forEach((t=>t.unfreeze())),M)null==e||e(B(a),o);else if(x){const t={type:"rrweb",event:B(a),origin:window.location.origin,isCheckout:o};window.parent.postMessage(t,"*")}if(a.type===ts.FullSnapshot)D=a,U=0;else if(a.type===ts.IncrementalSnapshot){if(a.data.source===es.Mutation&&a.data.isAttachIframe)return;U++;const t=r&&U>=r,e=n&&a.timestamp-D.timestamp>n;(t||e)&&Ks(!0)}};const F=t=>{Zs({type:ts.IncrementalSnapshot,data:{source:es.Mutation,...t}})},j=t=>Zs({type:ts.IncrementalSnapshot,data:{source:es.Scroll,...t}}),G=t=>Zs({type:ts.IncrementalSnapshot,data:{source:es.CanvasMutation,...t}}),W=new Ys({mutationCb:F,adoptedStyleSheetCb:t=>Zs({type:ts.IncrementalSnapshot,data:{source:es.AdoptedStyleSheet,...t}})}),X=new As({mirror:qs,mutationCb:F,stylesheetManager:W,recordCrossOriginIframes:b,wrappedEmit:Zs});for(const t of w||[])t.getMirror&&t.getMirror({nodeMirror:qs,crossOriginIframeMirror:X.crossOriginIframeMirror,crossOriginIframeStyleMirror:X.crossOriginIframeStyleMirror});const H=new zs;Js=new Vs({recordCanvas:S,mutationCb:G,win:window,blockClass:o,blockSelector:i,mirror:qs,sampling:y.canvas,dataURLOptions:E});const V=new Ls({mutationCb:F,scrollCb:j,bypassOptions:{blockClass:o,blockSelector:i,maskTextClass:u,maskTextSelector:c,inlineStylesheet:l,maskInputOptions:P,dataURLOptions:E,maskTextFn:m,maskInputFn:h,recordCanvas:S,inlineImages:R,sampling:y,slimDOMOptions:k,iframeManager:X,stylesheetManager:W,canvasManager:Js,keepIframeSrcFn:A,processedNodeManager:H},mirror:qs});Ks=(t=!1)=>{if(!T)return;Zs({type:ts.Meta,data:{href:window.location.href,width:Ga(),height:ja()}},t),W.reset(),V.init(),gs.forEach((t=>t.lock()));const e=function(t,e){const{mirror:n=new oa,blockClass:r="rr-block",blockSelector:o=null,maskTextClass:i="rr-mask",maskTextSelector:a=null,inlineStylesheet:s=!0,inlineImages:u=!1,recordCanvas:c=!1,maskAllInputs:l=!1,maskTextFn:d,maskInputFn:p,slimDOM:f=!1,dataURLOptions:h,preserveWhiteSpace:m,onSerialize:g,onIframeLoad:v,iframeLoadTimeout:y,onStylesheetLoad:E,stylesheetLoadTimeout:_,keepIframeSrcFn:T=()=>!1}=e||{};return La(t,{doc:t,mirror:n,blockClass:r,blockSelector:o,maskTextClass:i,maskTextSelector:a,skipChild:!1,inlineStylesheet:s,maskInputOptions:!0===l?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===l?{password:!0}:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:!0===f||"all"===f?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===f,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===f?{}:f,dataURLOptions:h,inlineImages:u,recordCanvas:c,preserveWhiteSpace:m,onSerialize:g,onIframeLoad:v,iframeLoadTimeout:y,onStylesheetLoad:E,stylesheetLoadTimeout:_,keepIframeSrcFn:T,newlyAddedElement:!1})}(document,{mirror:qs,blockClass:o,blockSelector:i,maskTextClass:u,maskTextSelector:c,inlineStylesheet:l,maskAllInputs:P,maskTextFn:m,slimDOM:k,dataURLOptions:E,recordCanvas:S,inlineImages:R,onSerialize:t=>{za(t,qs)&&X.addIframe(t),Za(t,qs)&&W.trackLinkElement(t),Ka(t)&&V.addShadowRoot(t.shadowRoot,document)},onIframeLoad:(t,e)=>{X.attachIframe(t,e),V.observeAttachShadow(t)},onStylesheetLoad:(t,e)=>{W.attachLinkElement(t,e)},keepIframeSrcFn:A});if(!e)return console.warn("Failed to snapshot the document");Zs({type:ts.FullSnapshot,data:{node:e,initialOffset:Fa(window)}},t),gs.forEach((t=>t.unlock())),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&W.adoptStyleSheets(document.adoptedStyleSheets,qs.getId(document))};try{const t=[],e=t=>{var e;return ms(Cs)({mutationCb:F,mousemoveCb:(t,e)=>Zs({type:ts.IncrementalSnapshot,data:{source:e,positions:t}}),mouseInteractionCb:t=>Zs({type:ts.IncrementalSnapshot,data:{source:es.MouseInteraction,...t}}),scrollCb:j,viewportResizeCb:t=>Zs({type:ts.IncrementalSnapshot,data:{source:es.ViewportResize,...t}}),inputCb:t=>Zs({type:ts.IncrementalSnapshot,data:{source:es.Input,...t}}),mediaInteractionCb:t=>Zs({type:ts.IncrementalSnapshot,data:{source:es.MediaInteraction,...t}}),styleSheetRuleCb:t=>Zs({type:ts.IncrementalSnapshot,data:{source:es.StyleSheetRule,...t}}),styleDeclarationCb:t=>Zs({type:ts.IncrementalSnapshot,data:{source:es.StyleDeclaration,...t}}),canvasMutationCb:G,fontCb:t=>Zs({type:ts.IncrementalSnapshot,data:{source:es.Font,...t}}),selectionCb:t=>{Zs({type:ts.IncrementalSnapshot,data:{source:es.Selection,...t}})},customElementCb:t=>{Zs({type:ts.IncrementalSnapshot,data:{source:es.CustomElement,...t}})},blockClass:o,ignoreClass:a,ignoreSelector:s,maskTextClass:u,maskTextSelector:c,maskInputOptions:P,inlineStylesheet:l,sampling:y,recordDOM:T,recordCanvas:S,inlineImages:R,userTriggeredOnInput:C,collectFonts:O,doc:t,maskInputFn:h,maskTextFn:m,keepIframeSrcFn:A,blockSelector:i,slimDOMOptions:k,dataURLOptions:E,mirror:qs,iframeManager:X,stylesheetManager:W,shadowDomManager:V,processedNodeManager:H,canvasManager:Js,ignoreCSSAttributes:L,plugins:(null==(e=null==w?void 0:w.filter((t=>t.observer)))?void 0:e.map((t=>({observer:t.observer,options:t.options,callback:e=>Zs({type:ts.Plugin,data:{plugin:t.name,payload:e}})}))))||[]},g)};X.addLoadListener((n=>{try{t.push(e(n.contentDocument))}catch(t){console.warn(t)}}));const n=()=>{Ks(),t.push(e(document)),Qs=!0};return"interactive"===document.readyState||"complete"===document.readyState?n():(t.push(Ma("DOMContentLoaded",(()=>{Zs({type:ts.DomContentLoaded,data:{}}),"DOMContentLoaded"===I&&n()}))),t.push(Ma("load",(()=>{Zs({type:ts.Load,data:{}}),"load"===I&&n()}),window))),()=>{t.forEach((t=>t())),H.destroy(),Qs=!1,hs=void 0}}catch(t){console.warn(t)}}var tu,eu;$s.addCustomEvent=(t,e)=>{if(!Qs)throw new Error("please add custom event after start recording");Zs({type:ts.Custom,data:{tag:t,payload:e}})},$s.freezePage=()=>{gs.forEach((t=>t.freeze()))},$s.takeFullSnapshot=t=>{if(!Qs)throw new Error("please take full snapshot after start recording");Ks(t)},$s.mirror=qs,Object.defineProperty,Object.defineProperty,Symbol.toStringTag,(eu=tu||(tu={}))[eu.NotStarted=0]="NotStarted",eu[eu.Running=1]="Running",eu[eu.Stopped=2]="Stopped";const{addCustomEvent:nu}=$s,{freezePage:ru}=$s;var ou,iu=Object.defineProperty,au=(t,e,n)=>(((t,e,n)=>{e in t?iu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n),su=Object.defineProperty,uu=(t,e,n)=>(((t,e,n)=>{e in t?su(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n),cu=Object.defineProperty,lu=(t,e,n)=>(((t,e,n)=>{e in t?cu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);function du(t,e,n){if(!t)return!1;if(t.nodeType!==t.ELEMENT_NODE)return!!n&&du(t.parentNode,e,n);for(let n=t.classList.length;n--;){const r=t.classList[n];if(e.test(r))return!0}return!!n&&du(t.parentNode,e,n)}const pu="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let fu={map:{},getId:()=>(console.error(pu),-1),getNode:()=>(console.error(pu),null),removeNodeFromMap(){console.error(pu)},has:()=>(console.error(pu),!1),reset(){console.error(pu)}};"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(fu=new Proxy(fu,{get:(t,e,n)=>("map"===e&&console.error(pu),Reflect.get(t,e,n))}));let hu=Date.now;function mu(t){return t?t.nodeType===t.ELEMENT_NODE?t:t.parentElement:null}function gu(t){var e,n;let r=null;return(null==(n=null==(e=t.getRootNode)?void 0:e.call(t))?void 0:n.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&t.getRootNode().host&&(r=t.getRootNode().host),r}function vu(t){let e,n=t;for(;e=gu(n);)n=e;return n}function yu(t){const e=t.ownerDocument;if(!e)return!1;const n=vu(t);return e.contains(n)}/[1-9][0-9]{12}/.test(Date.now().toString())||(hu=()=>(new Date).getTime());const Eu=Object.freeze(Object.defineProperty({__proto__:null,StyleSheetMirror:class{constructor(){uu(this,"id",1),uu(this,"styleIDMap",new WeakMap),uu(this,"idStyleMap",new Map)}getId(t){return this.styleIDMap.get(t)??-1}has(t){return this.styleIDMap.has(t)}add(t,e){if(this.has(t))return this.getId(t);let n;return n=void 0===e?this.id++:e,this.styleIDMap.set(t,n),this.idStyleMap.set(n,t),n}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}},get _mirror(){return fu},closestElementOfNode:mu,getBaseDimension:function t(e,n){var r,o;const i=null==(o=null==(r=e.ownerDocument)?void 0:r.defaultView)?void 0:o.frameElement;if(!i||i===n)return{x:0,y:0,relativeScale:1,absoluteScale:1};const a=i.getBoundingClientRect(),s=t(i,n),u=a.height/i.clientHeight;return{x:a.x*s.relativeScale+s.x,y:a.y*s.relativeScale+s.y,relativeScale:u,absoluteScale:s.absoluteScale*u}},getNestedRule:function t(e,n){const r=e[n[0]];return 1===n.length?r:t(r.cssRules[n[1]].cssRules,n.slice(2))},getPositionsAndIndex:function(t){const e=[...t],n=e.pop();return{positions:e,index:n}},getRootShadowHost:vu,getShadowHost:gu,getWindowHeight:function(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight},getWindowScroll:function(t){var e,n,r,o,i,a;const s=t.document;return{left:s.scrollingElement?s.scrollingElement.scrollLeft:void 0!==t.pageXOffset?t.pageXOffset:(null==s?void 0:s.documentElement.scrollLeft)||(null==(n=null==(e=null==s?void 0:s.body)?void 0:e.parentElement)?void 0:n.scrollLeft)||(null==(r=null==s?void 0:s.body)?void 0:r.scrollLeft)||0,top:s.scrollingElement?s.scrollingElement.scrollTop:void 0!==t.pageYOffset?t.pageYOffset:(null==s?void 0:s.documentElement.scrollTop)||(null==(i=null==(o=null==s?void 0:s.body)?void 0:o.parentElement)?void 0:i.scrollTop)||(null==(a=null==s?void 0:s.body)?void 0:a.scrollTop)||0}},getWindowWidth:function(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth},hasShadowRoot:function(t){return Boolean(null==t?void 0:t.shadowRoot)},hookSetter:function t(e,n,r,o,i=window){const a=i.Object.getOwnPropertyDescriptor(e,n);return i.Object.defineProperty(e,n,o?r:{set(t){setTimeout((()=>{r.set.call(this,t)}),0),a&&a.set&&a.set.call(this,t)}}),()=>t(e,n,a||{},!0)},inDom:function(t){const e=t.ownerDocument;return!!e&&(e.contains(t)||yu(t))},isAncestorRemoved:function t(e,n){if(function(t){const e=null==t?void 0:t.host;return Boolean((null==e?void 0:e.shadowRoot)===t)}(e))return!1;const r=n.getId(e);return!n.has(r)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||t(e.parentNode,n))},isBlocked:function(t,e,n,r){if(!t)return!1;const o=mu(t);if(!o)return!1;try{if("string"==typeof e){if(o.classList.contains(e))return!0;if(r&&null!==o.closest("."+e))return!0}else if(du(o,e,r))return!0}catch(t){}if(n){if(o.matches(n))return!0;if(r&&null!==o.closest(n))return!0}return!1},isIgnored:function(t,e,n){return!("TITLE"!==t.tagName||!n.headTitleMutations)||-2===e.getId(t)},isSerialized:function(t,e){return-1!==e.getId(t)},isSerializedIframe:function(t,e){return Boolean("IFRAME"===t.nodeName&&e.getMeta(t))},isSerializedStylesheet:function(t,e){return Boolean("LINK"===t.nodeName&&t.nodeType===t.ELEMENT_NODE&&t.getAttribute&&"stylesheet"===t.getAttribute("rel")&&e.getMeta(t))},iterateResolveTree:function t(e,n){n(e.value);for(let r=e.children.length-1;r>=0;r--)t(e.children[r],n)},legacy_isTouchEvent:function(t){return Boolean(t.changedTouches)},get nowTimestamp(){return hu},on:function(t,e,n=document){const r={capture:!0,passive:!0};return n.addEventListener(t,e,r),()=>n.removeEventListener(t,e,r)},patch:function(t,e,n){try{if(!(e in t))return()=>{};const r=t[e],o=n(r);return"function"==typeof o&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:r}})),t[e]=o,()=>{t[e]=r}}catch{return()=>{}}},polyfill:function(t=window){"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...t)=>{let e=t[0];if(!(0 in t))throw new TypeError("1 argument is required");do{if(this===e)return!0}while(e=e&&e.parentNode);return!1})},queueToResolveTrees:function(t){const e={},n=(t,n)=>{const r={value:t,parent:n,children:[]};return e[t.node.id]=r,r},r=[];for(const o of t){const{nextId:t,parentId:i}=o;if(t&&t in e){const i=e[t];if(i.parent){const t=i.parent.children.indexOf(i);i.parent.children.splice(t,0,n(o,i.parent))}else{const t=r.indexOf(i);r.splice(t,0,n(o,null))}}else if(i in e){const t=e[i];t.children.push(n(o,t))}else r.push(n(o,null))}return r},shadowHostInDom:yu,throttle:function(t,e,n={}){let r=null,o=0;return function(...i){const a=Date.now();o||!1!==n.leading||(o=a);const s=e-(a-o),u=this;s<=0||s>e?(r&&(clearTimeout(r),r=null),o=a,t.apply(u,i)):r||!1===n.trailing||(r=setTimeout((()=>{o=!1===n.leading?0:Date.now(),r=null,t.apply(u,i)}),s))}},uniqueTextMutations:function(t){const e=new Set,n=[];for(let r=t.length;r--;){const o=t[r];e.has(o.id)||(n.push(o),e.add(o.id))}return n}},Symbol.toStringTag,{value:"Module"}));for(var _u="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Tu=0;Tu<64;Tu++)_u["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(Tu)]=Tu;"undefined"!=typeof window&&window.Blob&&new Blob([Uint8Array.from(atob("KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpCiAgICAgICAgcmV0dXJuIHRyYW5zcGFyZW50QmxvYk1hcC5nZXQoaWQpOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIHRyYW5zcGFyZW50QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICAgIHJldHVybiBiYXNlNjQ7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gIiI7CiAgICB9CiAgfQogIGNvbnN0IHdvcmtlciA9IHNlbGY7CiAgd29ya2VyLm9ubWVzc2FnZSA9IGFzeW5jIGZ1bmN0aW9uKGUpIHsKICAgIGlmICgiT2Zmc2NyZWVuQ2FudmFzIiBpbiBnbG9iYWxUaGlzKSB7CiAgICAgIGNvbnN0IHsgaWQsIGJpdG1hcCwgd2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMgfSA9IGUuZGF0YTsKICAgICAgY29uc3QgdHJhbnNwYXJlbnRCYXNlNjQgPSBnZXRUcmFuc3BhcmVudEJsb2JGb3IoCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0LAogICAgICAgIGRhdGFVUkxPcHRpb25zCiAgICAgICk7CiAgICAgIGNvbnN0IG9mZnNjcmVlbiA9IG5ldyBPZmZzY3JlZW5DYW52YXMod2lkdGgsIGhlaWdodCk7CiAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCIyZCIpOwogICAgICBjdHguZHJhd0ltYWdlKGJpdG1hcCwgMCwgMCk7CiAgICAgIGJpdG1hcC5jbG9zZSgpOwogICAgICBjb25zdCBibG9iID0gYXdhaXQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOwogICAgICBjb25zdCB0eXBlID0gYmxvYi50eXBlOwogICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKTsKICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsKICAgICAgaWYgKCFsYXN0QmxvYk1hcC5oYXMoaWQpICYmIGF3YWl0IHRyYW5zcGFyZW50QmFzZTY0ID09PSBiYXNlNjQpIHsKICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICB9CiAgICAgIGlmIChsYXN0QmxvYk1hcC5nZXQoaWQpID09PSBiYXNlNjQpCiAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICB3b3JrZXIucG9zdE1lc3NhZ2UoewogICAgICAgIGlkLAogICAgICAgIHR5cGUsCiAgICAgICAgYmFzZTY0LAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodAogICAgICB9KTsKICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkOiBlLmRhdGEuaWQgfSk7CiAgICB9CiAgfTsKfSkoKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW1hZ2UtYml0bWFwLWRhdGEtdXJsLXdvcmtlci1CWjFyN1JKRC5qcy5tYXAK"),(t=>t.charCodeAt(0)))],{type:"text/javascript;charset=utf-8"});try{if(2!==Array.from([1],(t=>2*t))[0]){const t=document.createElement("iframe");document.body.appendChild(t),Array.from=(null==(ou=t.contentWindow)?void 0:ou.Array.from)||Array.from,document.body.removeChild(t)}}catch(t){console.debug("Unable to override Array.from",t)}var Su;new class{constructor(){lu(this,"idNodeMap",new Map),lu(this,"nodeMetaMap",new WeakMap)}getId(t){var e;return t?(null==(e=this.getMeta(t))?void 0:e.id)??-1:-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const e=this.getId(t);this.idNodeMap.delete(e),t.childNodes&&t.childNodes.forEach((t=>this.removeNodeFromMap(t)))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,e){const n=e.id;this.idNodeMap.set(n,t),this.nodeMetaMap.set(t,e)}replace(t,e){const n=this.getNode(t);if(n){const t=this.nodeMetaMap.get(n);t&&this.nodeMetaMap.set(e,t)}this.idNodeMap.set(t,e)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}},function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"}(Su||(Su={}));class bu{constructor(t){au(this,"fileName"),au(this,"functionName"),au(this,"lineNumber"),au(this,"columnNumber"),this.fileName=t.fileName||"",this.functionName=t.functionName||"",this.lineNumber=t.lineNumber,this.columnNumber=t.columnNumber}toString(){const t=this.lineNumber||"",e=this.columnNumber||"";return this.functionName?`${this.functionName} (${this.fileName}:${t}:${e})`:`${this.fileName}:${t}:${e}`}}const Iu=/(^|@)\S+:\d+/,Cu=/^\s*at .*(\S+:\d+|\(native\))/m,Ou=/^(eval@)?(\[native code])?$/,Ru={parse:function(t){return t?void 0!==t.stacktrace||void 0!==t["opera#sourceloc"]?this.parseOpera(t):t.stack&&t.stack.match(Cu)?this.parseV8OrIE(t):t.stack?this.parseFFOrSafari(t):(console.warn("[console-record-plugin]: Failed to parse error object:",t),[]):[]},extractLocation:function(t){if(-1===t.indexOf(":"))return[t];const e=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(t.replace(/[()]/g,""));if(!e)throw new Error(`Cannot parse given url: ${t}`);return[e[1],e[2]||void 0,e[3]||void 0]},parseV8OrIE:function(t){return t.stack.split("\n").filter((function(t){return!!t.match(Cu)}),this).map((function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));let e=t.replace(/^\s+/,"").replace(/\(eval code/g,"(");const n=e.match(/ (\((.+):(\d+):(\d+)\)$)/);e=n?e.replace(n[0],""):e;const r=e.split(/\s+/).slice(1),o=this.extractLocation(n?n[1]:r.pop()),i=r.join(" ")||void 0,a=["eval","<anonymous>"].indexOf(o[0])>-1?void 0:o[0];return new bu({functionName:i,fileName:a,lineNumber:o[1],columnNumber:o[2]})}),this)},parseFFOrSafari:function(t){return t.stack.split("\n").filter((function(t){return!t.match(Ou)}),this).map((function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===t.indexOf("@")&&-1===t.indexOf(":"))return new bu({functionName:t});{const e=/((.*".+"[^@]*)?[^@]*)(?:@)/,n=t.match(e),r=n&&n[1]?n[1]:void 0,o=this.extractLocation(t.replace(e,""));return new bu({functionName:r,fileName:o[0],lineNumber:o[1],columnNumber:o[2]})}}),this)},parseOpera:function(t){return!t.stacktrace||t.message.indexOf("\n")>-1&&t.message.split("\n").length>t.stacktrace.split("\n").length?this.parseOpera9(t):t.stack?this.parseOpera11(t):this.parseOpera10(t)},parseOpera9:function(t){const e=/Line (\d+).*script (?:in )?(\S+)/i,n=t.message.split("\n"),r=[];for(let t=2,o=n.length;t<o;t+=2){const o=e.exec(n[t]);o&&r.push(new bu({fileName:o[2],lineNumber:parseFloat(o[1])}))}return r},parseOpera10:function(t){const e=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=t.stacktrace.split("\n"),r=[];for(let t=0,o=n.length;t<o;t+=2){const o=e.exec(n[t]);o&&r.push(new bu({functionName:o[3]||void 0,fileName:o[2],lineNumber:parseFloat(o[1])}))}return r},parseOpera11:function(t){return t.stack.split("\n").filter((function(t){return!!t.match(Iu)&&!t.match(/^Error created at/)}),this).map((function(t){const e=t.split("@"),n=this.extractLocation(e.pop()),r=(e.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new bu({functionName:r,fileName:n[0],lineNumber:n[1],columnNumber:n[2]})}),this)}};function wu(t){if(!t||!t.outerHTML)return"";let e="";for(;t.parentElement;){let n=t.localName;if(!n)break;n=n.toLowerCase();const r=t.parentElement,o=[];if(r.children&&r.children.length>0)for(let t=0;t<r.children.length;t++){const e=r.children[t];e.localName&&e.localName.toLowerCase&&e.localName.toLowerCase()===n&&o.push(e)}o.length>1&&(n+=`:eq(${o.indexOf(t)})`),e=n+(e?">"+e:""),t=r}return e}function Au(t){return"[object Object]"===Object.prototype.toString.call(t)}function Lu(t,e){if(0===e)return!0;const n=Object.keys(t);for(const r of n)if(Au(t[r])&&Lu(t[r],e-1))return!0;return!1}function Nu(t,e){const n={numOfKeysLimit:50,depthOfLimit:4};Object.assign(n,e);const r=[],o=[];return JSON.stringify(t,(function(t,e){if(r.length>0){const n=r.indexOf(this);~n?r.splice(n+1):r.push(this),~n?o.splice(n,1/0,t):o.push(t),~r.indexOf(e)&&(e=r[0]===e?"[Circular ~]":"[Circular ~."+o.slice(0,r.indexOf(e)).join(".")+"]")}else r.push(e);if(null===e)return e;if(void 0===e)return"undefined";if(Au(i=e)&&Object.keys(i).length>n.numOfKeysLimit||"function"==typeof i||Au(i)&&Lu(i,n.depthOfLimit))return function(t){let e=t.toString();return n.stringLengthLimit&&e.length>n.stringLengthLimit&&(e=`${e.slice(0,n.stringLengthLimit)}...`),e}(e);var i;if("bigint"==typeof e)return e.toString()+"n";if(e instanceof Event){const t={};for(const n in e){const r=e[n];Array.isArray(r)?t[n]=wu(r.length?r[0]:null):t[n]=r}return t}return e instanceof Node?e instanceof HTMLElement?e?e.outerHTML:"":e.nodeName:e instanceof Error?e.stack?e.stack+"\nEnd of stack for Error object":e.name+": "+e.message:e}))}const Mu={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:"console"};function xu(t,e,n){const r=n?Object.assign({},Mu,n):Mu,o=r.logger;if(!o)return()=>{};let i;i="string"==typeof o?e[o]:o;let a=0,s=!1;const u=[];if(r.level.includes("error")){const n=e=>{const n=e.message,o=e.error,i=Ru.parse(o).map((t=>t.toString())),a=[Nu(n,r.stringifyOptions)];t({level:"error",trace:i,payload:a})};e.addEventListener("error",n),u.push((()=>{e.removeEventListener("error",n)}));const o=e=>{let n,o;e.reason instanceof Error?(n=e.reason,o=[Nu(`Uncaught (in promise) ${n.name}: ${n.message}`,r.stringifyOptions)]):(n=new Error,o=[Nu("Uncaught (in promise)",r.stringifyOptions),Nu(e.reason,r.stringifyOptions)]);const i=Ru.parse(n).map((t=>t.toString()));t({level:"error",trace:i,payload:o})};e.addEventListener("unhandledrejection",o),u.push((()=>{e.removeEventListener("unhandledrejection",o)}))}for(const t of r.level)u.push(c(i,t));return()=>{u.forEach((t=>t()))};function c(e,n){return e[n]?Eu.patch(e,n,(e=>(...o)=>{if(e.apply(this,o),!s){s=!0;try{const e=Ru.parse(new Error).map((t=>t.toString())).splice(1),i=o.map((t=>Nu(t,r.stringifyOptions)));a++,a<r.lengthThreshold?t({level:n,trace:e,payload:i}):a===r.lengthThreshold&&t({level:"warn",trace:[],payload:[Nu("The number of log records reached the threshold.")]})}catch(t){e("rrweb logger error:",t,...o)}finally{s=!1}}})):()=>{}}}var Pu=w("OpenTelemetry Context Key B3 Debug Flag"),ku="b3",Du="x-b3-traceid",Uu="x-b3-spanid",Bu="x-b3-sampled",Fu="x-b3-flags",ju=new Set([!0,"true","True","1",1]),Gu=new Set([!1,"false","False","0",0]);function Wu(t,e,n){return r=e.get(t,n),Array.isArray(r)?r[0]:r;var r}function Xu(t,e){return"1"===Wu(t,e,Fu)?"1":void 0}var Hu,Vu=function(){function t(){}return t.prototype.inject=function(t,e,n){var r=qt.getSpanContext(t);if(r&&Xt(r)&&!tt(t)){var o=t.getValue(Pu);n.set(e,Du,r.traceId),n.set(e,Uu,r.spanId),"1"===o?n.set(e,Fu,o):void 0!==r.traceFlags&&n.set(e,Bu,(C.SAMPLED&r.traceFlags)===C.SAMPLED?"1":"0")}},t.prototype.extract=function(t,e,n){var r,o=function(t,e){var n=Wu(t,e,Du);return"string"==typeof n?n.padStart(32,"0"):""}(e,n),i=function(t,e){var n=Wu(t,e,Uu);return"string"==typeof n?n:""}(e,n),a=function(t,e){var n=Wu(t,e,Bu);return"1"===Xu(t,e)||ju.has(n)?C.SAMPLED:void 0===n||Gu.has(n)?C.NONE:void 0}(e,n),s=Xu(e,n);return Gt(o)&&Wt(i)&&((r=a)===C.SAMPLED||r===C.NONE)?(t=t.setValue(Pu,s),qt.setSpanContext(t,{traceId:o,spanId:i,isRemote:!0,traceFlags:a})):t},t.prototype.fields=function(){return[Du,Uu,Fu,Bu,"x-b3-parentspanid"]},t}(),Yu=/((?:[0-9a-f]{16}){1,2})-([0-9a-f]{16})(?:-([01d](?![0-9a-f])))?(?:-([0-9a-f]{16}))?/,zu="0".repeat(16),Zu=new Set(["d","1"]),Ku=function(){function t(){}return t.prototype.inject=function(t,e,n){var r=qt.getSpanContext(t);if(r&&Xt(r)&&!tt(t)){var o=t.getValue(Pu)||1&r.traceFlags,i=r.traceId+"-"+r.spanId+"-"+o;n.set(e,ku,i)}},t.prototype.extract=function(t,e,n){var r=n.get(e,ku),o=Array.isArray(r)?r[0]:r;if("string"!=typeof o)return t;var i=o.match(Yu);if(!i)return t;var a=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(i,4),s=a[1],u=a[2],c=a[3],l=function(t){return 32===t.length?t:""+zu+t}(s);if(!Gt(l)||!Wt(u))return t;var d=function(t){return t&&Zu.has(t)?C.SAMPLED:C.NONE}(c);return"d"===c&&(t=t.setValue(Pu,c)),qt.setSpanContext(t,{traceId:l,spanId:u,isRemote:!0,traceFlags:d})},t.prototype.fields=function(){return[ku]},t}();!function(t){t[t.SINGLE_HEADER=0]="SINGLE_HEADER",t[t.MULTI_HEADER=1]="MULTI_HEADER"}(Hu||(Hu={}));var Ju=function(){function t(t){void 0===t&&(t={}),this._b3MultiPropagator=new Vu,this._b3SinglePropagator=new Ku,t.injectEncoding===Hu.MULTI_HEADER?(this._inject=this._b3MultiPropagator.inject,this._fields=this._b3MultiPropagator.fields()):(this._inject=this._b3SinglePropagator.inject,this._fields=this._b3SinglePropagator.fields())}return t.prototype.inject=function(t,e,n){tt(t)||this._inject(t,e,n)},t.prototype.extract=function(t,e,n){var r=n.get(e,ku);return(Array.isArray(r)?r[0]:r)?this._b3SinglePropagator.extract(t,e,n):this._b3MultiPropagator.extract(t,e,n)},t.prototype.fields=function(){return this._fields},t}(),Qu="x-amzn-trace-id",qu=function(){function t(){}return t.prototype.inject=function(t,e,n){var r,o=null===(r=qt.getSpan(t))||void 0===r?void 0:r.spanContext();if(o&&Xt(o)){var i=o.traceId,a="Root=1-"+i.substring(0,8)+"-"+i.substring(8)+";Parent="+o.spanId+";Sampled="+((C.SAMPLED&o.traceFlags)===C.SAMPLED?"1":"0");n.set(e,Qu,a)}},t.prototype.extract=function(t,e,n){var r=this.getSpanContextFromHeader(e,n);return Xt(r)?qt.setSpan(t,qt.wrapSpanContext(r)):t},t.prototype.fields=function(){return[Qu]},t.prototype.getSpanContextFromHeader=function(e,n){var r=n.keys(e).find((function(t){return t.toLowerCase()===Qu}));if(!r)return Lt;var o=n.get(e,r);if(!o||"string"!=typeof o)return Lt;for(var i,a=0,s=At,u=wt,c=null;a<o.length;){var l=o.indexOf(";",a);l>=0?(i=o.substring(a,l).trim(),a=l+1):(i=o.substring(a).trim(),a=o.length);var d=i.indexOf("="),p=i.substring(d+1);i.startsWith("Root")?s=t._parseTraceId(p):i.startsWith("Parent")?u=t._parseSpanId(p):i.startsWith("Sampled")&&(c=t._parseTraceFlag(p))}if(null===c)return Lt;var f={traceId:s,spanId:u,traceFlags:c,isRemote:!0};return Xt(f)?f:Lt},t._parseTraceId=function(t){if(35!==t.length)return At;if(!t.startsWith("1"))return At;if("-"!==t.charAt(1)||"-"!==t.charAt(10))return At;var e=t.substring(2,10)+t.substring(11,35);return Gt(e)?e:At},t._parseSpanId=function(t){return Wt(t)?t:wt},t._parseTraceFlag=function(t){return"0"===t?C.NONE:"1"===t?C.SAMPLED:null},t}();function $u(t){return"string"==typeof t}function tc(t){return t?(+t^16*Math.random()>>+t/4).toString(16):"".concat(1e7,"-").concat(1e3,"-").concat(4e3,"-").concat(8e3,"-").concat(1e11).replace(/[018]/g,tc)}function ec(t){return"function"==typeof t}var nc=console.error.bind(console);function rc(t,e,n){var r=!!t[e]&&t.propertyIsEnumerable(e);Object.defineProperty(t,e,{configurable:!0,enumerable:r,writable:!0,value:n})}function oc(t){t&&t.logger&&(ec(t.logger)?nc=t.logger:nc("new logger isn't a function, not replacing"))}function ic(t,e,n){if(t&&t[e]){if(!n)return nc("no wrapper function"),void nc((new Error).stack);if(ec(t[e])&&ec(n)){var r=t[e],o=n(r,e);return rc(o,"__original",r),rc(o,"__unwrap",(function(){t[e]===o&&rc(t,e,r)})),rc(o,"__wrapped",!0),rc(t,e,o),o}nc("original object and wrapper must be functions")}else nc("no original function "+e+" to wrap")}function ac(t,e){return t&&t[e]?t[e].__unwrap?t[e].__unwrap():void nc("no original to unwrap to -- has "+e+" already been unwrapped?"):(nc("no function to unwrap."),void nc((new Error).stack))}oc.wrap=ic,oc.massWrap=function(t,e,n){if(!t)return nc("must provide one or more modules to patch"),void nc((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach((function(t){e.forEach((function(e){ic(t,e,n)}))})):nc("must provide one or more functions to wrap on modules")},oc.unwrap=ac,oc.massUnwrap=function(t,e){if(!t)return nc("must provide one or more modules to patch"),void nc((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach((function(t){e.forEach((function(e){ac(t,e)}))})):nc("must provide one or more functions to unwrap on modules")};var sc,uc,cc,lc,dc,pc=oc;!function(t){t.ERROR="error",t.NETWORK_REQUEST="network-request",t.LOG="log",t.USER_INTERACTION="user-interaction",t.WEB_VITALS="web-vitals",t.LONG_TASK="longtask",t.RESOURCES="resources",t.INTERNAL="internal",t.DOM="dom",t.CUSTOM_MEASUREMENT="custom-measurement",t.MEMORY_USAGE="memory-usage",t.SCREENSHOT="screenshot",t.CUSTOM_SPAN="custom-span"}(sc||(sc={})),function(t){t.Resource="resource",t.LongTask="longtask",t.Navigation="navigation",t.SoftNavigation="soft-navigation"}(uc||(uc={})),function(t){t.METHOD="http.method",t.URL="http.url",t.STATUS_CODE="http.status_code",t.HOST="http.host",t.SCHEME="http.scheme",t.STATUS_TEXT="http.status_text",t.RESPONSE_CONTENT_LENGTH="http.response_content_length"}(cc||(cc={})),function(t){t.PAGE="page",t.NETWORK_REQUEST="network_request"}(lc||(lc={})),function(t){t[t.Debug=1]="Debug",t[t.Verbose=2]="Verbose",t[t.Info=3]="Info",t[t.Warn=4]="Warn",t[t.Error=5]="Error",t[t.Critical=6]="Critical"}(dc||(dc={}));function fc(){return(new Date).getTime()}var hc={"Content-Encoding":"gzip"},mc=1e3,gc="rum_session",vc="rum_prev_session",yc={sessionSampleRate:100,onlyWithErrorConfig:{enable:!1}},Ec="rumSessionManager",_c="rumSessionRecorder",Tc="rumSessionRecorderSegmentsMap",Sc="rumSnapshotManager",bc={errorCount:0,viewCount:0,actionCount:0,hasRecording:!1,hasScreenshot:!1};function Ic(){if("object"==typeof globalThis)return globalThis;Object.defineProperty(Object.prototype,"__cx_global__",{get:function(){return this},configurable:!0});var t=__cx_global__;return delete Object.prototype.__cx_global__,"object"!=typeof t&&(t="object"==typeof self?self:"object"==typeof window?window:{}),t}var Cc=Ic();function Oc(){return Cc[Sc]}function Rc(){return Cc[Ec]}function wc(){return Cc[_c]}function Ac(){return Cc[Rd]}var Lc="__globalSpan__",Nc="__customTracer__",Mc="__customTracerIgnoredInstruments__";function xc(){return Cc[Lc]}function Pc(){delete Cc[Lc]}function kc(t){var e;return xc()&&!(null===(e=Cc[Mc])||void 0===e?void 0:e.includes(t))}function Dc(t){var e,n=xc();return n.withContext((function(){var r=n.startCustomSpan(t);e=r.span})),e}var Uc,Bc="otelReady",Fc="attrProcessor";function jc(t){t[Bc]=!0}function Gc(t,e){void 0===e&&(e={}),t.setAttribute(Bd.CUSTOM_LABELS,JSON.stringify(Wc(e)))}function Wc(t){var e;void 0===t&&(t={});var n=(null===(e=Cc[Fc])||void 0===e?void 0:e.getCustomLabels())||{};return o(o({},n),t)}!function(t){t[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"}(Uc||(Uc={}));var Xc,Hc="__cx_metadata__",Vc="errors",Yc={TYPE:"error_type",STACK:"error_stack",MESSAGE:"error_message",DATA:"error_custom_data"};function zc(t,e){return a(this,void 0,void 0,(function(){var n,r,o,i,a,u;return s(this,(function(s){switch(s.label){case 0:return n=e.stack,r=e.message,o=e.name,i=!!(null==n?void 0:n.includes("at ")),e&&i?(a=Ac().supportMfe,u=Br.parse({stack:n.substring(0,4096),message:r,name:o}).map((function(t){return{fileName:t.fileName,columnNumber:t.columnNumber,lineNumber:t.lineNumber,functionName:t.functionName}})),a?[4,Zc(u,t)]:[3,2]):[3,3];case 1:s.sent(),s.label=2;case 2:t[Yc.STACK]=u,s.label=3;case 3:return[2]}}))}))}function Zc(t,e){return a(this,void 0,void 0,(function(){var n,r,i,a;return s(this,(function(s){switch(s.label){case 0:n=0,s.label=1;case 1:return n<t.length?[4,Kc(t[n].fileName)]:[3,4];case 2:r=s.sent(),t[n]=o(o({},t[n]),r||{isShell:!0}),s.label=3;case 3:return n++,[3,1];case 4:return i=c(t,1),a=i[0],function(t,e){var n=e.app,r=e.version;e.isShell||Gc(t,{mfeApp:n,mfeVersion:r})}(e,a),[2]}}))}))}function Kc(){return a(this,arguments,void 0,(function(t){var e,n,r,i,a,u,l,d;return void 0===t&&(t=""),s(this,(function(s){switch(s.label){case 0:if(n=Cc[Hc],r="cx-metadata.json",i=c(t.match(/https?:\/\/.*\//),1),!(a=i[0]))return[3,7];if(u=void 0,null==n?void 0:n.has(a))return[3,6];s.label=1;case 1:return s.trys.push([1,4,,5]),[4,fetch("".concat(a).concat(r),{cache:"no-cache"})];case 2:return u=s.sent(),l=[{}],[4,u.json()];case 3:return e=o.apply(void 0,[o.apply(void 0,l.concat([s.sent()])),{mfePath:a}]),[3,5];case 4:return d=s.sent(),Ac().debug&&console.warn("Coralogix Browser SDK - Error fetching metadata",d),[3,5];case 5:return Cc[Hc]=n.set(a,e),[3,7];case 6:e=null==n?void 0:n.get(a),s.label=7;case 7:return[2,e]}}))}))}!function(t){t.CONSOLE="console",t.WINDOW="window",t.UNHANDLED_REJECTION="unhandledrejection",t.DOCUMENT="document",t.CAPTURED="captured"}(Xc||(Xc={}));var Jc=function(t){return function(e){t.report(Xc.WINDOW,e)}},Qc=function(t){return function(e){t.report(Xc.UNHANDLED_REJECTION,e.reason)}},qc=function(t){return function(e){t.report(Xc.DOCUMENT,e)}};function $c(t){t.setAttribute(Bd.EVENT_TYPE,sc.ERROR),t.setAttribute(Bd.SEVERITY,dc.Error)}var tl,el,nl=function(t){function n(e){var n=t.call(this,Vc,"1",e)||this;return n.parseErrorObject=function(t){var e;return null!==(e=null==t?void 0:t.message)&&void 0!==e?e:JSON.stringify(t,$d())},Ac().supportMfe&&(Cc[Hc]=new Map),n}return e(n,t),n.prototype.init=function(){},n.prototype.enable=function(){var t;pc.wrap(console,"error",(t=this,function(e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.report(Xc.CONSOLE,n),e.apply(t,n)}})),Cc.addEventListener("error",Jc(this)),Cc.addEventListener("unhandledrejection",Qc(this)),document.documentElement.addEventListener("error",qc(this),{capture:!0})},n.prototype.disable=function(){pc.unwrap(console,"error"),Cc.removeEventListener("error",Jc(this)),Cc.removeEventListener("unhandledrejection",Qc(this)),document.documentElement.removeEventListener("error",qc(this),{capture:!0})},n.prototype.report=function(t,e){var n=this;if(!(e instanceof Array&&0===e.length))switch(!0){case e instanceof Error:this.reportError(t,e);break;case e instanceof ErrorEvent:this.reportErrorEvent(t,e);break;case e instanceof Event:this.reportEvent(t,e);break;case"string"==typeof e:this.reportString(t,e);break;case e instanceof Array:var r=e.find((function(t){return t instanceof Error})),o=e.map((function(t){return"string"==typeof t?t:n.parseErrorObject(t)})).join(" ");this.reportString(t,o,r);break;default:this.reportString(t,"string"==typeof e?e:this.getPossibleEventMessage(e))}},n.prototype.reportError=function(t,e,n,r){return a(this,void 0,void 0,(function(){var o,i,a,u;return s(this,(function(s){switch(s.label){case 0:return o=e.message,i=e.name,a=this.createSpan("error"),u=o.split("\n")[0],$c(a),a.setAttribute(Bd.SOURCE,t),a.setAttribute(Yc.TYPE,i),a.setAttribute(Yc.MESSAGE,u),n&&(a[Yc.DATA]=JSON.stringify(n,$d())),r&&Gc(a,r),[4,zc(a,e)];case 1:return s.sent(),a.end(),[2]}}))}))},n.prototype.reportString=function(t,e,n){return a(this,void 0,void 0,(function(){var r;return s(this,(function(o){switch(o.label){case 0:return $c(r=this.createSpan(t)),r.setAttribute(Bd.SOURCE,t),r.setAttribute(Yc.MESSAGE,null==e?void 0:e.substring(0,1024)),n?[4,zc(r,n)]:[3,2];case 1:o.sent(),o.label=2;case 2:return r.end(),[2]}}))}))},n.prototype.reportErrorEvent=function(t,e){var n=e.error,r=e.message,o=null!=n?n:r;this.report(t,o)},n.prototype.reportEvent=function(t,e){if(e.target){var n=this.createSpan(t);$c(n),n.setAttribute(Bd.SOURCE,t),e.target&&(n.setAttribute("target_element",e.target.tagName),n.setAttribute("target_xpath",Ot(e.target,!0)),n.setAttribute("target_src",e.target.src)),n.end()}},n.prototype.createSpan=function(t){return kc(sc.ERROR)?Dc(t):this.tracer.startSpan(t)},n.prototype.getPossibleEventMessage=function(t){var e=t||{},n=e.message,r=e.statusMessage;return n&&"string"==typeof n?n:r&&"string"==typeof r?r:JSON.stringify(t)},n}(Ur),rl=function(t){var e,n=t.traceParentInHeader,r=null===(e=null==n?void 0:n.options)||void 0===e?void 0:e.propagateTraceHeaderCorsUrls;(null==n?void 0:n.enabled)&&r&&(t.propagateTraceHeaderCorsUrls=r)},ol=function(){function t(){var t=this;this.responseBodyParsers=new Map([[tl.Json,function(e){return a(t,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return n=(t=JSON).stringify,[4,e.json()];case 1:return[2,n.apply(t,[r.sent()])]}}))}))}],[tl.TextPlain,function(e){return a(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,e.text()];case 1:return[2,t.sent()]}}))}))}],[tl.TextHtml,function(e){return a(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,e.text()];case 1:return[2,t.sent()]}}))}))}],[tl.TextCss,function(e){return a(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,e.text()];case 1:return[2,t.sent()]}}))}))}],[tl.TextJavascript,function(e){return a(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,e.text()];case 1:return[2,t.sent()]}}))}))}],[tl.Xml,function(e){return a(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,e.text()];case 1:return[2,t.sent()]}}))}))}],[tl.FormData,function(e){return a(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,e.text()];case 1:return[2,t.sent()]}}))}))}]]),this.requestBodySerializers=new Map([[el.String,function(e){return a(t,void 0,void 0,(function(){return s(this,(function(t){return[2,e]}))}))}],[el.Blob,function(e){return a(t,void 0,void 0,(function(){return s(this,(function(t){return[2,e.text()]}))}))}],[el.FormData,function(e){return a(t,void 0,void 0,(function(){return s(this,(function(t){return[2,this.serializeFormData(e)]}))}))}],[el.URLSearchParams,function(e){return a(t,void 0,void 0,(function(){return s(this,(function(t){return[2,e.toString()]}))}))}],[el.JsonObject,function(e){return a(t,void 0,void 0,(function(){return s(this,(function(t){return[2,JSON.stringify(e)]}))}))}]])}return t.prototype.resolveConfigForUrl=function(t,e){return void 0===e&&(e=[]),e.find((function(e){var n=e.url;return n===t||n instanceof RegExp&&n.test(t)}))},t.prototype.stringifyRequestBody=function(t){return a(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return(null==t?void 0:t.body)?[4,this.serializeRequestBody(t.body)]:[2,""];case 1:return e=n.sent(),[2,this.truncateIfExceedsLimit(e)]}}))}))},t.prototype.stringifyResponseBody=function(t){return a(this,void 0,void 0,(function(){var e,n,r,o;return s(this,(function(i){switch(i.label){case 0:return e=t.headers.get("content-type")||"",n=e.split(";")[0].trim(),(r=this.responseBodyParsers.get(n))?[4,r(t)]:[2,""];case 1:return o=i.sent(),[2,this.truncateIfExceedsLimit(o)]}}))}))},t.prototype.truncateIfExceedsLimit=function(t){return t.length>Cd?void 0:t},t.prototype.serializeRequestBody=function(t){return a(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:return(e=this.requestBodySerializers.get(t.constructor.name))?[4,e(t)]:[3,2];case 1:return n=r.sent(),[3,3];case 2:n="",r.label=3;case 3:return[2,n]}}))}))},t.prototype.serializeFormData=function(t){var e="";return t.forEach((function(t,n){e+="".concat(n,": ").concat(t,"\n")})),e.trim()},t}();!function(t){t.Json="application/json",t.TextPlain="text/plain",t.TextHtml="text/html",t.TextCss="text/css",t.TextJavascript="application/javascript",t.Xml="application/xml",t.FormData="multipart/form-data"}(tl||(tl={})),function(t){t.String="String",t.Blob="Blob",t.FormData="FormData",t.URLSearchParams="URLSearchParams",t.JsonObject="JsonObject",t.Unknown="Unknown"}(el||(el={}));var il,al=function(){function t(){}return t.prototype.filterHeaders=function(t,e){if(void 0===e&&(e=[]),!t)return new Map;var n=this.normalizeHeaders(t),r=new Map;return e.forEach((function(t){var e=t.toLowerCase();n.has(e)&&r.set(t,n.get(e))})),r},t.prototype.normalizeHeaders=function(t){if("string"==typeof t)return this.normalizeHeadersFromString(t);var e=new Headers(t),n=new Map;return e.forEach((function(t,e){n.set(e.toLowerCase(),t)})),n},t.prototype.normalizeHeadersFromString=function(t){var e=new Map;return t?(t.trim().split(/\r\n/).forEach((function(t){var n=c(t.split(": ",2),2),r=n[0],o=n[1];r&&o&&e.set(r.trim().toLowerCase(),o.trim())})),e):e},t}(),sl="request_headers",ul="response_headers",cl="response_payload",ll="request_payload";function dl(t){if(kc(sc.NETWORK_REQUEST)){var e=xc().span.spanContext(),n=e.traceId,r=e.spanId;t._spanContext.traceId=n,t.parentSpanId=r}}!function(t){t.FETCH="fetch"}(il||(il={}));var pl,fl=function(t){function n(e){var n=this;return rl(e),e.applyCustomAttributesOnSpan=function(t,e,r){jc(t),dl(t),n.setNetworkSpanAttributes(t,e,r)},(n=t.call(this,e)||this).networkDataManager=new ol,n.headersManager=new al,n}return e(n,t),n.prototype.setNetworkSpanAttributes=function(t,e,n){return a(this,void 0,void 0,(function(){var r,o,i,a,u;return s(this,(function(s){switch(s.label){case 0:return r=n.status,o=Ac().networkExtraConfig,i=t.attributes["http.url"]||"",(a=this.networkDataManager.resolveConfigForUrl(i,o))?[4,this.setRequestAttributes(t,e,a)]:[3,3];case 1:return s.sent(),[4,this.setResponseAttributes(t,n,a)];case 2:s.sent(),s.label=3;case 3:return t.setAttributes(((u={})[Bd.SEVERITY]=zd(r)?dc.Error:dc.Info,u[Bd.EVENT_TYPE]=sc.NETWORK_REQUEST,u[Bd.SOURCE]=il.FETCH,u)),[2]}}))}))},n.prototype.setRequestAttributes=function(t,e,n){return a(this,void 0,void 0,(function(){var r,o,i,a,u,c;return s(this,(function(s){switch(s.label){case 0:r=n.reqHeaders,o=n.collectReqPayload,s.label=1;case 1:return s.trys.push([1,5,,6]),o?[4,this.networkDataManager.stringifyRequestBody(e)]:[3,3];case 2:return a=s.sent(),[3,4];case 3:a=void 0,s.label=4;case 4:return i=a,u=(null==r?void 0:r.length)?this.headersManager.filterHeaders(e.headers,r):void 0,i&&(t[ll]=i),(null==u?void 0:u.size)&&(t[sl]=Object.fromEntries(u)),[3,6];case 5:return c=s.sent(),Ac().debug&&console.debug("Error setting request attributes on span:",c),[3,6];case 6:return[2]}}))}))},n.prototype.setResponseAttributes=function(t,e,n){return a(this,void 0,void 0,(function(){var r,o,i,a,u,c;return s(this,(function(s){switch(s.label){case 0:if(r=n.resHeaders,o=n.collectResPayload,!(e instanceof Response))return[3,6];s.label=1;case 1:return s.trys.push([1,5,,6]),o?[4,this.networkDataManager.stringifyResponseBody(e)]:[3,3];case 2:return a=s.sent(),[3,4];case 3:a=void 0,s.label=4;case 4:return i=a,u=(null==r?void 0:r.length)?this.headersManager.filterHeaders(e.headers,r):void 0,i&&(t[cl]=i),(null==u?void 0:u.size)&&(t[ul]=Object.fromEntries(u)),[3,6];case 5:return c=s.sent(),Ac().debug&&console.debug("Error setting request attributes on span:",c),[3,6];case 6:return[2]}}))}))},n}(uo);!function(t){t.XHR="xhr"}(pl||(pl={}));var hl,ml=function(t){function n(e){var n=this;return rl(e),e.applyCustomAttributesOnSpan=function(t,e){jc(t),dl(t),n.setNetworkSpanAttributes(t,e)},(n=t.call(this,e)||this).networkDataManager=new ol,n.headersManager=new al,n}return e(n,t),n.prototype.setNetworkSpanAttributes=function(t,e){var n,r=e.status,o=Ac().networkExtraConfig,i=this.networkDataManager.resolveConfigForUrl(e.responseURL,o);t.setAttributes(((n={})[Bd.SEVERITY]=zd(r)?dc.Error:dc.Info,n[Bd.EVENT_TYPE]=sc.NETWORK_REQUEST,n[Bd.SOURCE]=pl.XHR,n)),i&&this.setResponseAttributes(t,e,i)},n.prototype.setResponseAttributes=function(t,e,n){var r=n.resHeaders,o=n.collectResPayload?this.networkDataManager.truncateIfExceedsLimit(e.responseText):void 0,i=(null==r?void 0:r.length)?this.headersManager.filterHeaders(e.getAllResponseHeaders(),r):void 0;o&&(t[cl]=o),(null==i?void 0:i.size)&&(t[ul]=Object.fromEntries(i))},n}(Po);!function(t){t.CODE="code"}(hl||(hl={}));var gl=function(t){function n(e){var n,r=t.call(this,sc.LOG,"1",e)||this;return r.stringifyCustomLogData=null===(n=Ac())||void 0===n?void 0:n.stringifyCustomLogData,r}return e(n,t),n.prototype.init=function(){},n.prototype.disable=function(){},n.prototype.enable=function(){},n.prototype.log=function(t,e,n){var r=this.tracer.startSpan(sc.LOG);r.setAttribute(Bd.EVENT_TYPE,sc.LOG),r.setAttribute(Bd.SOURCE,hl.CODE),r.setAttribute(Bd.SEVERITY,t),r.setAttribute(Bd.LOG,JSON.stringify({severity:t,message:e,data:this.stringifyCustomLogData?JSON.stringify(n,$d()):n})),r.end()},n}(Ur);function vl(t){return null==t}function yl(t){return"object"==typeof t}function El(t){void 0===t&&(t={});for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(vl(t))return{};var r,a=function(t,e){var n,r=c(e),s=r[0],u=r.slice(1);if(!t.hasOwnProperty(s))return t;if(!u.length){var l=t,d=s;return l[d],i(l,["symbol"==typeof d?d:d+""])}return o(o({},t),((n={})[s]=a(t[s],u),n))};return(r=e,vl(r)?[]:r instanceof Set?l([],c(r),!1):Array.isArray(r)?r:[r]).reduce((function(t,e){return a(t,e.split("."))}),t)}var _l="web_vitals",Tl="long_tasks",Sl="resources",bl="dom",Il="custom_measurement",Cl={lcp:!0,fid:!0,cls:!0,fcp:!0,inp:!0,ttfb:!0,tbt:!0,lt:!0},Ol="internal",Rl=[".css"],wl=[".wasm",".manifest"],Al=[".js",".mjs"],Ll=[".mp3",".mp4",".wav",".ogg",".webm",".avi"],Nl=[".pdf",".doc",".docx",".ppt",".pptx",".xls",".xlsx",".csv",".html"],Ml=[".woff",".woff2",".ttf",".otf",".eot"],xl=[".svg",".jpg",".png",".jpeg",".bmp",".webp"],Pl="undefined"!=typeof globalThis?globalThis:{},kl="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};function Dl(){Dl=function(){},Pl.Symbol||(Pl.Symbol=Bl)}var Ul=0;function Bl(t){return"jscomp_symbol_"+(t||"")+Ul++}function Fl(){Dl();var t=Pl.Symbol.iterator;t||(t=Pl.Symbol.iterator=Pl.Symbol("iterator")),"function"!=typeof Array.prototype[t]&&kl(Array.prototype,t,{configurable:!0,writable:!0,value:function(){return jl(this)}}),Fl=function(){}}function jl(t){var e=0;return function(t){return Fl(),(t={next:t})[Pl.Symbol.iterator]=function(){return this},t}((function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}))}function Gl(t){Fl();var e=t[Symbol.iterator];return e?e.call(t):jl(t)}function Wl(t){if(!(t instanceof Array)){t=Gl(t);for(var e,n=[];!(e=t.next()).done;)n.push(e.value);t=n}return t}var Xl=0,Hl="img script iframe link audio video source".split(" ");function Vl(t,e){for(var n=(t=Gl(t)).next();!n.done;n=t.next())if(n=n.value,e.includes(n.nodeName.toLowerCase())||Vl(n.children,e))return!0;return!1}function Yl(t,e){if(2<t.length)return performance.now();for(var n=[],r=(e=Gl(e)).next();!r.done;r=e.next())r=r.value,n.push({timestamp:r.start,type:"requestStart"}),n.push({timestamp:r.end,type:"requestEnd"});for(r=(e=Gl(t)).next();!r.done;r=e.next())n.push({timestamp:r.value,type:"requestStart"});for(n.sort((function(t,e){return t.timestamp-e.timestamp})),t=t.length,e=n.length-1;0<=e;e--)switch(r=n[e],r.type){case"requestStart":t--;break;case"requestEnd":if(2<++t)return r.timestamp;break;default:throw Error("Internal Error: This should never happen")}return 0}function zl(t){t=t||{},this.w=!!t.useMutationObserver,this.u=t.minValue||null,t=globalThis.__tti&&globalThis.__tti.e;var e=globalThis.__tti&&globalThis.__tti.o;this.a=t?t.map((function(t){return{start:t.startTime,end:t.startTime+t.duration}})):[],e&&e.disconnect(),this.b=[],this.f=new Map,this.j=null,this.v=-1/0,this.i=!1,this.h=this.c=this.s=null,function(t,e){var n=XMLHttpRequest.prototype.send,r=Xl++;XMLHttpRequest.prototype.send=function(o){for(var i=[],a=0;a<arguments.length;++a)i[a-0]=arguments[a];var s=this;return t(r),this.addEventListener("readystatechange",(function(){4===s.readyState&&e(r)})),n.apply(this,i)}}(this.m.bind(this),this.l.bind(this)),function(t,e){var n=fetch;fetch=function(r){for(var o=[],i=0;i<arguments.length;++i)o[i-0]=arguments[i];return new Promise((function(r,i){var a=Xl++;t(a),n.apply(null,[].concat(Wl(o))).then((function(t){e(a),r(t)}),(function(t){e(t),i(t)}))}))}}(this.m.bind(this),this.l.bind(this)),function(t){t.c=new PerformanceObserver((function(e){for(var n=(e=Gl(e.getEntries())).next();!n.done;n=e.next())if("resource"===(n=n.value).entryType&&(t.b.push({start:n.fetchStart,end:n.responseEnd}),Kl(t,Yl(t.g,t.b)+5e3)),"longtask"===n.entryType){var r=n.startTime+n.duration;t.a.push({start:n.startTime,end:r}),Kl(t,r+5e3)}})),t.c.observe({entryTypes:["longtask","resource"]})}(this),this.w&&(this.h=function(t){var e=new MutationObserver((function(e){for(var n=(e=Gl(e)).next();!n.done;n=e.next())("childList"==(n=n.value).type&&Vl(n.addedNodes,Hl)||"attributes"==n.type&&Hl.includes(n.target.tagName.toLowerCase()))&&t(n)}));return e.observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]}),e}(this.B.bind(this)))}function Zl(t){t.i=!0;var e=0<t.a.length?t.a[t.a.length-1].end:0,n=Yl(t.g,t.b);Kl(t,Math.max(n+5e3,e))}function Kl(t,e){!t.i||t.v>e||(clearTimeout(t.j),t.j=setTimeout((function(){var e=performance.timing.navigationStart,n=Yl(t.g,t.b);if(e=(globalThis.a&&globalThis.a.A?1e3*globalThis.a.A().C-e:0)||performance.timing.domContentLoadedEventEnd-e,t.u)var r=t.u;else r=performance.timing.domContentLoadedEventEnd?(r=performance.timing).domContentLoadedEventEnd-r.navigationStart:null;var o=performance.now();null===r&&Kl(t,Math.max(n+5e3,o+1e3));var i=t.a;(n=5e3>o-n||5e3>o-(n=i.length?i[i.length-1].end:e)?null:Math.max(n,r))&&(t.s(n),clearTimeout(t.j),t.i=!1,t.c&&t.c.disconnect(),t.h&&t.h.disconnect()),Kl(t,performance.now()+1e3)}),e-performance.now()),t.v=e)}zl.prototype.getFirstConsistentlyInteractive=function(){var t=this;return new Promise((function(e){t.s=e,"complete"==document.readyState?Zl(t):globalThis.addEventListener("load",(function(){Zl(t)}))}))},zl.prototype.m=function(t){this.f.set(t,performance.now())},zl.prototype.l=function(t){this.f.delete(t)},zl.prototype.B=function(){Kl(this,performance.now()+5e3)},Pl.Object.defineProperties(zl.prototype,{g:{configurable:!0,enumerable:!0,get:function(){return[].concat(Wl(this.f.values()))}}});var Jl,Ql=function(t){function n(e){var n,r=t.call(this,_l,"1.0.0",e)||this;return r.observers=[],r.isSoftNavsEnabled=Ac().trackSoftNavigations,r.onReport=function(t){if(t){"FCP"===t.name&&r.registerToTBTMetric();var e=r.tracer.startSpan(sc.WEB_VITALS),n=t.entries?El(t,"entries"):t;"INP"===(n=El(n,"attribution.navigationEntry")).name&&(n=El(n,"attribution.interactionTargetElement")),e.setAttribute(Bd.EVENT_TYPE,sc.WEB_VITALS),e.setAttribute(_l,JSON.stringify(n,$d())),e.end()}},r.metrics=vl(n=e.metrics)||(n instanceof Set||n instanceof Map?0===n.size:Array.isArray(n)||"string"==typeof n?0===n.length:yl(n)&&0===Object.keys(n).length)?Cl:e.metrics,r.registerToCoreWebVitalMetrics(),r.registerToCalculatedWebVitalMetrics(),r.isSoftNavsEnabled&&r.registerToSoftNavigations(),r}return e(n,t),n.prototype.registerToCoreWebVitalMetrics=function(){var t=this.isSoftNavsEnabled&&Hd.has(uc.SoftNavigation);this.metrics.fid&&function(t,e){!function(t,e){var n,r=Yo(e=e||{}),o=(null===(n=ko())||void 0===n?void 0:n.navigationId)||"1";ri((function(){var n,i=ni(),a=Vo("FID"),s=function(s){s.forEach((function(s){var c;r?s.navigationId&&s.navigationId!==a.navigationId&&(c=s.navigationId,i=ni(!0),a=Vo("FID",0,"soft-navigation",c),n=Fo(t,a,Zi,e.reportAllChanges)):u.disconnect(),s.startTime<i.firstHiddenTime&&(a.value=s.processingStart-s.startTime,a.entries.push(s),a.navigationId=s.navigationId||o,n(!0))}))},u=Zo("first-input",s,e);n=Fo(t,a,Zi,e.reportAllChanges),u&&(Ko((function(){s(u.takeRecords()),r||u.disconnect()})),Xo((function(){var r;a=Vo("FID",0,"back-forward-cache",a.navigationId),n=Fo(t,a,Zi,e.reportAllChanges),ki=[],xi=-1,Mi=null,zi(addEventListener),r=s,ki.push(r),Vi()})))}))}((function(e){var n=function(t){var e=t.entries[0],n={eventTarget:Bo(e.target),eventType:e.name,eventTime:e.startTime,eventEntry:e,loadState:Do(e.startTime)};return Object.assign(t,{attribution:n})}(e);t(n)}),e)}(this.onReport),this.metrics.cls&&function(t,e){!function(t,e){var n=Yo(e=e||{}),r=!1,o=0;ii(Jo((function(){var i,a=Vo("CLS",0),s=0,u=[],c=function(n,u){if(a=Vo("CLS",0,n,u),i=Fo(t,a,ai,e.reportAllChanges),s=0,r=!1,"soft-navigation"===n){var c=zo(u);o=c&&c.startTime||0}},l=function(t){t.forEach((function(t){if(n&&t.navigationId&&t.navigationId!==a.navigationId&&(s>a.value&&(a.value=s,a.entries=u),i(!0),c("soft-navigation",t.navigationId)),!t.hadRecentInput){var e=u[0],r=u[u.length-1];s&&t.startTime-r.startTime<1e3&&t.startTime-e.startTime<5e3?(s+=t.value,u.push(t)):(s=t.value,u=[t])}})),s>a.value&&(a.value=s,a.entries=u,i())},d=Zo("layout-shift",l,e);d&&(i=Fo(t,a,ai,e.reportAllChanges),Ko((function(){l(d.takeRecords()),i(!0),r=!0})),Xo((function(){c("back-forward-cache",a.navigationId),jo((function(){return i()}))})),n&&Zo("soft-navigation",(function(n){n.forEach((function(n){var s=n.navigationId,u=s?zo(s):null;s&&s!==a.navigationId&&u&&(u.startTime||0)>o&&(r||i(!0),c("soft-navigation",n.navigationId),i=Fo(t,a,ai,e.reportAllChanges))}))}),e),setTimeout(i,0))})))}((function(e){var n=function(t){var e,n={};if(t.entries.length){var r=t.entries.reduce((function(t,e){return t&&t.value>e.value?t:e}));if(r&&r.sources&&r.sources.length){var o=(e=r.sources).find((function(t){return t.node&&1===t.node.nodeType}))||e[0];o&&(n={largestShiftTarget:Bo(o.node),largestShiftTime:r.startTime,largestShiftValue:r.value,largestShiftSource:o,largestShiftEntry:r,loadState:Do(r.startTime)})}}return Object.assign(t,{attribution:n})}(e);t(n)}),e)}(this.onReport,{reportSoftNavs:t}),this.metrics.lcp&&function(t,e){!function(t,e){var n,r=!1,o=Yo(e=e||{}),i=0,a=(null===(n=ko())||void 0===n?void 0:n.navigationId)||"1",s="";ri((function(){var n,u=ni(),c=Vo("LCP"),l=function(o,a){if(c=Vo("LCP",0,o,a),n=Fo(t,c,Bi,e.reportAllChanges),r=!1,"soft-navigation"===o){u=ni(!0);var s=zo(a);i=s&&s.startTime?s.startTime:0}f()},d=function(t){t.forEach((function(t){if(t){o&&t.navigationId&&t.navigationId!==c.navigationId&&(r||n(!0),l("soft-navigation",t.navigationId));var e=0;if(t.navigationId&&t.navigationId!==a){var i=zo(t.navigationId),s=i&&i.startTime?i.startTime:0;e=Math.max(t.startTime-s,0)}else e=Math.max(t.startTime-Ho(),0);t.startTime<u.firstHiddenTime&&(c.value=e,c.entries=[t],c.navigationId=t.navigationId||a,n())}}))},p=function(){h(),r||(d(g.takeRecords()),o||g.disconnect(),c.navigationId===s&&(r=!0,n(!0)))},f=function(){["keydown","click"].forEach((function(t){addEventListener(t,(function(){return m()}),!0)}))},h=function(){["keydown","click"].forEach((function(t){removeEventListener(t,(function(){return m()}),!0)}))},m=function(){s=c.navigationId,Ti(p)},g=Zo("largest-contentful-paint",d,e);g&&(n=Fo(t,c,Bi,e.reportAllChanges),f(),Ko((function(){s=c.navigationId,p()})),Xo((function(t){l("back-forward-cache",c.navigationId),jo((function(){c.value=performance.now()-t.timeStamp,r=!0,n(!0)}))})),o&&Zo("soft-navigation",(function(t){t.forEach((function(t){var e=t.navigationId?zo(t.navigationId):null;t.navigationId&&t.navigationId!==c.navigationId&&e&&(e.startTime||0)>i&&(r||n(!0),l("soft-navigation",t.navigationId))}))}),e))}))}((function(e){var n=function(t){var e,n=(null===(e=ko())||void 0===e?void 0:e.navigationId)||"1",r={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:t.value};if(t.entries.length){var o,i=0,a=0,s=0;if(t.navigationId&&t.navigationId!==n?i=s=(o=zo(t.navigationId))?o.startTime:0:(i=(o=ko())&&o.activationStart?o.activationStart:0,a=o&&o.responseStart?o.responseStart:0),o){var u=t.entries[t.entries.length-1],c=u.url&&performance.getEntriesByType("resource").filter((function(t){return t.name===u.url}))[0],l=Math.max(0,a-i),d=Math.max(l,c?(c.requestStart||c.startTime)-i:0),p=Math.max(d-s,c?c.responseEnd-i:0,0),f=Math.max(p-s,u?u.startTime-i:0,0);r={element:Bo(u.element),timeToFirstByte:l,resourceLoadDelay:d-l,resourceLoadDuration:p-d,elementRenderDelay:f-p,navigationEntry:o,lcpEntry:u},u.url&&(r.url=u.url),c&&(r.lcpResourceEntry=c)}}return Object.assign(t,{attribution:r})}(e);t(n)}),e)}(this.onReport,{reportSoftNavs:t}),this.metrics.fcp&&function(t,e){ii((function(e){var n=function(t){var e,n=(null===(e=ko())||void 0===e?void 0:e.navigationId)||"1",r={timeToFirstByte:0,firstByteToFCP:t.value,loadState:Do(Wo())};if(t.entries.length){var o,i=t.entries[t.entries.length-1],a=0;if(t.navigationId&&t.navigationId!==n)a=(o=zo(t.navigationId))?o.startTime:0;else if(o=ko()){var s=o.responseStart,u=o.activationStart||0;a=Math.max(0,s-u)}o&&(r={timeToFirstByte:a,firstByteToFCP:t.value-a,loadState:Do(t.entries[0].startTime),navigationEntry:o,fcpEntry:i})}return Object.assign(t,{attribution:r})}(e);t(n)}),e)}(this.onReport,{reportSoftNavs:t}),this.metrics.inp&&function(t,e){Mo||(Mo=Zo("long-animation-frame",Ai)),function(t,e){if("PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype){var n=Yo(e=e||{}),r=!1,o=0;ri((function(){var i;hi(n);var a,s=Vo("INP"),u=function(n,i){if(yi(),s=Vo("INP",0,n,i),a=Fo(t,s,Si,e.reportAllChanges),r=!1,"soft-navigation"===n){var u=zo(i);o=u&&u.startTime?u.startTime:0}},c=function(t){Ti((function(){var n;t.forEach(_i),(n=function(){var t=Math.min(mi.length-1,Math.floor((fi()-vi)/50));return mi[t]}())&&(n.latency!==s.value||e&&e.reportAllChanges)&&(s.value=n.latency,s.entries=n.entries),a()}))},l=Zo("event",c,{durationThreshold:null!==(i=e.durationThreshold)&&void 0!==i?i:40,opts:e});a=Fo(t,s,Si,e.reportAllChanges),l&&(l.observe({type:"first-input",buffered:!0,includeSoftNavigationObservations:n}),Ko((function(){c(l.takeRecords()),a(!0)})),Xo((function(){yi(),u("back-forward-cache",s.navigationId),jo((function(){return a()}))})),n&&Zo("soft-navigation",(function(n){n.forEach((function(n){var i=zo(n.navigationId),c=i&&i.startTime?i.startTime:0;n.navigationId&&n.navigationId!==s.navigationId&&c>o&&(!r&&s.value>0&&a(!0),u("soft-navigation",n.navigationId),a=Fo(t,s,Si,e.reportAllChanges))}))}),e))}))}}((function(e){var n=function(t){var e=t.entries[0],n=Oi.get(e),r=e.processingStart,o=n.processingEnd,i=n.entries.sort((function(t,e){return t.processingStart-e.processingStart})),a=Ui(e.startTime,o),s=t.entries.find((function(t){return t.target})),u=s&&s.target||Ri.get(e.interactionId),c=[e.startTime+e.duration,o].concat(a.map((function(t){return t.startTime+t.duration}))),l=Math.max.apply(Math,c),d={interactionTarget:Bo(u),interactionTargetElement:u,interactionType:e.name.startsWith("key")?"keyboard":"pointer",interactionTime:e.startTime,nextPaintTime:l,processedEventEntries:i,longAnimationFrameEntries:a,inputDelay:r-e.startTime,processingDuration:o-r,presentationDelay:Math.max(l-o,0),loadState:Do(e.startTime)};return Object.assign(t,{attribution:d})}(e);t(n)}),e)}(this.onReport,{reportSoftNavs:t}),this.metrics.ttfb&&function(t,e){Gi((function(e){var n=function(t){var e={waitingDuration:0,cacheDuration:0,dnsDuration:0,connectionDuration:0,requestDuration:0};if(t.entries.length){var n=t.entries[0],r=n.activationStart||0,o=Math.max((n.workerStart||n.fetchStart)-r,0),i=Math.max(n.domainLookupStart-r||0,0),a=Math.max(n.connectStart-r||0,0),s=Math.max(n.connectEnd-r||0,0);e={waitingDuration:o,cacheDuration:i-o,dnsDuration:a-i,connectionDuration:s-a,requestDuration:t.value-s,navigationEntry:n}}return Object.assign(t,{attribution:e})}(e);t(n)}),e)}(this.onReport,{reportSoftNavs:t})},n.prototype.registerToSoftNavigations=function(){var t=this;if(Hd.has(uc.SoftNavigation)){var e=new PerformanceObserver((function(e){var n;e.getEntries().forEach((function(e){var r=e.duration,o=e.name,i=e.startTime,a=e.navigationId;n={name:"SN",id:Jd(),value:r,url:o,navigationType:"soft-navigation",navigationId:a,startTime:i},t.onReport(n)}))}));this.observers.push(e),e.observe({type:uc.SoftNavigation,buffered:!0})}else console.warn("Coralogix Browser SDK - browser doesnt support soft navigation events")},n.prototype.registerToCalculatedWebVitalMetrics=function(){this.metrics.lt&&(Hd.has(uc.Navigation)?this.calculateLoadingPageTime():console.warn("Coralogix Browser SDK - browser doesnt support navigation events"))},n.prototype.registerToTBTMetric=function(){this.metrics.tbt&&(Hd.has(uc.LongTask)?this.calculateAllTotalBlockingTime():console.warn("Coralogix Browser SDK - browser doesnt support TBT events"))},n.prototype.calculateLoadingPageTime=function(){var t=this,e=new PerformanceObserver((function(e){var n;e.getEntries().forEach((function(e){var r=e,o=r.duration,i=r.name,a=r.type,s=r.activationStart,u=r.domComplete,c=r.domContentLoadedEventEnd,l=r.domContentLoadedEventStart,d=r.domInteractive,p=r.loadEventEnd,f=r.loadEventStart,h=r.redirectCount,m=r.unloadEventStart,g=r.unloadEventEnd;n={name:"LT",id:Jd(),value:o,url:i,navigationType:a,activationStart:s,domComplete:u,domContentLoadedEventEnd:c,domContentLoadedEventStart:l,domInteractive:d,loadEventEnd:p,loadEventStart:f,redirectCount:h,unloadEventStart:m,unloadEventEnd:g},o&&t.onReport(n)}))}));this.observers.push(e),e.observe({type:uc.Navigation,buffered:!0})},n.prototype.calculateAllTotalBlockingTime=function(){var t,e=this,n=new PerformanceObserver((function(e){var n,r=function(t){return t.reduce((function(t,e){return t+(e.duration-50)}),0)}(e.getEntries());t={name:"TBT",id:Jd(),rating:Qd(r),value:(null!==(n=null==t?void 0:t.value)&&void 0!==n?n:0)+r}}));this.observers.push(n),n.observe({type:uc.LongTask,buffered:!0}),function(t){return t=t||{},"PerformanceLongTaskTiming"in globalThis?new zl(t).getFirstConsistentlyInteractive():Promise.resolve(null)}().then((function(r){var o,i;r&&(e.onReport(t),e.onReport({name:"TTI",value:r,id:Jd()}),n.disconnect(),null===(i=null===(o=Cc.__tti)||void 0===o?void 0:o.o)||void 0===i||i.disconnect())}))},n.prototype.enable=function(){},n.prototype.disable=function(){this.observers.forEach((function(t){return t.disconnect()}))},n.prototype.init=function(){},n}(Ur),ql=function(t){function n(e){var n=t.call(this,Tl,"1.0.0",e)||this;return Hd.has(uc.LongTask)?n.registerToLongTasks():console.warn("Coralogix Browser SDK - browser doesnt support longtask events"),n}return e(n,t),n.prototype.registerToLongTasks=function(){var t=this;this.longTaskObserver=new PerformanceObserver((function(e){e.getEntries().forEach((function(e){return t.createSpanFromLongTask(e)}))})),this.longTaskObserver.observe({type:uc.LongTask,buffered:!0})},n.prototype.createSpanFromLongTask=function(t){var e=this.tracer.startSpan(sc.LONG_TASK),n=o(o({},ep(t)),{id:tc()});t.toJSON&&delete n.toJSON,t.attribution&&delete n.attribution,e.setAttribute(Bd.EVENT_TYPE,sc.LONG_TASK),e.setAttribute(sc.LONG_TASK,JSON.stringify(n)),e.end()},n.prototype.enable=function(){},n.prototype.disable=function(){var t;null===(t=this.longTaskObserver)||void 0===t||t.disconnect()},n.prototype.init=function(){},n}(Ur);function $l(t,e){return e.some((function(e){return e===t}))}function td(t,e,n){return e.some((function(e){return e instanceof RegExp?e.test(t):"string"==typeof e?(e=e.toLowerCase()).includes(t.toLowerCase()):(n&&console.warn("Coralogix Browser SDK - ".concat(n," must be from type string | Regex")),!1)}))}!function(t){t.Media="media",t.Script="script",t.Css="css",t.Beacon="beacon",t.Img="img",t.Font="font",t.Doc="doc",t.Xhr="xmlhttprequest",t.Fetch="fetch",t.Iframe="iframe",t.Video="video",t.Audio="audio",t.Track="track",t.Other="other"}(Jl||(Jl={}));var ed=function(t){function n(e){var n,r=t.call(this,Sl,"1.0.0",e)||this;return r.ignoreUrls=null===(n=Ac())||void 0===n?void 0:n.ignoreUrls,Hd.has(uc.Resource)?r.registerToResources():console.warn("Coralogix Browser SDK - browser doesnt support resource events"),r}return e(n,t),n.prototype.registerToResources=function(){var t=this;this.resourcesObserver=new PerformanceObserver((function(e){e.getEntries().forEach((function(e){if(t.isProcessableResourceEntry(e)){var n=t.mapResource(e);t.createSpanFromResource(n)}}))})),this.resourcesObserver.observe({type:uc.Resource,buffered:!0})},n.prototype.isProcessableResourceEntry=function(t){var e=![Jl.Xhr,Jl.Fetch].includes(t.initiatorType),n=!this.isResourceIgnored(t.name);return e&&n},n.prototype.isResourceIgnored=function(t){var e;return!(!t||!(null===(e=this.ignoreUrls)||void 0===e?void 0:e.length))&&td(t,this.ignoreUrls,"ignoreUrls")},n.prototype.mapResource=function(t){var e=t.name,n=t.initiatorType;switch(!0){case $l(n,[Jl.Beacon])||Vd(e,wl):n=Jl.Other;break;case n!==Jl.Css&&Vd(e,Rl):n=Jl.Css;break;case n!==Jl.Script&&Vd(e,Al):n=Jl.Script;break;case n!==Jl.Img&&Vd(e,xl):n=Jl.Img;break;case e.includes("fonts.googleapis.com")||Vd(e,Ml):n=Jl.Font;break;case n!==Jl.Iframe&&Vd(e,Nl):n=Jl.Doc;break;case $l(n,[Jl.Video,Jl.Audio,Jl.Track])||Vd(e,Ll):n=Jl.Media}return o(o({},ep(t)),{initiatorType:n})},n.prototype.createSpanFromResource=function(t){var e,n=this.tracer.startSpan(Sl);n.setAttribute(Bd.EVENT_TYPE,sc.RESOURCES);var r=o(o({},ep(t)),{name:null===(e=t.name)||void 0===e?void 0:e.slice(0,Cd)});n.setAttribute(Sl,JSON.stringify(r)),n.end()},n.prototype.enable=function(){},n.prototype.disable=function(){var t;null===(t=this.resourcesObserver)||void 0===t||t.disconnect()},n.prototype.init=function(){},n}(Ur);function nd(t,e){var n,r=Ic();return r.Zone&&"function"==typeof r.Zone.__symbol__&&(n=t[r.Zone.__symbol__(e)]),n||(n=t[e]),n}function rd(t,e,n,r){var o=void 0===r?{}:r,i=o.once,a=o.capture,s=o.passive,u=i?function(t){d(),n(t)}:n,c=s?{capture:a,passive:s}:a,l=nd(t,"addEventListener");function d(){var n=nd(t,"removeEventListener");e.forEach((function(e){return n.call(t,e,u,c)}))}return e.forEach((function(e){return l.call(t,e,u,c)})),{stop:d}}var od,id=["BUTTON","LABEL","A","INPUT","OPTION"];function ad(t,e){if(!t)return"";var n=sd(t,5);return n?function(t,e){if(cd(t,e.maskInputTypes,e.maskClass)||ud(t,e.maskClass,5))return Md;var n=function(t,e){return t.children?Array.from(t.children).find((function(t){return cd(t,e.maskInputTypes,e.maskClass)})):null}(t,e);return n?Md:function(t){return t instanceof HTMLInputElement?t.value||"":"innerText"in t?t.innerText:""}(t)}(n,e):""}function sd(t,e){return!t||e<=0?null:id.includes(t.nodeName)?t:sd(t.parentElement,e-1)}function ud(t,e,n){return void 0===n&&(n=5),!(!t||n<=0)&&(!!ld(t.className,e)||ud(t.parentElement,e,n-1))}function cd(t,e,n){return!!t&&(function(t,e){if(t instanceof HTMLInputElement){var n=t.type||"text";return e.includes(n)}return!1}(t,e)||ld(t.className,n))}function ld(t,e){return e instanceof RegExp?e.test(t):"string"==typeof t&&t.includes(e)}var dd,pd="user-interaction",fd=((od={}).click=!0,od),hd=function(t){function n(e){var n=t.call(this,pd,"1",e)||this;return n.handler=function(t){},n.stop=function(){},n}return e(n,t),n.prototype.enable=function(){var t,e=this;this.handler=function(t){var n;n=kc(sc.USER_INTERACTION)?Dc(pd):e.tracer.startSpan(pd);var r=t.target,o=Ac(),i=r.id,a=r.type,s=r.className,u=r.nodeName,l=ad(r,o);n.setAttribute(Bd.EVENT_TYPE,sc.USER_INTERACTION),n.setAttribute(Bd.INTERACTION_EVENT_NAME,t.type),r&&r instanceof HTMLElement&&[[Bd.ELEMENT_ID,i],[Bd.ELEMENT_CLASSES,s],[Bd.TARGET_ELEMENT_TYPE,a],[Bd.ELEMENT_INNER_TEXT,null==l?void 0:l.slice(0,Id)],[Bd.TARGET_ELEMENT,u]].forEach((function(t){var e=c(t,2),r=e[0],o=e[1];n.setAttribute(r,o)})),n.end()};var n=o(o({},fd),null===(t=this._config)||void 0===t?void 0:t.events),r=Object.entries(n).filter((function(t){var e=c(t,2);return e[0],e[1]})).map((function(t){return c(t,1)[0]}));this.stop=rd(document,r,this.handler,{capture:!0,passive:!0}).stop},n.prototype.disable=function(){this.stop()},n.prototype.init=function(){},n}(Ur),md="memory_usage",gd=function(t){function n(e){var n=t.call(this,md,"1.0.0",e)||this;return n.memoryUsageInterval=Ac().memoryUsageConfig.interval,n}return e(n,t),n.prototype.disable=function(){this.clearMeasurementsInterval()},n.prototype.enable=function(){this.startTrackingMemoryUsage()},n.prototype.init=function(){},n.prototype.startTrackingMemoryUsage=function(){var t=this;this.clearMeasurementsInterval(),this.createMemorySample().then((function(){return t.runMemoryMeasurements()}))},n.prototype.createMemorySample=function(){return a(this,void 0,void 0,(function(){var t,e,n,r,o,i,a,d,p;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,performance.measureUserAgentSpecificMemory()];case 1:t=s.sent(),e=function(t){var e,n,r=tc(),o={uuid:r,isParent:!0,bytes:t.bytes},i=[];try{for(var a=u(t.breakdown),s=a.next();!s.done;s=a.next()){var d=s.value;d.bytes>0&&i.push({uuid:r,bytes:d.bytes,attribution:d.attribution,types:d.types.sort().join(", ")})}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return l([o],c(i),!1)}(t);try{for(n=u(e),r=n.next();!r.done;r=n.next())o=r.value,(i=this.tracer.startSpan(md))[Bd.EVENT_TYPE]=sc.MEMORY_USAGE,i[Bd.MEMORY_USAGE_CONTEXT]=o,i.end()}catch(t){d={error:t}}finally{try{r&&!r.done&&(p=n.return)&&p.call(n)}finally{if(d)throw d.error}}return[3,3];case 2:return a=s.sent(),console.warn("Memory usage measurement failed",a),this.clearMeasurementsInterval(),[3,3];case 3:return[2]}}))}))},n.prototype.runMemoryMeasurements=function(){var t=this;this.timeoutId=setTimeout((function(){return t.measureMemoryUsage()}),this.memoryUsageInterval)},n.prototype.measureMemoryUsage=function(){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.createMemorySample()];case 1:return t.sent(),this.runMemoryMeasurements(),[2]}}))}))},n.prototype.clearMeasurementsInterval=function(){this.timeoutId&&clearTimeout(this.timeoutId)},n}(Ur),vd="screenshot",yd=function(t){function n(e){return t.call(this,vd,"1.0.0",e)||this}return e(n,t),n.prototype.init=function(){},n.prototype.disable=function(){},n.prototype.enable=function(){},n.prototype.screenshot=function(t,e){if(wc()){var n=this.tracer.startSpan(sc.SCREENSHOT);n.setAttribute(Bd.EVENT_TYPE,sc.SCREENSHOT),n.setAttribute(Bd.SEVERITY,dc.Info),n[Bd.SCREENSHOT_CONTEXT]={id:t,description:e},n.end()}},n}(Ur),Ed=function(){function t(){this.measurements=new Map}return t.prototype.startMeasurement=function(t,e){this.checkAndResetIfSessionExpired(),!this.measurements.has(t)&&t.trim()?this.measurements.set(t,{startTime:Date.now(),labels:e}):this.logDebug('Invalid or duplicate key: "'.concat(t,'".'))},t.prototype.getMeasurement=function(t){if(this.checkAndResetIfSessionExpired(),this.measurements.has(t)&&t.trim()){var e=this.measurements.get(t),n=e.startTime,r=e.labels;return this.measurements.delete(t),{duration:Date.now()-n,labels:r}}this.logDebug('Invalid or duplicate key: "'.concat(t,'".'))},t.prototype.checkAndResetIfSessionExpired=function(){Rc().isIdleActive&&this.measurements.clear()},t.prototype.logDebug=function(t){Ac().debug&&console.debug("Coralogix Browser SDK - ".concat(t))},t}(),_d=function(t){function n(e){return t.call(this,Il,"1.0.0",e)||this}return e(n,t),n.prototype.init=function(){},n.prototype.disable=function(){},n.prototype.enable=function(){},n.prototype.createCustomMeasurement=function(t,e,n){var r=this.tracer.startSpan(Il);r[Bd.EVENT_TYPE]=sc.CUSTOM_MEASUREMENT,r[Bd.CUSTOM_MEASUREMENT_CONTEXT]={name:t,value:e},Object.keys(n||{}).length>0&&r.setAttribute(Bd.CUSTOM_LABELS,JSON.stringify(n)),r.end()},n}(Ur),Td=function(t){function n(e){return t.call(this,sc.INTERNAL,"1",e)||this}return e(n,t),n.prototype.init=function(){},n.prototype.disable=function(){},n.prototype.enable=function(){},n.prototype.reportInternalEvent=function(t,e){void 0===e&&(e="");var n,r=this.tracer.startSpan(sc.INTERNAL);switch(r.setAttribute(Bd.EVENT_TYPE,sc.INTERNAL),r.setAttribute(Bd.SEVERITY,dc.Info),t){case"init":var o=El(Ac(),"public_key","coralogixDomain");n=this.stringifyConfig(o);break;case"recording-start":break;case"recording-stop":n=e}r.setAttribute(Bd.INTERNAL,JSON.stringify({event:t,data:n})),r.end()},n.prototype.stringifyConfig=function(t){return JSON.stringify(t,(function(t,e){return e instanceof RegExp?e.toString():e}))},n}(Ur),Sd=function(t){function n(e){var n=t.call(this,bl,"1.0.0",e)||this;return n.visibilityChangeHandler=function(){if(document.hidden){var t=n.tracer.startSpan(bl);t.setAttribute(Bd.EVENT_TYPE,sc.DOM),t.end()}},n}return e(n,t),n.prototype.registerToDOMEvents=function(){document.addEventListener("visibilitychange",this.visibilityChangeHandler)},n.prototype.unregisterFromDOMEvents=function(){document.removeEventListener("visibilitychange",this.visibilityChangeHandler)},n.prototype.init=function(){},n.prototype.disable=function(){this.unregisterFromDOMEvents()},n.prototype.enable=function(){var t=this;setTimeout((function(){t.registerToDOMEvents()}))},n}(Ur),bd="/browser/v1beta/logs",Id=1024,Cd=1024,Od=["application","version","coralogixDomain"],Rd="sdkConfig",wd="{id}",Ad="PAGE_URL_LABEL_PROVIDERS",Ld="NETWORK_URL_LABEL_PROVIDERS",Nd="rumInternalData",Md="***",xd=["password","email","tel"],Pd=[{pattern:new RegExp(/[0-9a-fA-F-]{36}/g),replacement:wd},{pattern:new RegExp(/^[a-zA-Z0-9-_]{21}$/),replacement:wd}],kd={pageUrlBlueprinters:[function(t){return function(t){var e,n,r=t.patterns,o=t.url;try{for(var i=u(r),a=i.next();!a.done;a=i.next()){var s=a.value,c=s.pattern,l=s.replacement;o=o.replace(c,l)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return o}({patterns:Pd,url:t})}]},Dd={ignoreUrls:[new RegExp(bd),new RegExp("/sessionrecording")],user_context:{user_id:"",user_name:""},labels:{},urlBlueprinters:kd,collectIPData:!0},Ud=[{Instrument:nl,confKey:Vc,disable:!1},{Instrument:fl,confKey:"fetch",disable:!1},{Instrument:ml,confKey:"xhr",disable:!1},{Instrument:gl,confKey:"custom",disable:!1},{Instrument:hd,confKey:"interactions",disable:!1},{Instrument:Ql,confKey:_l,disable:!1},{Instrument:ql,confKey:Tl,disable:!1},{Instrument:ed,confKey:Sl,disable:!1},{Instrument:Td,confKey:Ol,disable:!1},{Instrument:Sd,confKey:bl,disable:!1},{Instrument:_d,confKey:Il,disable:!1},{Instrument:gd,confKey:md,disable:!1},{Instrument:yd,confKey:vd,disable:!1}],Bd={USER_AGENT:"user_agent",LOCATION_HREF:"location_href",EVENT_TYPE:"event_type",SEVERITY:"severity",APPLICATION_CONTEXT:"application_context",USER_CONTEXT:"user_context",CUSTOM_MEASUREMENT_CONTEXT:"custom_measurement_context",MEMORY_USAGE_CONTEXT:"memory_usage_context",COUNTRY:"country",SOURCE:"source",ERROR:Yc,LOG:"cx_log",CUSTOM_LABELS:"custom_labels",ENVIRONMENT:"environment",INTERACTION_EVENT_NAME:"interaction_event_name",ELEMENT_INNER_TEXT:"element_inner_text",ELEMENT_INNER_HTML:"element_inner_html",ELEMENT_ID:"element_id",ELEMENT_CLASSES:"element_classes",TARGET_XPATH:"target_xpath",TARGET_ELEMENT:"target_element",TARGET_ELEMENT_TYPE:"target_element_type",TIMESTAMP:"timestamp",INTERNAL:"internal",PAGE_CONTEXT:"page_context",IS_NAVIGATION_EVENT:"is_navigation_event",SCREENSHOT_CONTEXT:"screenshot_context"},Fd={EU1:"https://ingress.eu1.rum-ingress-coralogix.com",EU2:"https://ingress.eu2.rum-ingress-coralogix.com",US1:"https://ingress.us1.rum-ingress-coralogix.com",US2:"https://ingress.us2.rum-ingress-coralogix.com",AP1:"https://ingress.ap1.rum-ingress-coralogix.com",AP2:"https://ingress.ap2.rum-ingress-coralogix.com",AP3:"https://ingress.ap3.rum-ingress-coralogix.com",STAGING:"https://ingress.staging.rum-ingress-coralogix.com"},jd="cx_mapped_span",Gd="/";function Wd(t,e){Cc[Nd]||(Cc[Nd]={}),Cc[Nd][t]=e}function Xd(t){var e;return null===(e=Cc[Nd])||void 0===e?void 0:e[t]}var Hd=(null===(dd=null==Cc?void 0:Cc.PerformanceObserver)||void 0===dd?void 0:dd.supportedEntryTypes)?new Set(Cc.PerformanceObserver.supportedEntryTypes):new Set;function Vd(t,e){return e.some((function(e){return t.endsWith(e)||t.includes(e)}))}var Yd=function(t){var e=c(t,2),n=e[0],r=e[1];return 1e3*n+Math.round(r/1e6)},zd=function(t){return!!t&&t>=400},Zd=function(t){var e,n;if(!t)return"";var r=(null===(e=t.split("://"))||void 0===e?void 0:e[1])||t,o=null===(n=r.split(Gd))||void 0===n?void 0:n[1];if(null==o?void 0:o.startsWith("#")){var i=r.split("#")[1].split("?")[0].split(Gd);return i.length&&i.shift(),i.join(Gd)||Gd}try{return t.startsWith("blob:")?t:new URL(t).pathname.substring(1)||Gd}catch(e){return console.warn("Coralogix Browser SDK - Error parsing URL",e),t}};function Kd(t){var e,n,r,o,i,a,s,l,d="Unknown",p="Unknown",f="Unknown",h="Unknown",m="Desktop";try{for(var g=u(Object.entries({Chrome:/Chrome\/([\d.]+)/,Firefox:/Firefox\/([\d.]+)/,Safari:/Version\/([\d.]+).*Safari/,Edge:/Edge\/([\d.]+)/,Opera:/Opera\/([\d.]+)/,IE:/Trident.*rv:([\d.]+)/})),v=g.next();!v.done;v=g.next()){var y=c(v.value,2),E=y[0],_=y[1];if(R=t.match(_)){d=E,p=R[1]||"Unknown";break}}}catch(t){e={error:t}}finally{try{v&&!v.done&&(n=g.return)&&n.call(g)}finally{if(e)throw e.error}}try{for(var T=u(Object.entries({Windows:/Windows NT ([\d.]+)/,MacOS:/Mac OS X ([\d._]+)/,Linux:/Linux(?: ([\d.]+))?/,iOS:/CPU(?: iPhone)? OS (\d+([._]\d+)*)/,Android:/Android (\d+([._]\d+)*)/})),S=T.next();!S.done;S=T.next()){var b=c(S.value,2),I=b[0];if(_=b[1],R=t.match(_)){f=I,h=(null===(l=null===(s=R[1])||void 0===s?void 0:s.split("_"))||void 0===l?void 0:l.join("."))||"Unknown";break}}}catch(t){r={error:t}}finally{try{S&&!S.done&&(o=T.return)&&o.call(T)}finally{if(r)throw r.error}}try{for(var C=u(Object.entries({Mobile:/Mobile|Android|iPhone|iPod|BlackBerry|IEMobile|Windows Phone|webOS|Opera Mini/,Tablet:/Tablet|iPad/})),O=C.next();!O.done;O=C.next()){var R,w=c(O.value,2),A=w[0];if(_=w[1],R=t.match(_)){m=A;break}}}catch(t){i={error:t}}finally{try{O&&!O.done&&(a=C.return)&&a.call(C)}finally{if(i)throw i.error}}return{browser:d,browserVersion:p,os:f,osVersion:h,device:m}}function Jd(){return"v3-".concat(fc(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}function Qd(t){switch(!0){case t>600:return"poor";case t>200&&t<=600:return"needs-improvement";default:return"good"}}function qd(t){var e,n,r=JSON.parse(t[Bd.CUSTOM_LABELS]),o=El(t,Bd.CUSTOM_LABELS);try{for(var i=u(Object.entries(r)),a=i.next();!a.done;a=i.next()){var s=c(a.value,2),l=s[0],d=s[1];o[l]="string"!=typeof d?JSON.stringify(d):d}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return o}var $d=function(){var t=new WeakSet;return function(e,n){if("object"==typeof n&&null!==n){if(t.has(n))return;t.add(n)}return n}};function tp(t){var e=t.url,n=t.blueprinters,r=e;return null==n||n.forEach((function(t){return r=t(r)})),r}function ep(t){return JSON.parse(JSON.stringify(t))}var np=function(){function t(t){var e;this.labels=((e={})[Bd.CUSTOM_LABELS]="{}",e),t&&(this.labels=t)}return t.prototype.setCustomLabels=function(t){this.labels[Bd.CUSTOM_LABELS]=JSON.stringify(null!=t?t:{})},t.prototype.setInternalLabels=function(t){var e;this.labels=o(((e={})[Bd.CUSTOM_LABELS]=this.labels[Bd.CUSTOM_LABELS],e),t?this.stringifyValues(t):{})},t.prototype.getLabels=function(){return JSON.parse(JSON.stringify(this.labels))},t.prototype.getCustomLabels=function(){return JSON.parse(this.labels[Bd.CUSTOM_LABELS])},t.prototype.getInternalLabels=function(){var t=o({},this.labels);return delete t[Bd.CUSTOM_LABELS],t},t.prototype.getUserContext=function(){var t=this.labels[Bd.USER_CONTEXT];return t?JSON.parse("".concat(t)):void 0},t.prototype.forceFlush=function(){return Promise.resolve()},t.prototype.onStart=function(t){t.setAttribute(Bd.TIMESTAMP,fc()),t.setAttribute(Bd.USER_AGENT,navigator.userAgent),t.setAttributes(this.labels)},t.prototype.onEnd=function(){},t.prototype.shutdown=function(){return Promise.resolve()},t.prototype.stringifyValues=function(t){var e={};for(var n in t)e[n]="string"==typeof t[n]?t[n]:JSON.stringify(t[n]);return e},t}(),rp=w("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function op(t){return!0===t.getValue(rp)}var ip,ap="baggage",sp=function(){function t(){}return t.prototype.inject=function(t,e,n){var r=ve.getBaggage(t);if(r&&!op(t)){var o=function(t){return t.getAllEntries().map((function(t){var e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(t,2),n=e[0],r=e[1],o=encodeURIComponent(n)+"="+encodeURIComponent(r.value);return void 0!==r.metadata&&(o+=";"+r.metadata.toString()),o}))}(r).filter((function(t){return t.length<=4096})).slice(0,180),i=function(t){return t.reduce((function(t,e){var n=t+(""!==t?",":"")+e;return n.length>8192?t:n}),"")}(o);i.length>0&&n.set(e,ap,i)}},t.prototype.extract=function(t,e,n){var r=n.get(e,ap),o=Array.isArray(r)?r.join(","):r;if(!o)return t;var i={};return 0===o.length?t:(o.split(",").forEach((function(t){var e=function(t){var e=t.split(";");if(!(e.length<=0)){var n=e.shift();if(n){var r=n.indexOf("=");if(!(r<=0)){var o,i=decodeURIComponent(n.substring(0,r).trim()),a=decodeURIComponent(n.substring(r+1).trim());return e.length>0&&(o=de(e.join(";"))),{key:i,value:a,metadata:o}}}}}(t);if(e){var n={value:e.value};e.metadata&&(n.metadata=e.metadata),i[e.key]=n}})),0===Object.entries(i).length?t:ve.setBaggage(t,ve.createBaggage(i)))},t.prototype.fields=function(){return[ap]},t}();!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"}(ip||(ip={}));var up=function(){function t(t){var e;void 0===t&&(t={}),this._propagators=null!==(e=t.propagators)&&void 0!==e?e:[],this._fields=Array.from(new Set(this._propagators.map((function(t){return"function"==typeof t.fields?t.fields():[]})).reduce((function(t,e){return t.concat(e)}),[])))}return t.prototype.inject=function(t,e,n){var r,o;try{for(var i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(this._propagators),a=i.next();!a.done;a=i.next()){var s=a.value;try{s.inject(t,e,n)}catch(t){R.warn("Failed to inject with "+s.constructor.name+". Err: "+t.message)}}}catch(t){r={error:t}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}},t.prototype.extract=function(t,e,n){return this._propagators.reduce((function(t,r){try{return r.extract(t,e,n)}catch(t){R.warn("Failed to inject with "+r.constructor.name+". Err: "+t.message)}return t}),t)},t.prototype.fields=function(){return this._fields.slice()},t}(),cp="[_0-9a-z-*/]",lp=new RegExp("^(?:[a-z]"+cp+"{0,255}|[a-z0-9]"+cp+"{0,240}@[a-z]"+cp+"{0,13})$"),dp=/^[ -~]{0,255}[!-~]$/,pp=/,|=/,fp=function(){function t(t){this._internalState=new Map,t&&this._parse(t)}return t.prototype.set=function(t,e){var n=this._clone();return n._internalState.has(t)&&n._internalState.delete(t),n._internalState.set(t,e),n},t.prototype.unset=function(t){var e=this._clone();return e._internalState.delete(t),e},t.prototype.get=function(t){return this._internalState.get(t)},t.prototype.serialize=function(){var t=this;return this._keys().reduce((function(e,n){return e.push(n+"="+t.get(n)),e}),[]).join(",")},t.prototype._parse=function(t){t.length>512||(this._internalState=t.split(",").reverse().reduce((function(t,e){var n=e.trim(),r=n.indexOf("=");if(-1!==r){var o=n.slice(0,r),i=n.slice(r+1,e.length);(function(t){return lp.test(t)})(o)&&function(t){return dp.test(t)&&!pp.test(t)}(i)&&t.set(o,i)}return t}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},t.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},t.prototype._clone=function(){var e=new t;return e._internalState=new Map(this._internalState),e},t}(),hp="traceparent",mp="tracestate",gp=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$"),vp=function(){function t(){}return t.prototype.inject=function(t,e,n){var r=qt.getSpanContext(t);if(r&&!op(t)&&Xt(r)){var o="00-"+r.traceId+"-"+r.spanId+"-0"+Number(r.traceFlags||C.NONE).toString(16);n.set(e,hp,o),r.traceState&&n.set(e,mp,r.traceState.serialize())}},t.prototype.extract=function(t,e,n){var r=n.get(e,hp);if(!r)return t;var o=Array.isArray(r)?r[0]:r;if("string"!=typeof o)return t;var i=function(t){var e=gp.exec(t);return e?"00"===e[1]&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}:null}(o);if(!i)return t;i.isRemote=!0;var a=n.get(e,mp);if(a){var s=Array.isArray(a)?a.join(","):a;i.traceState=new fp("string"==typeof s?s:void 0)}return qt.setSpanContext(t,i)},t.prototype.fields=function(){return[hp,mp]},t}();({})[sc.WEB_VITALS]=!0;var yp=function(){function t(t){this.requestConfig=t,this.resolvedUrl="",this.resolvedHeaders={},this.init()}return t.prototype.init=function(){var t=Ac(),e=t.proxyUrl,n=t.coralogixDomain,r=t.public_key,o=this.requestConfig,i=o.suffix,a=o.headers,s="".concat(Fd[n]).concat(i);this.resolvedUrl=e?"".concat(e,"?").concat("cxforward","=").concat(encodeURIComponent(s)):s,r&&(a.Authorization="Bearer ".concat(r)),this.resolvedHeaders=a},t.prototype.send=function(t){return fetch(this.resolvedUrl,{method:"POST",headers:this.resolvedHeaders,body:t}).catch((function(t){return t}))},t}(),Ep=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:r.RECORD}},t}();function _p(t){var e,n,r,i;return t?o(o({},t),{maxRumEvents:(i=t.maxRumEvents,i?i>2e4?2e4:i:5e3),maxRecordTime:(r=t.maxRecordTime,r?r>6e4?6e4:r:1e4),instrumentationsToSend:null!==(n=t.instrumentationsToSend)&&void 0!==n?n:(e={},e[sc.WEB_VITALS]=!0,e)}):{enable:!1}}function Tp(t){var e;return t?o(o({},t),{sessionSampleRate:null!==(e=t.sessionSampleRate)&&void 0!==e?e:100,onlyWithErrorConfig:_p(t.onlyWithErrorConfig)}):yc}function Sp(t){var e;if(t)return o(o({},t),{sessionRecordingSampleRate:null!==(e=t.sessionRecordingSampleRate)&&void 0!==e?e:100})}function bp(t){return t>0&&100*Math.random()<=t}function Ip(t){var e;return!t||!!(null===(e=Rc())||void 0===e?void 0:e.isIdleActive)}var Cp=function(){function t(){var t=this;this.isActive=!0,this.sdkConfig=Ac(),this.request=new yp({suffix:bd,headers:{"Content-Type":"application/json"}}),this.batchTimeDelay=mc,this.invokeLogRequest=function(e,n){(null==e?void 0:e.length)&&t.request.send(JSON.stringify({logs:e,skip_enrichment_with_ip:!t.sdkConfig.collectIPData})).then((function(){n&&(Rc().cachedLogsSent=!0)}))}}return t.prototype.export=function(t,e){if(Ip(this.isActive))e({code:ip.SUCCESS});else{var n=t.reduce((function(t,e){return e[jd]&&t.push(e[jd]),t}),[]);!function(){var t=Rc(),e=t.onlySessionWithErrorMode,n=t.cachedLogsSent;return e&&!n}()?this.invokeLogRequest(n):this.handleSessionWithError(n),e({code:ip.SUCCESS})}},t.prototype.handleSessionWithError=function(t){var e=this,n=Rc(),r=n.maxRumEventsForSessionWithError,o=n.instrumentationsToSend,i=n.sessionHasError,a=[];t=t.reduce((function(t,e){return o&&o[e.text.cx_rum.event_context.type]?a.push(e):t.push(e),t}),[]),this.invokeLogRequest(a);var s=Cc.cachedLogs=l(l([],c(Cc.cachedLogs||[]),!1),c(t),!1),u=s.length;if(u>r&&!i)this.clearCachedDataForSessionWithError();else if(i)if(u>500){for(var d=[],p=0;p<u;p+=500)d.push(s.slice(p,p+500));d.forEach((function(t){setTimeout((function(){return e.invokeLogRequest(t,!0)}),e.batchTimeDelay),e.batchTimeDelay+=mc})),this.clearCachedDataForSessionWithError()}else this.invokeLogRequest(s,!0),this.clearCachedDataForSessionWithError()},t.prototype.clearCachedDataForSessionWithError=function(){Cc.cachedLogs=[],this.batchTimeDelay=mc},t.prototype.shutdown=function(){return this.isActive=!1,Promise.resolve()},t}(),Op=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n}(rr),Rp=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))(Rp||{}),wp=Object.defineProperty,Ap=(t,e,n)=>(((t,e,n)=>{e in t?wp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n),Lp=(t=>(t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment",t))(Lp||{});function Np(t){return"[object ShadowRoot]"===Object.prototype.toString.call(t)}function Mp(t){try{const n=t.rules||t.cssRules;return n?((e=Array.from(n,xp).join("")).includes(" background-clip: text;")&&!e.includes(" -webkit-background-clip: text;")&&(e=e.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),e):null}catch(t){return null}var e}function xp(t){let e;if(function(t){return"styleSheet"in t}(t))try{e=Mp(t.styleSheet)||function(t){const{cssText:e}=t;if(e.split('"').length<3)return e;const n=["@import",`url(${JSON.stringify(t.href)})`];return""===t.layerName?n.push("layer"):t.layerName&&n.push(`layer(${t.layerName})`),t.supportsText&&n.push(`supports(${t.supportsText})`),t.media.length&&n.push(t.media.mediaText),n.join(" ")+";"}(t)}catch(t){}else if(function(t){return"selectorText"in t}(t)&&t.selectorText.includes(":"))return t.cssText.replace(/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm,"$1\\$2");return e||t.cssText}class Pp{constructor(){Ap(this,"idNodeMap",new Map),Ap(this,"nodeMetaMap",new WeakMap)}getId(t){var e;return t?(null==(e=this.getMeta(t))?void 0:e.id)??-1:-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const e=this.getId(t);this.idNodeMap.delete(e),t.childNodes&&t.childNodes.forEach((t=>this.removeNodeFromMap(t)))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,e){const n=e.id;this.idNodeMap.set(n,t),this.nodeMetaMap.set(t,e)}replace(t,e){const n=this.getNode(t);if(n){const t=this.nodeMetaMap.get(n);t&&this.nodeMetaMap.set(e,t)}this.idNodeMap.set(t,e)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function kp(t){return t.toLowerCase()}const Dp="__rrweb_original__";function Up(t){const e=t.type;return t.hasAttribute("data-rr-is-password")?"password":e?kp(e):null}function Bp(t,e){let n;try{n=new URL(t,e??window.location.href)}catch(t){return null}const r=n.pathname.match(/\.([0-9a-z]+)(?:$)/i);return(null==r?void 0:r[1])??null}let Fp=1;const jp=new RegExp("[^a-z0-9-_:]");let Gp,Wp;const Xp=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,Hp=/^(?:[a-z+]+:)?\/\//i,Vp=/^www\..*/i,Yp=/^(data:)([^,]*),(.*)/i;function zp(t,e){return(t||"").replace(Xp,((t,n,r,o,i,a)=>{const s=r||i||a,u=n||o||"";if(!s)return t;if(Hp.test(s)||Vp.test(s))return`url(${u}${s}${u})`;if(Yp.test(s))return`url(${u}${s}${u})`;if("/"===s[0])return`url(${u}${function(t){let e="";return e=t.indexOf("//")>-1?t.split("/").slice(0,3).join("/"):t.split("/")[0],e=e.split("?")[0],e}(e)+s}${u})`;const c=e.split("/"),l=s.split("/");c.pop();for(const t of l)"."!==t&&(".."===t?c.pop():c.push(t));return`url(${u}${c.join("/")}${u})`}))}const Zp=/^[^ \t\n\r\u000c]+/,Kp=/^[, \t\n\r\u000c]+/,Jp=new WeakMap;function Qp(t,e){return e&&""!==e.trim()?qp(t,e):e}function qp(t,e){let n=Jp.get(t);if(n||(n=t.createElement("a"),Jp.set(t,n)),e){if(e.startsWith("blob:")||e.startsWith("data:"))return e}else e="";return n.setAttribute("href",e),n.href}function $p(t,e,n,r){return r?"src"===n||"href"===n&&("use"!==e||"#"!==r[0])||"xlink:href"===n&&"#"!==r[0]?Qp(t,r):"background"!==n||"table"!==e&&"td"!==e&&"th"!==e?"srcset"===n?function(t,e){if(""===e.trim())return e;let n=0;function r(t){let r;const o=t.exec(e.substring(n));return o?(r=o[0],n+=r.length,r):""}const o=[];for(;r(Kp),!(n>=e.length);){let i=r(Zp);if(","===i.slice(-1))i=Qp(t,i.substring(0,i.length-1)),o.push(i);else{let r="";i=Qp(t,i);let a=!1;for(;;){const t=e.charAt(n);if(""===t){o.push((i+r).trim());break}if(a)")"===t&&(a=!1);else{if(","===t){n+=1,o.push((i+r).trim());break}"("===t&&(a=!0)}r+=t,n+=1}}}return o.join(", ")}(t,r):"style"===n?zp(r,qp(t)):"object"===e&&"data"===n?Qp(t,r):r:Qp(t,r):r}function tf(t,e,n){return("video"===t||"audio"===t)&&"autoplay"===e}function ef(t,e,n){if(!t)return!1;if(t.nodeType!==t.ELEMENT_NODE)return!!n&&ef(t.parentNode,e,n);for(let n=t.classList.length;n--;){const r=t.classList[n];if(e.test(r))return!0}return!!n&&ef(t.parentNode,e,n)}function nf(t,e,n,r){try{const o=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(null===o)return!1;if("string"==typeof e){if(r){if(o.closest(`.${e}`))return!0}else if(o.classList.contains(e))return!0}else if(ef(o,e,r))return!0;if(n)if(r){if(o.closest(n))return!0}else if(o.matches(n))return!0}catch(t){}return!1}function rf(t){return null==t?"":t.toLowerCase()}function of(t,e){const{doc:n,mirror:r,blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:s,skipChild:u=!1,inlineStylesheet:c=!0,maskInputOptions:l={},maskTextFn:d,maskInputFn:p,slimDOMOptions:f,dataURLOptions:h={},inlineImages:m=!1,recordCanvas:g=!1,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E=5e3,onStylesheetLoad:_,stylesheetLoadTimeout:T=5e3,keepIframeSrcFn:S=()=>!1,newlyAddedElement:b=!1}=e;let{needsMask:I}=e,{preserveWhiteSpace:C=!0}=e;!I&&t.childNodes&&(I=nf(t,a,s,void 0===I));const O=function(t,e){const{doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:a,inlineStylesheet:s,maskInputOptions:u={},maskTextFn:c,maskInputFn:l,dataURLOptions:d={},inlineImages:p,recordCanvas:f,keepIframeSrcFn:h,newlyAddedElement:m=!1}=e,g=function(t,e){if(!e.hasNode(t))return;const n=e.getId(t);return 1===n?void 0:n}(n,r);switch(t.nodeType){case t.DOCUMENT_NODE:return"CSS1Compat"!==t.compatMode?{type:Lp.Document,childNodes:[],compatMode:t.compatMode}:{type:Lp.Document,childNodes:[]};case t.DOCUMENT_TYPE_NODE:return{type:Lp.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:g};case t.ELEMENT_NODE:return function(t,e){const{doc:n,blockClass:r,blockSelector:o,inlineStylesheet:i,maskInputOptions:a={},maskInputFn:s,dataURLOptions:u={},inlineImages:c,recordCanvas:l,keepIframeSrcFn:d,newlyAddedElement:p=!1,rootId:f}=e,h=function(t,e,n){try{if("string"==typeof e){if(t.classList.contains(e))return!0}else for(let n=t.classList.length;n--;){const r=t.classList[n];if(e.test(r))return!0}if(n)return t.matches(n)}catch(t){}return!1}(t,r,o),m=function(t){if(t instanceof HTMLFormElement)return"form";const e=kp(t.tagName);return jp.test(e)?"div":e}(t);let g={};const v=t.attributes.length;for(let e=0;e<v;e++){const r=t.attributes[e];tf(m,r.name,r.value)||(g[r.name]=$p(n,m,kp(r.name),r.value))}if("link"===m&&i){const e=Array.from(n.styleSheets).find((e=>e.href===t.href));let r=null;e&&(r=Mp(e)),r&&(delete g.rel,delete g.href,g._cssText=zp(r,e.href))}if("style"===m&&t.sheet&&!(t.innerText||t.textContent||"").trim().length){const e=Mp(t.sheet);e&&(g._cssText=zp(e,qp(n)))}if("input"===m||"textarea"===m||"select"===m){const e=t.value,n=t.checked;"radio"!==g.type&&"checkbox"!==g.type&&"submit"!==g.type&&"button"!==g.type&&e?g.value=function({element:t,maskInputOptions:e,tagName:n,type:r,value:o,maskInputFn:i}){let a=o||"";const s=r&&kp(r);return(e[n.toLowerCase()]||s&&e[s])&&(a=i?i(a,t):"*".repeat(a.length)),a}({element:t,type:Up(t),tagName:m,value:e,maskInputOptions:a,maskInputFn:s}):n&&(g.checked=n)}if("option"===m&&(t.selected&&!a.select?g.selected=!0:delete g.selected),"canvas"===m&&l)if("2d"===t.__context)(function(t){const e=t.getContext("2d");if(!e)return!0;for(let n=0;n<t.width;n+=50)for(let r=0;r<t.height;r+=50){const o=e.getImageData,i=Dp in o?o[Dp]:o;if(new Uint32Array(i.call(e,n,r,Math.min(50,t.width-n),Math.min(50,t.height-r)).data.buffer).some((t=>0!==t)))return!1}return!0})(t)||(g.rr_dataURL=t.toDataURL(u.type,u.quality));else if(!("__context"in t)){const e=t.toDataURL(u.type,u.quality),r=n.createElement("canvas");r.width=t.width,r.height=t.height,e!==r.toDataURL(u.type,u.quality)&&(g.rr_dataURL=e)}if("img"===m&&c){Gp||(Gp=n.createElement("canvas"),Wp=Gp.getContext("2d"));const e=t,r=e.currentSrc||e.getAttribute("src")||"<unknown-src>",o=e.crossOrigin,i=()=>{e.removeEventListener("load",i);try{Gp.width=e.naturalWidth,Gp.height=e.naturalHeight,Wp.drawImage(e,0,0),g.rr_dataURL=Gp.toDataURL(u.type,u.quality)}catch(t){if("anonymous"!==e.crossOrigin)return e.crossOrigin="anonymous",void(e.complete&&0!==e.naturalWidth?i():e.addEventListener("load",i));console.warn(`Cannot inline img src=${r}! Error: ${t}`)}"anonymous"===e.crossOrigin&&(o?g.crossOrigin=o:e.removeAttribute("crossorigin"))};e.complete&&0!==e.naturalWidth?i():e.addEventListener("load",i)}if("audio"===m||"video"===m){const e=g;e.rr_mediaState=t.paused?"paused":"played",e.rr_mediaCurrentTime=t.currentTime,e.rr_mediaPlaybackRate=t.playbackRate,e.rr_mediaMuted=t.muted,e.rr_mediaLoop=t.loop,e.rr_mediaVolume=t.volume}if(p||(t.scrollLeft&&(g.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(g.rr_scrollTop=t.scrollTop)),h){const{width:e,height:n}=t.getBoundingClientRect();g={class:g.class,rr_width:`${e}px`,rr_height:`${n}px`}}let y;"iframe"!==m||d(g.src)||(t.contentDocument||(g.rr_src=g.src),delete g.src);try{customElements.get(m)&&(y=!0)}catch(t){}return{type:Lp.Element,tagName:m,attributes:g,childNodes:[],isSVG:(E=t,Boolean("svg"===E.tagName||E.ownerSVGElement)||void 0),needBlock:h,rootId:f,isCustom:y};var E}(t,{doc:n,blockClass:o,blockSelector:i,inlineStylesheet:s,maskInputOptions:u,maskInputFn:l,dataURLOptions:d,inlineImages:p,recordCanvas:f,keepIframeSrcFn:h,newlyAddedElement:m,rootId:g});case t.TEXT_NODE:return function(t,e){var n;const{needsMask:r,maskTextFn:o,rootId:i}=e,a=t.parentNode&&t.parentNode.tagName;let s=t.textContent;const u="STYLE"===a||void 0,c="SCRIPT"===a||void 0;if(u&&s){try{t.nextSibling||t.previousSibling||(null==(n=t.parentNode.sheet)?void 0:n.cssRules)&&(s=Mp(t.parentNode.sheet))}catch(e){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${e}`,t)}s=zp(s,qp(e.doc))}return c&&(s="SCRIPT_PLACEHOLDER"),!u&&!c&&s&&r&&(s=o?o(s,t.parentElement):s.replace(/[\S]/g,"*")),{type:Lp.Text,textContent:s||"",isStyle:u,rootId:i}}(t,{doc:n,needsMask:a,maskTextFn:c,rootId:g});case t.CDATA_SECTION_NODE:return{type:Lp.CDATA,textContent:"",rootId:g};case t.COMMENT_NODE:return{type:Lp.Comment,textContent:t.textContent||"",rootId:g};default:return!1}}(t,{doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:I,inlineStylesheet:c,maskInputOptions:l,maskTextFn:d,maskInputFn:p,dataURLOptions:h,inlineImages:m,recordCanvas:g,keepIframeSrcFn:S,newlyAddedElement:b});if(!O)return console.warn(t,"not serialized"),null;let R;R=r.hasNode(t)?r.getId(t):!function(t,e){if(e.comment&&t.type===Lp.Comment)return!0;if(t.type===Lp.Element){if(e.script&&("script"===t.tagName||"link"===t.tagName&&("preload"===t.attributes.rel||"modulepreload"===t.attributes.rel)&&"script"===t.attributes.as||"link"===t.tagName&&"prefetch"===t.attributes.rel&&"string"==typeof t.attributes.href&&"js"===Bp(t.attributes.href)))return!0;if(e.headFavicon&&("link"===t.tagName&&"shortcut icon"===t.attributes.rel||"meta"===t.tagName&&(rf(t.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===rf(t.attributes.name)||"icon"===rf(t.attributes.rel)||"apple-touch-icon"===rf(t.attributes.rel)||"shortcut icon"===rf(t.attributes.rel))))return!0;if("meta"===t.tagName){if(e.headMetaDescKeywords&&rf(t.attributes.name).match(/^description|keywords$/))return!0;if(e.headMetaSocial&&(rf(t.attributes.property).match(/^(og|twitter|fb):/)||rf(t.attributes.name).match(/^(og|twitter):/)||"pinterest"===rf(t.attributes.name)))return!0;if(e.headMetaRobots&&("robots"===rf(t.attributes.name)||"googlebot"===rf(t.attributes.name)||"bingbot"===rf(t.attributes.name)))return!0;if(e.headMetaHttpEquiv&&void 0!==t.attributes["http-equiv"])return!0;if(e.headMetaAuthorship&&("author"===rf(t.attributes.name)||"generator"===rf(t.attributes.name)||"framework"===rf(t.attributes.name)||"publisher"===rf(t.attributes.name)||"progid"===rf(t.attributes.name)||rf(t.attributes.property).match(/^article:/)||rf(t.attributes.property).match(/^product:/)))return!0;if(e.headMetaVerification&&("google-site-verification"===rf(t.attributes.name)||"yandex-verification"===rf(t.attributes.name)||"csrf-token"===rf(t.attributes.name)||"p:domain_verify"===rf(t.attributes.name)||"verify-v1"===rf(t.attributes.name)||"verification"===rf(t.attributes.name)||"shopify-checkout-api-token"===rf(t.attributes.name)))return!0}}return!1}(O,f)&&(C||O.type!==Lp.Text||O.isStyle||O.textContent.replace(/^\s+|\s+$/gm,"").length)?Fp++:-2;const w=Object.assign(O,{id:R});if(r.add(t,w),-2===R)return null;v&&v(t);let A=!u;if(w.type===Lp.Element){A=A&&!w.needBlock,delete w.needBlock;const e=t.shadowRoot;e&&Np(e)&&(w.isShadowHost=!0)}if((w.type===Lp.Document||w.type===Lp.Element)&&A){f.headWhitespace&&w.type===Lp.Element&&"head"===w.tagName&&(C=!1);const e={doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:I,maskTextClass:a,maskTextSelector:s,skipChild:u,inlineStylesheet:c,maskInputOptions:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:f,dataURLOptions:h,inlineImages:m,recordCanvas:g,preserveWhiteSpace:C,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E,onStylesheetLoad:_,stylesheetLoadTimeout:T,keepIframeSrcFn:S};if(w.type===Lp.Element&&"textarea"===w.tagName&&void 0!==w.attributes.value);else for(const n of Array.from(t.childNodes)){const t=of(n,e);t&&w.childNodes.push(t)}if(function(t){return t.nodeType===t.ELEMENT_NODE}(t)&&t.shadowRoot)for(const n of Array.from(t.shadowRoot.childNodes)){const r=of(n,e);r&&(Np(t.shadowRoot)&&(r.isShadow=!0),w.childNodes.push(r))}}return t.parentNode&&function(t){const e=null==t?void 0:t.host;return Boolean((null==e?void 0:e.shadowRoot)===t)}(t.parentNode)&&Np(t.parentNode)&&(w.isShadow=!0),w.type===Lp.Element&&"iframe"===w.tagName&&function(t,e,n){const r=t.contentWindow;if(!r)return;let o,i=!1;try{o=r.document.readyState}catch(t){return}if("complete"!==o){const r=setTimeout((()=>{i||(e(),i=!0)}),n);return void t.addEventListener("load",(()=>{clearTimeout(r),i=!0,e()}))}const a="about:blank";if(r.location.href!==a||t.src===a||""===t.src)return setTimeout(e,0),t.addEventListener("load",e);t.addEventListener("load",e)}(t,(()=>{const e=t.contentDocument;if(e&&y){const n=of(e,{doc:e,mirror:r,blockClass:o,blockSelector:i,needsMask:I,maskTextClass:a,maskTextSelector:s,skipChild:!1,inlineStylesheet:c,maskInputOptions:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:f,dataURLOptions:h,inlineImages:m,recordCanvas:g,preserveWhiteSpace:C,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E,onStylesheetLoad:_,stylesheetLoadTimeout:T,keepIframeSrcFn:S});n&&y(t,n)}}),E),w.type===Lp.Element&&"link"===w.tagName&&"string"==typeof w.attributes.rel&&("stylesheet"===w.attributes.rel||"preload"===w.attributes.rel&&"string"==typeof w.attributes.href&&"css"===Bp(w.attributes.href))&&function(t,e,n){let r,o=!1;try{r=t.sheet}catch(t){return}if(r)return;const i=setTimeout((()=>{o||(e(),o=!0)}),n);t.addEventListener("load",(()=>{clearTimeout(i),o=!0,e()}))}(t,(()=>{if(_){const e=of(t,{doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:I,maskTextClass:a,maskTextSelector:s,skipChild:!1,inlineStylesheet:c,maskInputOptions:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:f,dataURLOptions:h,inlineImages:m,recordCanvas:g,preserveWhiteSpace:C,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E,onStylesheetLoad:_,stylesheetLoadTimeout:T,keepIframeSrcFn:S});e&&_(t,e)}}),T),w}var af=function(t,e){var n=Xd(Ol);null==n||n.reportInternalEvent(t,e)};function sf(){var t=this,e=1048576;function n(t,e,n,r,o,i,a){void 0===a&&(a="sendRecordData");var s=new Blob([n],{type:"application/octet-stream"});self.postMessage({sessionId:t,sessionCreationDate:e,gzipBlob:s,chunkIndex:r,totalChunks:o,screenshotId:i,event:a})}!function(){try{importScripts("https://cdn.rum-ingress-coralogix.com/coralogix/browser/latest/pako_deflate.es5.min.js")}catch(t){try{importScripts("https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako_deflate.es5.min.js")}catch(t){self.postMessage({event:"stopRecording"})}}}(),self.onmessage=function(r){var o,i=r.data;if(!t.pako)return console.warn("Coralogix Browser SDK - Web worker not created due to missing pako library"),void self.postMessage({event:"stopRecording"});o=i.screenshotId?JSON.stringify(i.records):JSON.stringify(i.records).slice(1,-1);var a=i.sessionId,s=i.sessionCreationDate,u=i.screenshotId,c=t.pako.gzip(o),l=c.byteLength;if(l>=e)for(var d=Math.ceil(l/e),p=0;p<d;p++){var f=p*e,h=(p+1)*e;n(a,s,c.slice(f,h),p,d-1,u,"splitRecordData")}else n(a,s,c,void 0,void 0,u)},self.onerror=function(t){console.warn("Coralogix Browser SDK - Error from session recording worker:\n",t),self.postMessage({event:"stopRecording"})}}var uf=function(){function t(){}return t.prototype.loadAndCreateWorker=function(t){return a(this,void 0,void 0,(function(){var e,n,r,o;return s(this,(function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),t?[4,this.loadWorkerScript(t)]:[3,2];case 1:return e=i.sent(),[3,3];case 2:e="(".concat(sf.toString(),")()"),i.label=3;case 3:return n=new Blob([e],{type:"application/javascript"}),r=URL.createObjectURL(n),[2,new Worker(r)];case 4:return o=i.sent(),console.warn("CoralogixRum: Error creating worker ".concat(o)),[2,void 0];case 5:return[2]}}))}))},t.prototype.loadWorkerScript=function(t){return a(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,fetch(this.getFullWorkerUrl(t))];case 1:return(e=n.sent()).ok?[4,e.text()]:(console.warn("CoralogixRum: Error fetching custom web worker"),[2,""]);case 2:return[2,n.sent()];case 3:return n.sent(),console.warn("CoralogixRum: Error fetching custom web worker"),[2,""];case 4:return[2]}}))}))},t.prototype.getFullWorkerUrl=function(t){return t.startsWith("http://")||t.startsWith("https://")?t:"".concat(Cc.location.origin).concat(t)},t}(),cf=function(){function t(t,e){var n,r=this;this.isAutoStartRecording=!1,this.onlySessionWithErrorMode=!1,this.recordEvents=[],this.recordEventsForSessionWithError=[[],[]],this.segmentIndexCounter={},this.hasRecording=!1,this.hasScreenshot=!1,this.recordingStopped=!1,this.batchTimeDelay=mc,this.isErrorOccurred=!1,this.debugMode=!!(null===(n=Ac())||void 0===n?void 0:n.debug),this._recordingStopDueToTimeout=!1,this.handleRecordEvent=function(t,e){r.recordingStopped||(r.onlySessionWithErrorMode?r.handleRecordEventForSessionWithError(t,e):r.recordEvents.push(t))},this.prepareRecordEventsBeforeSend=function(){if(r.onlySessionWithErrorMode)r.prepareRecordEventsForSessionWithError();else{if(!r.recordEvents.length)return;r.compressRecordData(r.recordEvents),r.resetBatching()}},this.sendRecordEvents=function(t,e){var n=new FormData,o=r.getMetadata(t,e);n.append("chunk",t.gzipBlob),n.append("metaData",JSON.stringify(o));var i=function(){return a(r,void 0,void 0,(function(){var t,e,r;return s(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),this.isErrorOccurred?[3,2]:[4,null===(r=this.request)||void 0===r?void 0:r.send(n)];case 1:return e=o.sent(),[3,3];case 2:e=void 0,o.label=3;case 3:return t=e,this.handleSessionRecordingResponse(t),[3,5];case 4:return o.sent(),this.handleSessionRecordingResponse(void 0),[3,5];case 5:return[2]}}))}))};e?(r.batchTimeout=setTimeout(i,r.batchTimeDelay),r.batchTimeDelay+=mc):(i(),r.batchTimeDelay=mc)},Cc[_c]=this,this.sessionManager=t;var o=t.onlySessionWithErrorMode,i=t.maxRecordTimeForSessionWithError,u=e.maxMutations,c=e.autoStartSessionRecording,l=e.workerUrl;this.onlySessionWithErrorMode=o,this.maxRecordTimeForSessionWithError=i,this.isAutoStartRecording=c,this.maxMutations=null!=u?u:5e3,this.recordConfig=this.prepareRecordConfig(e),Cc.Worker?(this.workerManager=new uf,this.initializeSessionWorker(l)):this.debugMode&&console.warn("Coralogix Browser SDK - Recording is not supported on this platform")}return t.prototype.getSessionHasScreenshot=function(){return this.hasScreenshot},t.prototype.getSessionHasRecording=function(){var t;return this.hasRecording&&!!this.segmentIndexCounter[null===(t=this.sessionManager.getActiveSession())||void 0===t?void 0:t.sessionId]},t.prototype.updateSegmentIndexCounter=function(t){this.segmentIndexCounter=t},t.prototype.getIsAutoStartRecording=function(){return this.isAutoStartRecording},Object.defineProperty(t.prototype,"recordingStopDueToTimeout",{get:function(){return this._recordingStopDueToTimeout},set:function(t){this._recordingStopDueToTimeout=t},enumerable:!1,configurable:!0}),t.prototype.startRecording=function(){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.isWorkerReady];case 1:return t.sent(),!this.sessionWorker||this.recordRef||(this.debugMode&&console.debug("Coralogix Browser SDK - Session recording started"),this.startMutationObserver(),this.resetBatching(),this.hasRecording=!0,this.recordingStopped=!1,this.isErrorOccurred=!1,this.recordingStopDueToTimeout=!1,this.recordRef=$s(this.recordConfig),this.startBatchingRecords()),[2]}}))}))},t.prototype.screenshot=function(t){this.hasScreenshot=!0;var e=this.sessionManager.getActiveSession()||{},n=e.sessionId,r=e.sessionCreationDate,o=function(t,e){const{mirror:n=new Pp,blockClass:r="rr-block",blockSelector:o=null,maskTextClass:i="rr-mask",maskTextSelector:a=null,inlineStylesheet:s=!0,inlineImages:u=!1,recordCanvas:c=!1,maskAllInputs:l=!1,maskTextFn:d,maskInputFn:p,slimDOM:f=!1,dataURLOptions:h,preserveWhiteSpace:m,onSerialize:g,onIframeLoad:v,iframeLoadTimeout:y,onStylesheetLoad:E,stylesheetLoadTimeout:_,keepIframeSrcFn:T=()=>!1}=e||{};return of(t,{doc:t,mirror:n,blockClass:r,blockSelector:o,maskTextClass:i,maskTextSelector:a,skipChild:!1,inlineStylesheet:s,maskInputOptions:!0===l?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===l?{password:!0}:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:!0===f||"all"===f?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===f,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===f?{}:f,dataURLOptions:h,inlineImages:u,recordCanvas:c,preserveWhiteSpace:m,onSerialize:g,onIframeLoad:v,iframeLoadTimeout:y,onStylesheetLoad:E,stylesheetLoadTimeout:_,keepIframeSrcFn:T,newlyAddedElement:!1})}(document,this.recordConfig);o&&this.sessionWorker.postMessage({event:"sendRecordData",records:o,sessionId:n,screenshotId:t,sessionCreationDate:r})},t.prototype.stopRecording=function(){this.recordRef&&(this.debugMode&&console.debug("Coralogix Browser SDK - Session recording stopped"),this.recordRef(),this.recordRef=void 0,this.recordingStopped=!0,this.hasRecording=!1,this.prepareRecordEventsBeforeSend(),this.clearIntervals(),this.stopMutationObserver())},t.prototype.stopMutationObserver=function(){var t;null===(t=this.mutationObserver)||void 0===t||t.disconnect()},t.prototype.startMutationObserver=function(){var t=this;this.stopMutationObserver(),this.mutationObserver=new MutationObserver((function(e){if(e.length>t.maxMutations){var n="Coralogix Browser SDK - Recording stopped due to too many mutations ".concat(e.length);console.warn(n),af("recording-stop",n),t.stopRecording()}})),this.mutationObserver.observe(document,{attributes:!1,attributeOldValue:!1,characterData:!1,characterDataOldValue:!1,childList:!0,subtree:!0})},t.prototype.clearIntervals=function(){this.batchingTimeInterval&&clearInterval(this.batchingTimeInterval)},t.prototype.prepareRecordConfig=function(t){var e,n=t||{},r=n.excludeDOMOptions,i=n.recordConsoleEvents;return this.recordConfig=o(o({},t),{emit:this.handleRecordEvent,checkoutEveryNms:this.onlySessionWithErrorMode?this.maxRecordTimeForSessionWithError:void 0,slimDOMOptions:o(o({},r),{script:null===(e=null==r?void 0:r.script)||void 0===e||e}),plugins:i?[{name:"rrweb/console@1",observer:xu,options:undefined}]:[]}),this.recordConfig},t.prototype.handleRecordEventForSessionWithError=function(t,e){if(!this.sessionManager.sessionHasError||!e||t.type!==Rp.FullSnapshot){e&&t.type===Rp.Meta&&this.recordEventsForSessionWithError.push([]);var n=this.recordEventsForSessionWithError;n[n.length-1].push(t)}},t.prototype.prepareRecordEventsForSessionWithError=function(){var t=this.recordEventsForSessionWithError,e=t.length,n=t[e-2],r=t[e-1];if(this.sessionManager.sessionHasError){var o=n.concat(r);if(!o.length)return;this.compressRecordData(o),this.resetBatching()}else this.recordEventsForSessionWithError=[n,r]},t.prototype.compressRecordData=function(t){var e=this.sessionManager.getActiveSession()||{},n=e.sessionId,r=e.sessionCreationDate;this.sessionWorker.postMessage({event:"compressRecordData",records:t,sessionId:n,sessionCreationDate:r})},t.prototype.registerToWorkerMessages=function(){var t=this;this.sessionWorker.onmessage=function(e){var n=e.data;switch(n.event){case"sendRecordData":t.sendRecordEvents(n,!1);break;case"splitRecordData":t.sendRecordEvents(n,!0);break;case"stopRecording":t.stopRecording()}}},t.prototype.resetBatching=function(){this.onlySessionWithErrorMode?this.recordEventsForSessionWithError=[[],[]]:this.recordEvents=[]},t.prototype.getMetadata=function(t,e){var n=t.sessionId,r=t.sessionCreationDate,o=t.screenshotId,i=t.gzipBlob,a=t.chunkIndex,s=t.totalChunks,u=0,c=Ac().application;return!!o||(this.segmentIndexCounter[n]||(this.segmentIndexCounter[n]=0),u=e?a===s?this.segmentIndexCounter[n]++:this.segmentIndexCounter[n]:this.segmentIndexCounter[n]++,sessionStorage.setItem(Tc,JSON.stringify(this.segmentIndexCounter))),{segmentIndex:u,segmentSize:i.size,segmentTimestamp:fc(),sessionCreationDate:r,sessionId:n,snapshotId:o,application:c,subIndex:null!=a?a:-1}},t.prototype.handleSessionRecordingResponse=function(t){(null==t?void 0:t.ok)||this.isErrorOccurred?this.isErrorOccurred=!1:(console.warn("Coralogix Browser SDK - Error while sending record"),this.isErrorOccurred=!0,this.stopRecording(),this.batchTimeout&&clearTimeout(this.batchTimeout))},t.prototype.startBatchingRecords=function(){this.batchingTimeInterval=setInterval(this.prepareRecordEventsBeforeSend,1e4)},t.prototype.initializeSessionWorker=function(t){var e=this;this.isWorkerReady=new Promise((function(n,r){e.workerManager.loadAndCreateWorker(t).then((function(t){e.sessionWorker=t,e.isAutoStartRecording&&e.startRecording(),e.request=new yp({suffix:"/browser/alpha/sessionrecording",headers:hc}),e.registerToWorkerMessages(),n(!0)})).catch((function(t){e.debugMode&&console.warn("Coralogix Browser SDK - Web worker not created due to: ",t),r(t)}))}))},t}(),lf=function(){function t(t){var e=this;this.idleConfig=t,this._isIdleActive=!1,this.stopCallbacks={},this.resetTimeout=function(){var t,n;null===(n=(t=e.stopCallbacks).clearTimeout)||void 0===n||n.call(t);var r=setTimeout((function(){e._isIdleActive=!0,e.idleConfig.onIdle()}),e.idleConfig.timeoutDelay);e.stopCallbacks.clearTimeout=function(){return clearTimeout(r)}},this.idlenessEventsHandler=function(){e._isIdleActive&&(e._isIdleActive=!1,e.idleConfig.onActive()),e.resetTimeout()}}return Object.defineProperty(t.prototype,"isIdleActive",{get:function(){return this._isIdleActive},enumerable:!1,configurable:!0}),t.prototype.startIdleListener=function(){this.resetTimeout(),this.trackActivity()},t.prototype.stopIdleListener=function(){Object.values(this.stopCallbacks).forEach((function(t){return t()}))},t.prototype.trackActivity=function(){var t,e;if(null===(e=(t=this.stopCallbacks).removeActivityListeners)||void 0===e||e.call(t),"function"==typeof Cc.addEventListener){var n=rd(Cc,["touchstart","keydown","mousemove"],this.idlenessEventsHandler,{capture:!0,passive:!0}).stop;this.stopCallbacks.removeActivityListeners=n}},t}(),df=function(t){function n(e){var n=t.call(this,{timeoutDelay:9e5,onIdle:function(){return n.clearSessionWhenIdle()},onActive:function(){return n.setSession(!0)}})||this;return n._sessionConfig=Ac().sessionConfig,n._sessionHasError=!1,n._cachedLogsSent=!1,n._currentPageTimestamp=fc(),n.getPrevSession=function(){var t;return JSON.parse(null===(t=Cc.sessionStorage)||void 0===t?void 0:t.getItem(vc))},n.getSession=function(){var t,e,r=JSON.parse(null===(t=Cc.sessionStorage)||void 0===t?void 0:t.getItem(gc)),o=fc();return r&&(r.sessionExpirationDate>o?e=r:(n.clearSessionWhenIdle(),e=n.setSession(!0))),e},n.setSession=function(t){var e,r,o,i;void 0===t&&(t=!1),(null===(e=n._sessionConfig)||void 0===e?void 0:e.keepSessionAfterReload)?n.handleRefreshedSessions():n.createNewSession(),null===(r=Cc.sessionStorage)||void 0===r||r.setItem(gc,JSON.stringify(n.activeSession));var a=wc();return(t&&!!(null==a?void 0:a.recordingStopDueToTimeout)&&!!(null===(o=n.sessionRecorderConfig)||void 0===o?void 0:o.enable)||(null==a?void 0:a.getIsAutoStartRecording()))&&(null===(i=n.sessionRecorder)||void 0===i||i.startRecording()),n.activeSession},n.initializeSession(e),n}return e(n,t),Object.defineProperty(n.prototype,"currentPageTimestamp",{get:function(){return this._currentPageTimestamp},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentPageFragment",{get:function(){return this._currentPageFragment},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sessionConfig",{get:function(){return this._sessionConfig},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onlySessionWithErrorMode",{get:function(){return this._sessionConfig.onlyWithErrorConfig.enable},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxRumEventsForSessionWithError",{get:function(){return this._sessionConfig.onlyWithErrorConfig.maxRumEvents||0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxRecordTimeForSessionWithError",{get:function(){return this._sessionConfig.onlyWithErrorConfig.maxRecordTime||0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"instrumentationsToSend",{get:function(){return this._sessionConfig.onlyWithErrorConfig.instrumentationsToSend},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cachedLogsSent",{get:function(){return this._cachedLogsSent},set:function(t){this._cachedLogsSent=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sessionHasError",{get:function(){return this._sessionHasError},set:function(t){this._sessionHasError=t},enumerable:!1,configurable:!0}),n.prototype.updateCurrentPage=function(t){this.isIdleActive?this._currentPageFragment=void 0:(this._currentPageFragment=t,this._currentPageTimestamp=fc())},n.prototype.getSessionKey=function(){return gc},n.prototype.getActiveSession=function(){return this.activeSession},n.prototype.start=function(){this.startIdleListener(),this.clearPrevSession(),this.setSession()},n.prototype.stop=function(){this.stopIdleListener()},n.prototype.initializeSession=function(t){Cc[Ec]=this,this.sessionRecorderConfig=t,(null==t?void 0:t.enable)&&(bp(t.sessionRecordingSampleRate)?this.sessionRecorder=new cf(this,t):Ac().debug&&console.debug("Coralogix Browser SDK - Session recording is disabled"))},n.prototype.clearSessionWhenIdle=function(){var t;(null===(t=this.sessionRecorder)||void 0===t?void 0:t.getSessionHasRecording())&&(this.sessionRecorder.recordingStopDueToTimeout=!0),this.clearSession()},n.prototype.clearPrevSession=function(){var t;null===(t=Cc.sessionStorage)||void 0===t||t.removeItem(vc)},n.prototype.clearSession=function(){var t,e,n,r,i,a;null===(t=Cc.sessionStorage)||void 0===t||t.setItem(vc,JSON.stringify(o(o({},this.activeSession),{hasRecording:null===(e=this.sessionRecorder)||void 0===e?void 0:e.getSessionHasRecording(),hasScreenshot:null===(n=this.sessionRecorder)||void 0===n?void 0:n.getSessionHasScreenshot()}))),Pc(),this.clearSessionWithErrorMode(),null===(r=Oc())||void 0===r||r.resetSnapshot(),this._currentPageFragment=void 0,null===(i=this.sessionRecorder)||void 0===i||i.stopRecording(),null===(a=Cc.sessionStorage)||void 0===a||a.removeItem(gc)},n.prototype.clearSessionWithErrorMode=function(){this.sessionHasError=!1,this.cachedLogsSent=!1},n.prototype.handleRefreshedSessions=function(){var t,e;this.activeSession=this.getSession();var n=JSON.parse((null===(t=Cc.sessionStorage)||void 0===t?void 0:t.getItem(Tc))||"{}");this.activeSession?null===(e=wc())||void 0===e||e.updateSegmentIndexCounter(n):this.createNewSession()},n.prototype.createNewSession=function(){var t=fc();this.activeSession={sessionId:tc(),sessionCreationDate:t,sessionExpirationDate:t+36e5}},n}(lf),pf=function(){function t(t,e){this.config=t,this.internalPropagator=e}return t.prototype.extract=function(t,e,n){return this.internalPropagator.extract(t,e,n)},t.prototype.fields=function(){return this.internalPropagator.fields()},t.prototype.inject=function(t,e,n){var r,o,i=null===(o=null===(r=this.config.traceParentInHeader)||void 0===r?void 0:r.options)||void 0===o?void 0:o.allowedTracingUrls;i?td(qt.getSpan(t).attributes[cc.URL],i,"allowedTracingUrls")&&this.internalPropagator.inject(t,e,n):this.internalPropagator.inject(t,e,n)},t}();function ff(t){var e;return t?o(o({},t),{interval:null!==(e=t.interval)&&void 0!==e?e:3e5}):{enabled:!1}}function hf(t){if(!t)return Dd.urlBlueprinters;var e={pageUrlBlueprinters:[],networkUrlBlueprinters:[]},n=function(t){var n,r,o=t||{},i=o.pageUrlBlueprinters,a=o.networkUrlBlueprinters;i&&(n=e.pageUrlBlueprinters).push.apply(n,l([],c(i),!1)),a&&(r=e.networkUrlBlueprinters).push.apply(r,l([],c(a),!1))};return n(t),Dd.urlBlueprinters&&n(Dd.urlBlueprinters),e}function mf(t,e){return function(t){var e=t||{},n=e.event_context,r=e.error_context;return n.type===sc.ERROR&&n.source===Xc.DOCUMENT&&!(null==r?void 0:r.error_message)}(t)?(e.debug&&console.warn("Document error without message dropped."),!0):!!function(t,e){if(!t.error_context||!(null==e?void 0:e.length))return!1;var n,r,o,i=t.error_context.error_message||"";return n=i,void 0===(r=e)&&(r=[]),void 0===o&&(o=!1),r.some((function(t){return function(t,e,n){return void 0===n&&(n=!1),!!$u(t)&&(function(t){return t instanceof RegExp}(e)?e.test(t):!!$u(e)&&(n?t===e:t.includes(e)))}(n,t,o)}))}(t,e.ignoreErrors)&&(e.debug&&console.warn("Ignored error dropped."),!0)}function gf(t,e){return o(o(o({},e),t),{session_context:o(o({},e.session_context),t.session_context)})}var vf=function(){function t(){this.sdkConfig=Ac(),this.isActive=!0}return t.prototype.onEnd=function(t){var e,n;if(!Ip(this.isActive)){var r=Rc(),a=r.onlySessionWithErrorMode,s=r.getPrevSession,u=r.getSession,c=r.setSession,l=u()||c(),d=!!(null===(e=wc())||void 0===e?void 0:e.getSessionHasRecording()),p=!!(null===(n=wc())||void 0===n?void 0:n.getSessionHasScreenshot()),f=this._mapToCxSpan(t,l,s(),d,p,a);if(!mf(f.text.cx_rum,this.sdkConfig)){var h=function(t,e){if(!(null==e?void 0:e.beforeSend))return t;var n=t.text.cx_rum,r=function(t){var e=t.session_context,n=e.user_id,r=e.user_name,a=e.user_email,s=e.user_metadata;t.browser_sdk,t.timestamp;var u=i(t,["session_context","browser_sdk","timestamp"]);return o(o({},u),{session_context:{user_id:n,user_email:a,user_name:r,user_metadata:s}})}(n),a=e.beforeSend(r);if(!function(t){if(null==t)return null;var e=["version_metadata","session_context","page_context","event_context"];return!yl(t)||e.some((function(e){return!(null==t?void 0:t[e])}))?(console.warn("CoralogixRum: beforeSend must return null, undefined or a valid event."),null):t}(a))return null;var s=a,u=s.version_metadata.app_name,c=s.event_context.severity;return o(o({},t),{applicationName:u,severity:c,text:{cx_rum:gf(a,n)}})}(f,this.sdkConfig);if(h){var m=h.severity===dc.Error,g=Rc().sessionHasError;a&&(m||g)&&(Rc().sessionHasError=!0,h.text.cx_rum.session_context.hasError=!0),t[jd]=h}}}},t.prototype.onStart=function(){},t.prototype.shutdown=function(){return this.isActive=!1,Promise.resolve()},t.prototype.forceFlush=function(){return Promise.resolve(void 0)},t.prototype._mapToCxSpan=function(t,e,n,r,i,a){var s,u,c=e||{},l=c.sessionId,d=c.sessionCreationDate,p=n||{},f=p.sessionId,h=p.sessionCreationDate,m=p.hasRecording,g=p.hasScreenshot,v=t.attributes,y=t.startTime,E=t.parentSpanId,_=t.name,T=t.endTime,S=t.status,b=t.duration,I=t.kind,C=JSON.parse(v[Bd.USER_CONTEXT]),O=JSON.parse(v[Bd.APPLICATION_CONTEXT]),R=O.application,w=O.version,A=v[Bd.EVENT_TYPE]||t[Bd.EVENT_TYPE],L=this._getEventTypeContext(v,A,t),N=t.spanContext(),M=N.spanId,x=N.traceId,P=o(o({},null===(s=t.resource)||void 0===s?void 0:s.attributes),{"service.name":R}),k=JSON.parse(v[Bd.CUSTOM_LABELS]),D=!!(null===(u=null==L?void 0:L.error_context)||void 0===u?void 0:u.original_stacktrace),U={app_name:R,app_version:w},B=(null==v?void 0:v[Bd.SEVERITY])||dc.Info,F=v[Bd.TIMESTAMP]||fc();F<d&&(F=fc());var j={version_metadata:U,applicationName:R,subsystemName:"cx_rum",isErrorWithStacktrace:D,severity:B,timestamp:F,text:{cx_rum:o(o({platform:"browser",timestamp:F},L),{browser_sdk:{version:"2.1.0"},version_metadata:U,session_context:o(o(o(o({},C),{session_id:l,session_creation_date:d,prev_session:f?{session_id:f,session_creation_date:h,hasRecording:m,hasScreenshot:g}:void 0,hasRecording:r,hasScreenshot:i,user_agent:v[Bd.USER_AGENT]}),Kd(v[Bd.USER_AGENT])),{onlyWithErrorMode:a}),page_context:t[Bd.PAGE_CONTEXT],isNavigationEvent:!!t[Bd.IS_NAVIGATION_EVENT],event_context:{type:A,source:v[Bd.SOURCE],severity:B},labels:k,environment:v[Bd.ENVIRONMENT]||""})}};return function(t){return!!t[Bc]}(t)&&(j.text.cx_rum.spanId=M,j.text.cx_rum.traceId=x,j.text.cx_rum.parentSpanId=E,j.instrumentation_data={otelSpan:{spanId:M,traceId:x,parentSpanId:E,name:_,attributes:o(o({},qd(v)),this.resolveLabels(j.text.cx_rum)),startTime:y,endTime:T,status:B===dc.Error?o(o({},S),{code:Uc.ERROR}):S,kind:I,duration:b,sessionId:l},otelResource:{attributes:P}}),this.resolveContextFromSpan(j,t,A),j.text.cx_rum.labels=this.resolveLabels(j.text.cx_rum),j},t.prototype.resolveContextFromSpan=function(t,e,n){switch(n){case sc.CUSTOM_MEASUREMENT:t.text.cx_rum.custom_measurement_context=e[Bd.CUSTOM_MEASUREMENT_CONTEXT];break;case sc.MEMORY_USAGE:t.text.cx_rum.memory_usage_context=e[Bd.MEMORY_USAGE_CONTEXT];break;case sc.SCREENSHOT:t.text.cx_rum.screenshot_context=e[Bd.SCREENSHOT_CONTEXT]}},t.prototype._getEventTypeContext=function(t,e,n){var r;switch(e){case sc.ERROR:var i=t[Bd.ERROR.MESSAGE],a=n[Yc.DATA],s=n[Yc.STACK];return{error_context:{error_type:t[Bd.ERROR.TYPE],error_message:i,original_stacktrace:s,error_custom_data:a}};case sc.NETWORK_REQUEST:var u=t[cc.URL],c=tp({url:u,blueprinters:null===(r=this.sdkConfig.urlBlueprinters)||void 0===r?void 0:r.networkUrlBlueprinters});return{network_request_context:{method:t[cc.METHOD],status_code:t[cc.STATUS_CODE],url:u,url_blueprint:c,fragments:Zd(c),host:t[cc.HOST],schema:t[cc.SCHEME],status_text:t[cc.STATUS_TEXT],duration:Yd(null==n?void 0:n.duration),source:t[Bd.SOURCE],response_content_length:t[cc.RESPONSE_CONTENT_LENGTH],request_headers:n[sl],request_payload:n[ll],response_headers:n[ul],response_payload:n[cl]}};case sc.LOG:if(t[Bd.LOG]){var l=JSON.parse(t[Bd.LOG]);return{log_context:{message:l.message,data:null==l?void 0:l.data}}}return{log_context:{message:""}};case sc.INTERNAL:var d=JSON.parse(t[Bd.INTERNAL])||{};return{internal_context:{event:d.event,data:d.data}};case sc.USER_INTERACTION:return{interaction_context:{target_element:t[Bd.TARGET_ELEMENT],event_name:t[Bd.INTERACTION_EVENT_NAME],target_element_inner_text:t[Bd.ELEMENT_INNER_TEXT],element_id:t[Bd.ELEMENT_ID],element_classes:t[Bd.ELEMENT_CLASSES],target_element_type:t[Bd.TARGET_ELEMENT_TYPE]}};case sc.WEB_VITALS:return{web_vitals_context:JSON.parse(t[_l])};case sc.LONG_TASK:return{longtask_context:JSON.parse(t[sc.LONG_TASK])};case sc.RESOURCES:var p=JSON.parse(t[Sl]),f=Zd(p.name);return{resource_context:o(o({},p),{fragments:f})}}return{}},t.prototype.resolveLabels=function(t){var e,n,r=t.labels,i=null===(e=this.sdkConfig)||void 0===e?void 0:e.labelProviders;if(null==i?void 0:i.length){var a=Xd(Ad),s=Xd(Ld),u=null===(n=t.network_request_context)||void 0===n?void 0:n.fragments,c=o(o({},this.getLabelsByLabelProviders(a,t,t.page_context.page_fragments)),u?this.getLabelsByLabelProviders(s,t,u):{});r=o(o({},r),c)}return r},t.prototype.getLabelsByLabelProviders=function(t,e,n){var r,i,a={},s=ep(e);try{for(var c=u(t),l=c.next();!l.done;l=c.next()){var d=l.value;a=o(o({},a),d.providerFunc(n,s))}}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}return a},t}(),yf=function(){function t(){this.isActive=!0}return t.prototype.forceFlush=function(){return Promise.resolve()},t.prototype.onEnd=function(t){if(!Ip(this.isActive)&&t[jd]){var e=t[jd];this.isSnapshotPrepared(t)?this.createSnapshot(e):e.text.cx_rum.isSnapshotEvent=!1}},t.prototype.onStart=function(t,e){},t.prototype.shutdown=function(){return this.isActive=!1,Promise.resolve()},t.prototype.createSnapshot=function(t){var e=Oc().currentSnapshot;e.timestamp;var n=i(e,["timestamp"]);t.text.cx_rum.isSnapshotEvent=!0,t.text.cx_rum.snapshot_context=n},t.prototype.isSnapshotPrepared=function(t){var e,n=t.attributes,r=n[Bd.TIMESTAMP],o=n[Bd.EVENT_TYPE],i=n[Bd.SEVERITY],a=!1,s=Oc(),u=s.fragmentsState,c=s.updateSnapshot,l=s.currentSnapshot,d=s.isSnapshotSentDueToRecording,p=l.timestamp,f=l.actionCount,h=l.errorCount,m=t[Bd.PAGE_CONTEXT];return m&&!u.has(m.page_fragments)&&(u.add(m.page_fragments),c({timestamp:fc(),viewCount:u.size}),a=!0),i===dc.Error&&(c({timestamp:fc(),errorCount:h+1}),a=!0),(null===(e=wc())||void 0===e?void 0:e.getSessionHasRecording())&&!d&&(c({timestamp:fc(),hasRecording:!0}),Oc().isSnapshotSentDueToRecording=!0,a=!0),o===sc.DOM&&(c({timestamp:fc()}),a=!0),o===sc.SCREENSHOT&&c({hasScreenshot:!0}),r-p>=6e4&&(c({timestamp:fc()}),a=!0),o===sc.USER_INTERACTION&&c({actionCount:f+1}),a},t}(),Ef=function(){function t(){var t=this;this.updateSnapshot=function(e){t._currentSnapshot=o(o({},t._currentSnapshot),e)},this.resetSnapshot=function(){t._currentSnapshot=o(o({},bc),{timestamp:fc()}),t._fragmentsState=new Set,t._isSnapshotSentDueToRecording=!1},Cc[Sc]=this,this.resetSnapshot()}return Object.defineProperty(t.prototype,"fragmentsState",{get:function(){return this._fragmentsState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentSnapshot",{get:function(){return this._currentSnapshot},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSnapshotSentDueToRecording",{get:function(){return this._isSnapshotSentDueToRecording},set:function(t){this._isSnapshotSentDueToRecording=t},enumerable:!1,configurable:!0}),t}(),_f=function(){function t(){}return t.prototype.forceFlush=function(){return Promise.resolve()},t.prototype.onEnd=function(t){},t.prototype.onStart=function(t){var e=function(t){var e,n=tp({url:t,blueprinters:null===(e=Ac().urlBlueprinters)||void 0===e?void 0:e.pageUrlBlueprinters}),r=Zd(n);return{page_url:t.slice(0,Cd),page_url_blueprint:n,page_fragments:r,referrer:document.referrer}}(location.href);t[Bd.PAGE_CONTEXT]=e;var n=Rc().currentPageFragment,r=e.page_fragments;n!==r&&(Rc().updateCurrentPage(r),t[Bd.IS_NAVIGATION_EVENT]=!0)},t.prototype.shutdown=function(){return Promise.resolve()},t}();if(Hd.has(uc.LongTask)){var Tf=Cc.__tti={e:[]};Tf.o=new PerformanceObserver((function(t){Tf.e=Tf.e.concat(t.getEntries())})),Tf.o.observe({type:uc.LongTask,buffered:!0})}var Sf,bf,If,Cf,Of,Rf,wf,Af,Lf,Nf,Mf,xf,Pf,kf,Df=!1,Uf={get isInited(){return Df},init:function(t){var e,n;if(Df)console.warn("CoralogixRum already inited.");else if(Cc.sessionStorage)if("function"==typeof Symbol){var r=function(t){var e,n,r;if(function(t){var e,n;if(t){if(t.proxyUrl||t.public_key){try{for(var r=u(Od),o=r.next();!o.done;o=r.next()){var i=o.value;if(vl(t[i]))return void console.error('CoralogixRum: Initialization aborted. Please provide the required property "'.concat(i,'".'))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return!0}console.warn("CoralogixRum: Public key is missing")}else console.warn("CoralogixRum: Initialization configuration missing")}(t)){var i=t.ignoreUrls,a=t.urlBlueprinters,s=t.proxyUrl,d=[];return i&&d.push.apply(d,l([],c(i),!1)),s&&d.push(new RegExp(s)),Dd.ignoreUrls&&d.push.apply(d,l([],c(Dd.ignoreUrls),!1)),o(o(o({},Dd),t),{maskInputTypes:null!==(e=t.maskInputTypes)&&void 0!==e?e:xd,maskClass:null!==(n=t.maskClass)&&void 0!==n?n:"cx-mask",ignoreUrls:d,urlBlueprinters:hf(a),sessionSampleRate:null!==(r=t.sessionSampleRate)&&void 0!==r?r:100,sessionConfig:Tp(t.sessionConfig),sessionRecordingConfig:Sp(t.sessionRecordingConfig),memoryUsageConfig:ff(t.memoryUsageConfig),trackSoftNavigations:!!t.trackSoftNavigations,supportMfe:!!t.supportMfe})}}(t);if(r){Cc[Rd]=r;var i=function(t){var e=new d,n=t.sessionSampleRate,r=t.sessionConfig,i=t.debug,a=t.sessionRecordingConfig;return bp(n)&&bp(r.sessionSampleRate)||((null==r?void 0:r.alwaysTrackSessionsWithErrors)?r.onlyWithErrorConfig=o(o({},r.onlyWithErrorConfig),{enable:!0}):(i&&console.debug("CoralogixRum: Session tracking is disabled due to sampling rate"),e=new Ep,a&&(a.enable=!1),t.instrumentations=o(o({},t.instrumentations),{errors:!1,custom:!1,web_vitals:!1,interactions:!1,long_tasks:!1,resources:!1}))),e}(r);r.debug||r.public_key||console.warn("rumAuth will be required in the future"),Pf=new Ed,new df(r.sessionRecordingConfig).start();var p=r.ignoreUrls,f=r.labels,h=r.user_context,m=r.application,g=r.version,v=r.traceParentInHeader,y=r.environment;wf=new Op({sampler:i});var E,_={},T=Ud.map((function(t){var e,n,i,a,s=t.Instrument,u=t.confKey,c=t.disable,l=(i=null===(e=null==r?void 0:r.instrumentations)||void 0===e?void 0:e[u],a=_,!1===i?i:(void 0!==i||!c)&&!1!==(null==i?void 0:i.enabled)&&Object.assign({},a,i));if(l){var d=void 0;switch(u){case"errors":d=new s(l),If=d;break;case"fetch":case"xhr":d=new s(o(o({},l),{ignoreUrls:p,traceParentInHeader:v}));break;case Ol:d=new s(l),Wd(Ol,d);break;case vd:(null===(n=r.sessionRecordingConfig)||void 0===n?void 0:n.enable)&&(d=new s(l),Rf=d);break;case md:r.memoryUsageConfig.enabled&&(Cc.crossOriginIsolated?performance.measureUserAgentSpecificMemory||(console.debug("Coralogix Browser SDK - measureUserAgentSpecificMemory() is not available in this browser"),0):(console.debug("Coralogix Browser SDK - measureUserAgentSpecificMemory() is only available in cross-origin-isolated pages."),0))&&(d=new s(l),Of=d);break;default:d=new s(l)}return d instanceof gl&&(bf=d),d instanceof _d&&(Cf=d),d}return null})).filter((function(t){return Boolean(t)})),S=o(o({},Dd.user_context),h);Af=new np(o(((e={})[Bd.APPLICATION_CONTEXT]=JSON.stringify({application:m,version:g}),e[Bd.USER_CONTEXT]=JSON.stringify(S),e),y?((n={})[Bd.ENVIRONMENT]=y,n):{})),f&&Af.setCustomLabels(f),E=Af,Cc[Fc]=E,wf.addSpanProcessor(Af),Mf=new _f,wf.addSpanProcessor(Mf),Nf=new vf,wf.addSpanProcessor(Nf),new Ef,Lf=new yf,wf.addSpanProcessor(Lf),wf.addSpanProcessor(new it(xf=new Cp,{maxExportBatchSize:50,scheduledDelayMillis:2e3})),function(t,e){a(this,void 0,void 0,(function(){var n,r,o,i,a,u,d,p;return s(this,(function(s){return(null===(d=t.traceParentInHeader)||void 0===d?void 0:d.enabled)&&(n=[],r=(null===(p=t.traceParentInHeader)||void 0===p?void 0:p.options)||{},o=r.propagateB3TraceHeader,(i=r.propagateAwsXrayTraceHeader)||o||(n=l(l([],c(n),!1),[new sp,new vp],!1)),i&&n.push(new qu),o&&(a=o.singleHeader,u=o.multiHeader,a&&n.push(new Ju),u&&n.push(new Ju({injectEncoding:Hu.MULTI_HEADER}))),e.register({propagator:new pf(t,new up({propagators:n}))})),[2]}))}))}(t,wf),Sf=function(t){var e,n,r=t.tracerProvider||qt.getTracerProvider(),o=t.meterProvider||Cr.getMeterProvider(),i=t.loggerProvider||Mr.getLoggerProvider(),a=null!==(n=null===(e=t.instrumentations)||void 0===e?void 0:e.flat())&&void 0!==n?n:[];return function(t,e,n,r){for(var o=0,i=t.length;o<i;o++){var a=t[o];e&&a.setTracerProvider(e),n&&a.setMeterProvider(n),r&&a.setLoggerProvider&&a.setLoggerProvider(r),a.getConfig().enabled||a.enable()}}(a,r,o,i),function(){!function(t){t.forEach((function(t){return t.disable()}))}(a)}}({tracerProvider:wf,instrumentations:T});var b=c(function(t,e){var n,r,o=[],i=[];try{for(var a=u(t),s=a.next();!s.done;s=a.next()){var c=s.value;e(c)?o.push(c):i.push(c)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return[o,i]}(r.labelProviders||[],(function(t){var e=t.urlType;return e===lc.PAGE||!e})),2),I=b[0],C=b[1];Wd(Ad,I),Wd(Ld,C),Df=!0,(null==t?void 0:t.debug)&&console.info("CoralogixRum.init() complete"),af("init")}}else console.warn("CoralogixRum: browser not supported, disabling instrumentation.");else console.warn("CoralogixRum: Non-browser environment detected, aborting")},getCustomTracer:function(t){var e,n;if(Df)if(null===(n=null===(e=Ac())||void 0===e?void 0:e.traceParentInHeader)||void 0===n?void 0:n.enabled){if(!Cc[Nc]){var r,o=wf.getTracer("@");return r=o,Cc[Nc]=r,{startGlobalSpan:function(e,n){if(!xc()){var r;r=(null==t?void 0:t.ignoredInstruments)||[],Cc[Mc]=r;var i=o.startSpan(e);i[Bd.EVENT_TYPE]=sc.CUSTOM_SPAN,n&&Gc(i,n),jc(i);var a={span:i,withContext:function(t){return k.with(qt.setSpan(k.active(),i),t)},endSpan:function(){null==i||i.end(),Pc()},startCustomSpan:function(t,e){var n=o.startSpan(t);return n[Bd.EVENT_TYPE]=sc.CUSTOM_SPAN,e&&Gc(n,e),jc(n),{span:n,endSpan:function(){null==n||n.end()}}}};return function(t){Cc[Lc]=t}(a),a}console.warn("Coralogix Browser SDK  - Global span already exists")}}}console.warn("Coralogix Browser SDK - Custom tracer already exists")}else console.debug("Coralogix Browser SDK - TraceParentInHeader is not enabled");else console.debug("CoralogixRum must be initiated before getting custom tracer")},shutdown:function(){var t;Df&&(null==Sf||Sf(),Sf=void 0,this.stopSessionRecording(),null===(t=Rc())||void 0===t||t.stop(),null==Af||Af.shutdown(),null==Mf||Mf.shutdown(),null==Nf||Nf.shutdown(),null==Lf||Lf.shutdown(),null==xf||xf.shutdown(),Df=!1)},setApplicationContext:function(t){var e;Df?null==Af||Af.setInternalLabels(o(o({},Af.getInternalLabels()),((e={})[Bd.APPLICATION_CONTEXT]=t,e))):console.debug("CoralogixRum must be initiated before setting application context")},captureError:function(t,e,n){Df?null==If||If.reportError(Xc.CAPTURED,t,e,n):console.debug("CoralogixRum must be initiated before reporting errors")},sendCustomMeasurement:function(t,e){Df?null==Cf||Cf.createCustomMeasurement(t,e):console.debug("CoralogixRum must be initiated before sending custom measurement")},addTiming:function(t,e){Df?this.sendCustomMeasurement(t,function(t){return"number"==typeof t?t:fc()-Rc().currentPageTimestamp}(e)):console.debug("CoralogixRum must be initiated before adding timing")},measureUserAgentSpecificMemory:function(){Df?Of?Of.startTrackingMemoryUsage():console.debug("Memory usage instrumentation is not enabled"):console.debug("CoralogixRum must be initiated before measuring user agent specific memory")},stopSessionRecording:function(){var t;null===(t=wc())||void 0===t||t.stopRecording()},startSessionRecording:function(){var t;null===(t=wc())||void 0===t||t.startRecording()},screenshot:function(t){var e;if(Df){var n=tc();return null==Rf||Rf.screenshot(n,t),null===(e=wc())||void 0===e||e.screenshot(n),n}console.debug("CoralogixRum must be initiated before capturing screenshot")},setUserContext:function(t){var e;Df?null==Af||Af.setInternalLabels(o(o({},Af.getInternalLabels()),((e={})[Bd.USER_CONTEXT]=t,e))):console.debug("CoralogixRum must be initiated before setting user context")},getUserContext:function(){return null==Af?void 0:Af.getUserContext()},setLabels:function(t){null==Af||Af.setCustomLabels(t)},getLabels:function(){return(null==Af?void 0:Af.getCustomLabels())||{}},getSessionId:function(){var t,e;return null===(e=null===(t=Rc())||void 0===t?void 0:t.getSession())||void 0===e?void 0:e.sessionId},log:function(t,e,n){Df?bf?null==bf||bf.log(t,e,n):console.warn("Log was reported, but custom instrumentation is disabled."):console.debug("CoralogixRum must be initiated before using log")},debug:function(t,e){this.log(dc.Debug,t,e)},verbose:function(t,e){this.log(dc.Verbose,t,e)},info:function(t,e){this.log(dc.Info,t,e)},warn:function(t,e){this.log(dc.Warn,t,e)},error:function(t,e){this.log(dc.Error,t,e)},critical:function(t,e){this.log(dc.Critical,t,e)},startTimeMeasure:function(t,e){Df?null==Pf||Pf.startMeasurement(t,e):console.debug("CoralogixRum must be initiated before starting time measurement.")},endTimeMeasure:function(t){var e=null==Pf?void 0:Pf.getMeasurement(t);if(e){var n=e.duration,r=e.labels;null==Cf||Cf.createCustomMeasurement(t,n,Wc(r))}}};Cc.CoralogixRum=Uf,function(t){t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin"}(kf||(kf={})),Uf.init({public_key:"cxtp_6kzY17KQRLcijyNDPEfbwjJs5cugV9",application:"steve.lerner@coralogix.com",version:"v1",coralogixDomain:"US2",traceParentInHeader:{enabled:!0,options:{propagateTraceHeaderCorsUrls:[new RegExp("http://localhost.*")]}}}),console.log("JavaScript file loaded."),document.addEventListener("DOMContentLoaded",(()=>{console.log("DOM fully loaded");const t=document.getElementById("app");if(t){const e=document.createElement("style");e.innerHTML="\n      body {\n        font-family: Arial, sans-serif;\n        margin: 20px;\n        background-color: #f4f4f4;\n      }\n      header {\n        background-color: #28a745;\n        color: white;\n        padding: 10px 20px;\n        margin-bottom: 20px;\n      }\n      .container {\n        background: white;\n        padding: 20px;\n        border-radius: 4px;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n      }\n      .section {\n        margin-top: 20px;\n      }\n      button {\n        padding: 10px 15px;\n        margin-right: 10px;\n        border: none;\n        background-color: #28a745;\n        color: white;\n        border-radius: 4px;\n        cursor: pointer;\n      }\n      button:hover {\n        background-color: #218838;\n      }\n      #greeting {\n        margin-top: 10px;\n        font-size: 1.2em;\n        color: #333;\n      }\n      #apiResponse, #errorStatus, #slowOpStatus {\n        margin-top: 10px;\n        font-family: monospace;\n        background: #eee;\n        padding: 10px;\n        border-radius: 4px;\n        max-height: 200px;\n        overflow-y: auto;\n      }\n      #errorStatus {\n        color: #28a745;\n      }\n    ",document.head.appendChild(e),t.innerHTML='\n      <header>\n        <nav></nav>\n      </header>\n      <div class="container">\n        <h1>Welcome to Coralogix RUM Demo!</h1>\n\n        <div class="section">\n          <h2>User Greeting</h2>\n          <form id="nameForm">\n            <label for="nameInput">Enter your name:</label>\n            <input type="text" id="nameInput" required />\n            <button type="submit">Submit</button>\n          </form>\n          <div id="greeting"></div>\n        </div>\n\n        <div class="section">\n          <h2>Error Simulation</h2>\n          <p>Click the button below to simulate a JavaScript error. This error will be sent to Coralogix RUM.</p>\n          <button id="errorButton">Simulate Error</button>\n          <div id="errorStatus"></div>\n        </div>\n\n        <div class="section">\n          <h2>Slow Operation Simulation</h2>\n          <p>Click the button to simulate a heavy computation (for performance monitoring):</p>\n          <button id="slowOpButton">Simulate Slow Operation</button>\n          <div id="slowOpStatus"></div>\n        </div>\n\n        <div class="section">\n          <h2>API Call Simulation</h2>\n          <p>Click the button to make an AJAX call (simulating a network request):</p>\n          <button id="apiButton">Fetch API Data</button>\n          <div id="apiResponse"></div>\n        </div>\n      </div>\n    ',console.log("UI injected successfully with styles.");const n=Uf.getCustomTracer();document.getElementById("nameForm").addEventListener("submit",(t=>{t.preventDefault();const e=n.startGlobalSpan("greeting-span",{action:"submit"});e.withContext((()=>{const t=e.startCustomSpan("process-greeting",{action:"submit"}),n=document.getElementById("nameInput").value;document.getElementById("greeting").innerText=`Hello, ${n}! Welcome to Coralogix RUM Demo!`,t.endSpan()})),e.endSpan()})),document.getElementById("errorButton").addEventListener("click",(()=>{const t=n.startGlobalSpan("error-span",{action:"trigger-error"});t.withContext((()=>{const e=t.startCustomSpan("simulate-error",{errorType:"manual"});document.getElementById("errorStatus").innerText="Simulated error triggered...",setTimeout((()=>{nonExistentFunction()}),0),e.endSpan()})),t.endSpan()})),document.getElementById("slowOpButton").addEventListener("click",(()=>{const t=n.startGlobalSpan("slow-operation-span",{action:"computation"});t.withContext((()=>{const e=t.startCustomSpan("compute-sum",{load:"high"}),n=document.getElementById("slowOpStatus");n.innerText="Processing...",setTimeout((()=>{let t=0;for(let e=0;e<1e7;e++)t+=e;n.innerText=`Heavy computation complete. Result: ${t}`,e.endSpan()}),100)})),t.endSpan()})),document.getElementById("apiButton").addEventListener("click",(()=>{const t=n.startGlobalSpan("api-call-span",{action:"fetch-data"});t.withContext((()=>{const e=t.startCustomSpan("fetch-api-data",{url:"https://jsonplaceholder.typicode.com/posts/1"}),n=document.getElementById("apiResponse");n.innerText="Fetching data...",fetch("https://jsonplaceholder.typicode.com/posts/1").then((t=>t.json())).then((t=>{n.innerText=JSON.stringify(t,null,2),e.endSpan()})).catch((t=>{n.innerText=`Error fetching data: ${t}`,e.endSpan()}))})),t.endSpan()})),console.log("Coralogix RUM initialized.")}else console.error('Element with ID "app" not found.')}))})()})();
//# sourceMappingURL=bundle.js.map